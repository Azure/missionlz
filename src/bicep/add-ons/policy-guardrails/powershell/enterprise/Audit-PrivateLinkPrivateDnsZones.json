{
  "name": "Audit-PrivateLinkDnsZones",
  "type": "Microsoft.Authorization/policyDefinitions",
  "apiVersion": "2023-04-01",
  "scope": null,
  "properties": {
      "policyType": "Custom",
      "mode": "Indexed",
      "displayName": "Audit the creation of Private Link Private DNS Zones",
      "description": "This policy audits the creation of a Private Link Private DNS Zones in the current scope, used in combination with policies that create centralized private DNS in connectivity subscription",
      "metadata": {
          "version": "1.0.0",
          "category": "Network",
          "source": "https://github.com/Azure/Enterprise-Scale/",
          "alzCloudEnvironments": [
              "AzureCloud",
              "AzureUSGovernment"
          ]
      },
      "parameters": {
          "effect": {
              "type": "String",
              "allowedValues": [
                  "Audit",
                  "Deny",
                  "Disabled"
              ],
              "defaultValue": "Audit",
              "metadata": {
                  "displayName": "Effect",
                  "description": "Enable or disable the execution of the policy"
              }
          },
          "privateLinkDnsZones": {
            "type": "Array",
            "metadata": {
                "displayName": "Private Link Private DNS Zones",
                "description": "An array of Private Link Private DNS Zones to check for the existence of in the assigned scope."
            },
            "defaultValue": [
                "privatelink.cognitiveservices.azure.us",
                "privatelink.api.ml.azure.us",
                "privatelink.notebooks.usgovcloudapi.net",
                "privatelink.servicebus.usgovcloudapi.net",
                "privatelink.sql.azuresynapse.usgovcloudapi.net",
                "privatelink.dev.azuresynapse.usgovcloudapi.net",
                "privatelink.azuresynapse.usgovcloudapi.net",
                "privatelink.datafactory.azure.us",
                "privatelink.adf.azure.us",
                "privatelink.azurehdinsight.azure.us",
                "privatelink.databricks.azure.us",
                "privatelink.batch.usgovcloudapi.net",
                "privatelink-global.wvd.azure.us",
                "privatelink.wvd.azure.us",
                "privatelink.azurecr.us",
                "usgovvirginia.privatelink.azurecr.us",
                "privatelink.database.usgovcloudapi.net",
                "privatelink.documents.azure.us",
                "privatelink.mongo.cosmos.azure.us",
                "privatelink.cassandra.cosmos.azure.us",
                "privatelink.gremlin.cosmos.azure.us",
                "privatelink.table.cosmos.azure.us",
                "privatelink.postgres.database.usgovcloudapi.net",
                "privatelink.postgres.database.usgovcloudapi.net",
                "privatelink.mysql.database.usgovcloudapi.net",
                "privatelink.mysql.database.usgovcloudapi.net",
                "privatelink.mariadb.database.usgovcloudapi.net",
                "privatelink.redis.cache.usgovcloudapi.net",
                "privatelink.servicebus.usgovcloudapi.net",
                "privatelink.eventgrid.azure.us",
                "privatelink.workspace.azurehealthcareapis.us",
                "privatelink.fhir.azurehealthcareapis.us",
                "privatelink.dicom.azurehealthcareapis.us",
                "privatelink.azure-devices.us",
                "privatelink.servicebus.windows.us",
                "privatelink.azure-devices-provisioning.us",
                "privatelink.azure-automation.us",
                "privatelink.usgovvirginia.backup.windowsazure.us",
                "privatelink.siterecovery.windowsazure.us",
                "privatelink.monitor.azure.us",
                "privatelink.adx.monitor.azure.us",
                "privatelink.oms.opinsights.azure.us",
                "privatelink.ods.opinsights.azure.us",
                "privatelink.agentsvc.azure-automation.us",
                "privatelink.blob.core.usgovcloudapi.net",
                "privatelink.purview.azure.us",
                "privatelink.purviewstudio.azure.us",
                "privatelink.vaultcore.usgovcloudapi.net",
                "privatelink.azconfig.azure.us",
                "privatelink.blob.core.usgovcloudapi.net",
                "privatelink.table.core.usgovcloudapi.net",
                "privatelink.queue.core.usgovcloudapi.net",
                "privatelink.file.core.usgovcloudapi.net",
                "privatelink.web.core.usgovcloudapi.net",
                "privatelink.dfs.core.usgovcloudapi.net",
                "privatelink.search.azure.us",
                "privatelink.servicebus.usgovcloudapi.net",
                "privatelink.azurewebsites.us",
                "scm.privatelink.azurewebsites.us",
                "privatelink.servicebus.usgovcloudapi.net"
            ]
        }
      },
      "policyRule": {
          "if": {
              "allOf": [
                  {
                      "field": "type",
                      "equals": "Microsoft.Network/privateDnsZones"
                  },
                  {
                      "field": "name",
                      "in": "[parameters('privateLinkDnsZones')]"
                  }
              ]
          },
          "then": {
              "effect": "[parameters('effect')]"
          }
      }
  }
}