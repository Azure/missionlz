{
    "properties": {
      "displayName": "Guard Rails",
      "policyType": "Custom",
      "description": "Default \"guard rails\" policy initiative for DoD ISD engagements",
      "metadata": {
        "parameterScopes": {
          "nsgRegion : Configure network security groups to enable traffic analytics_1": "/subscriptions/0a14f7a1-e58b-42f2-9894-1a08535dcb30"
        },
        "createdBy": "caf99b92-77d9-4128-9d1e-02c5c382b01d",
        "createdOn": "2024-09-04T18:02:31.8763575Z",
        "updatedBy": "caf99b92-77d9-4128-9d1e-02c5c382b01d",
        "updatedOn": "2024-10-21T16:56:54.9555463Z"
      },
      "version": "1.0.0",
      "parameters": {
        
      },
      "policyDefinitions": [
        {
            "policyDefinitionReferenceId": "Key vaults should have deletion protection enabled_1",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53",
            "definitionVersion": "2.*.*",
            "effectiveDefinitionVersion": "2.1.0",
            "parameters": {},
            "policyRule": {
      "if": {
        "anyOf": [
          {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.KeyVault/vaults"
              },
              {
                "field": "Microsoft.KeyVault/vaults/enableSoftDelete",
                "notEquals": true
              }
            ]
          }
        ]
      },
      "then": {
        "effect": "append",
        "details": [
          {
            "field": "Microsoft.KeyVault/vaults/enableSoftDelete",
            "value": true
          }
        ]
      }
    },
            "groupNames": [
              "KeyVaultGuardRails"
            ]            
          }        
      ],
      "policyDefinitionGroups": [        
        {
          "name": "KeyVaultGuardRails",
          "displayName": "Key Vault Guard Rails"
        }
      ],
      "versions": [
        "1.0.0"
      ]
    },
    "id": "/subscriptions/0a14f7a1-e58b-42f2-9894-1a08535dcb30/providers/Microsoft.Authorization/policySetDefinitions/cc258a6e33cf441bb51df45c",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "name": "cc258a6e33cf441bb51df45c"    
  }