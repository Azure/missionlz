{
  "$schema": "https://schema.management.azure.com/schemas/2021-09-09/uiFormDefinition.schema.json",
  "view": {
    "kind": "Form",
    "properties": {
      "title": "ArcGIS Enterprise on Azure with AVD",
      "steps": [
        {
          "name": "basics",
          "label": "Basics",
          "elements": [
            {
              "name": "scope",
              "type": "Microsoft.Common.ResourceScope",
              "location": {
                "resourceTypes": []
              }
            },
            {
              "name": "subscriptions",
              "label": "Select Subscriptions",
              "type": "Microsoft.Common.Section",
              "elements": [
                {
                  "name": "api",
                  "type": "Microsoft.Solutions.ArmApiControl",
                  "request": {
                    "method": "GET",
                    "path": "subscriptions?api-version=2020-01-01"
                  }
                },
                {
                  "name": "hub",
                  "label": "Hub Subscription",
                  "type": "Microsoft.Common.DropDown",
                  "defaultValue": "",
                  "toolTip": "Select the subscription for your Mission Landing Zone Hub network, firewall, and remote access resources.",
                  "multiselect": false,
                  "selectAll": false,
                  "filter": true,
                  "filterPlaceholder": "Filter items ...",
                  "multiLine": true,
                  "constraints": {
                    "allowedValues": "[map(steps('basics').subscriptions.api.value, (item) => parse(concat('{\"label\":\"', item.displayName, '\",\"value\":\"', item.id, '\",\"description\":\"', 'ID: ', item.subscriptionId, '\"}')))]",
                    "required": true
                  }
                },
                {
                  "name": "spoke",
                  "label": "ESRI Enterprise Subscription",
                  "type": "Microsoft.Common.DropDown",
                  "defaultValue": "",
                  "toolTip": "Select the subscription for your ESRI Enterprise resources.",
                  "multiselect": false,
                  "selectAll": false,
                  "filter": true,
                  "filterPlaceholder": "Filter items ...",
                  "multiLine": true,
                  "constraints": {
                    "allowedValues": "[map(steps('basics').subscriptions.api.value, (item) => parse(concat('{\"label\":\"', item.displayName, '\",\"value\":\"', item.id, '\",\"description\":\"', 'ID: ', item.subscriptionId, '\"}')))]",
                    "required": true
                  }
                }
              ]
            },
            {
              "name": "hub",
              "label": "Hub Resources",
              "type": "Microsoft.Common.Section",
              "elements": [
                {
                  "name": "virtualNetworksApi",
                  "type": "Microsoft.Solutions.ArmApiControl",
                  "request": {
                    "method": "GET",
                    "path": "[concat(steps('basics').subscriptions.hub, '/providers/Microsoft.Network/virtualNetworks?api-version=2023-05-01')]"
                  }
                },
                {
                  "name": "virtualNetwork",
                  "type": "Microsoft.Common.DropDown",
                  "visible": true,
                  "label": "Hub virtual network",
                  "defaultValue": "",
                  "toolTip": "Select the existing Hub virtual network.",
                  "constraints": {
                    "required": true,
                    "allowedValues": "[map(steps('basics').hub.virtualNetworksApi.value, (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.id, '\"}')))]"
                  }
                },
                {
                  "name": "azureFirewallsApi",
                  "type": "Microsoft.Solutions.ArmApiControl",
                  "request": {
                    "method": "GET",
                    "path": "[concat(steps('basics').subscriptions.hub, '/providers/Microsoft.Network/azureFirewalls?api-version=2023-05-01')]"
                  }
                },
                {
                  "name": "azureFirewall",
                  "type": "Microsoft.Common.DropDown",
                  "visible": true,
                  "label": "Hub azure firewall",
                  "defaultValue": "",
                  "toolTip": "Select the existing Hub Azure firewall.",
                  "constraints": {
                    "required": true,
                    "allowedValues": "[map(steps('basics').hub.azureFirewallsApi.value, (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.id, '\"}')))]"
                  }
                }
              ]
            },
            {
              "name": "naming",
              "type": "Microsoft.Common.Section",
              "label": "Resource Naming",
              "elements": [
                {
                  "name": "resourceSuffix",
                  "type": "Microsoft.Common.TextBox",
                  "label": "Resource Suffix",
                  "toolTip": "Input a suffix for the resource names created with this solution. The suffix should represent a unique value within your organization, such as a business unit or project.",
                  "placeholder": "",
                  "constraints": {
                    "required": true,
                    "regex": "^[a-z0-9A-Z]+$",
                    "validationMessage": "The value must be alphanumeric."
                  }
                }
              ]
            },
            {
              "name": "networkWatchersApi",
              "type": "Microsoft.Solutions.ArmApiControl",
              "request": {
                "method": "GET",
                "path": "[concat(steps('basics').scope.subscription.id, '/providers/Microsoft.Network/networkWatchers?api-version=2023-09-01')]"
              }
            }
          ]
        },
        {
          "name": "network",
          "label": "Networking",
          "elements": [
            {
              "name": "vnet",
              "label": "Spoke Virtual Network",
              "type": "Microsoft.Common.Section",
              "elements": [
                {
                  "name": "vnetInformation",
                  "type": "Microsoft.Common.InfoBox",
                  "options": {
                    "text": "Please update the spoke subnetting and the private ip address of the application gateway fields based on your networking requirements.",
                    "style": "Info"
                  }
                },
                {
                  "name": "vnetAddressCidrRange",
                  "label": "Spoke Virtual Network CIDR",
                  "type": "Microsoft.Common.TextBox",
                  "defaultValue": "10.0.136.0/23",
                  "toolTip": "Specify an address CIDR range within the range [10,26].",
                  "constraints": {
                    "required": true,
                    "validations": [
                      {
                        "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(1[0-9]|2[0-6]))$",
                        "message": "Invalid CIDR range. The address prefix must be in the range [10,26]."
                      }
                    ]
                  }
                },
                {
                  "name": "appGwSubnetAddressCidrRange",
                  "label": "Application Gateway Subnet",
                  "type": "Microsoft.Common.TextBox",
                  "defaultValue": "10.0.136.0/24",
                  "toolTip": "Specify a CIDR range for the Application Gateway subnet within the Spoke Virtual Network range [10,24].",
                  "constraints": {
                    "required": true,
                    "validations": [
                      {
                        "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(1[0-9]|2[0-6]))$",
                        "message": "Invalid CIDR range. The address prefix must be in the range [10,26]."
                      },
                      {
                        "isValid": "[if(greaterOrEquals(last(split(steps('network').vnet.vnetAddressCidrRange, '/')), 8), equals(last(take(split(first(split(steps('network').vnet.vnetAddressCidrRange, '/')), '.'), 1)), last(take(split(first(split(steps('network').vnet.appGwSubnetAddressCidrRange, '/')), '.'), 1))), true)]",
                        "message": "CIDR range not within virtual network CIDR range (first octet)."
                      },
                      {
                        "isValid": "[if(greaterOrEquals(last(split(steps('network').vnet.vnetAddressCidrRange, '/')), 16), equals(last(take(split(first(split(steps('network').vnet.vnetAddressCidrRange, '/')), '.'), 2)), last(take(split(first(split(steps('network').vnet.appGwSubnetAddressCidrRange, '/')), '.'), 2))), true)]",
                        "message": "CIDR range not within virtual network CIDR range (second octet)."
                      },
                      {
                        "isValid": "[if(greaterOrEquals(last(split(steps('network').vnet.vnetAddressCidrRange, '/')), 24), equals(last(take(split(first(split(steps('network').vnet.vnetAddressCidrRange, '/')), '.'), 3)), last(take(split(first(split(steps('network').vnet.appGwSubnetAddressCidrRange, '/')), '.'), 3))), true)]",
                        "message": "CIDR range not within virtual network CIDR range (third octet)."
                      },
                      {
                        "isValid": "[lessOrEquals(last(split(steps('network').vnet.vnetAddressCidrRange, '/')), last(split(steps('network').vnet.appGwSubnetAddressCidrRange, '/')))]",
                        "message": "CIDR range not within virtual network CIDR range (subnet mask)."
                      }
                    ]
                  }
                },
                {
                  "name": "esriSubnetAddressCidrRange",
                  "label": "ESRI Enterprise Virtual Machine Subnet",
                  "type": "Microsoft.Common.TextBox",
                  "defaultValue": "10.0.137.0/24",
                  "toolTip": "Specify a CIDR range for the Management Virtual Machine subnet within the Spoke Virtual Network range [10,24].",
                  "constraints": {
                    "required": true,
                    "validations": [
                      {
                        "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(1[0-9]|2[0-6]))$",
                        "message": "Invalid CIDR range. The address prefix must be in the range [10,26]."
                      },
                      {
                        "isValid": "[if(greaterOrEquals(last(split(steps('network').vnet.vnetAddressCidrRange, '/')), 8), equals(last(take(split(first(split(steps('network').vnet.vnetAddressCidrRange, '/')), '.'), 1)), last(take(split(first(split(steps('network').vnet.esriSubnetAddressCidrRange, '/')), '.'), 1))), true)]",
                        "message": "CIDR range not within virtual network CIDR range (first octet)."
                      },
                      {
                        "isValid": "[if(greaterOrEquals(last(split(steps('network').vnet.vnetAddressCidrRange, '/')), 16), equals(last(take(split(first(split(steps('network').vnet.vnetAddressCidrRange, '/')), '.'), 2)), last(take(split(first(split(steps('network').vnet.esriSubnetAddressCidrRange, '/')), '.'), 2))), true)]",
                        "message": "CIDR range not within virtual network CIDR range (second octet)."
                      },
                      {
                        "isValid": "[if(greaterOrEquals(last(split(steps('network').vnet.vnetAddressCidrRange, '/')), 24), equals(last(take(split(first(split(steps('network').vnet.vnetAddressCidrRange, '/')), '.'), 3)), last(take(split(first(split(steps('network').vnet.esriSubnetAddressCidrRange, '/')), '.'), 3))), true)]",
                        "message": "CIDR range not within virtual network CIDR range (third octet)."
                      },
                      {
                        "isValid": "[lessOrEquals(last(split(steps('network').vnet.vnetAddressCidrRange, '/')), last(split(steps('network').vnet.esriSubnetAddressCidrRange, '/')))]",
                        "message": "CIDR range not within virtual network CIDR range (subnet mask)."
                      }
                    ]
                  }
                },
                {
                  "name": "logAnalyticsWorkspace",
                  "type": "Microsoft.Solutions.ResourceSelector",
                  "label": "Existing log analytics workspace",
                  "visible": "true",
                  "resourceType": "Microsoft.OperationalInsights/workspaces",
                  "toolTip": "Select the log analytics workspace to capture runbook log output.",
                  "options": {}
                }
              ]
            },
            {
              "name": "flowLogsSection",
              "label": "Network Watcher Flow Logs",
              "type": "Microsoft.Common.Section",
              "elements": [
                {
                  "name": "flowLogsDescription",
                  "type": "Microsoft.Common.TextBlock",
                  "options": {
                    "text": "To support the on-going security and compliance of your landing zone, MLZ configures network watcher flow logs for virtual networks by default. Flow logs capture information about IP traffic flowing through your virtual Networks or network security groups. Flow log data can be used to troubleshoot network connectivity issues, monitor network traffic, and detect and diagnose security threats.",
                    "link": {
                      "label": "Click here to learn more about network watcher flow logs",
                      "uri": "https://learn.microsoft.com/azure/network-watcher/network-watcher-overview#flow-logs"
                    }
                  }
                },
                {
                  "name": "flowLogsType",
                  "label": "Flow Logs Type",
                  "type": "Microsoft.Common.DropDown",
                  "defaultValue": "Virtual Network (recommended)",
                  "toolTip": "Select the type of flow logs to deploy.",
                  "constraints": {
                    "allowedValues": [
                      {
                        "label": "Virtual Network (recommended)",
                        "value": "VirtualNetwork"
                      },
                      {
                        "label": "Network Security Group",
                        "value": "NetworkSecurityGroup"
                      }
                    ]
                  }
                },
                {
                  "name": "nsgFlowLogsRetirementWarning",
                  "type": "Microsoft.Common.InfoBox",
                  "visible": "[equals(steps('networking').flowLogsSection.flowLogsType, 'deployNetworkSecurityGroupFlowLogs')]",
                  "options": {
                    "style": "Warning",
                    "text": "NSG flow logs are scheduled for retirement on June 30, 2025. All customers should move to VNet flow logs which offer more logging and visibility. Click here learn more about NSG flow log retirement",
                    "uri": "https://learn.microsoft.com/azure/network-watcher/nsg-flow-logs-overview"
                  }
                },
                {
                  "name": "retentionDays",
                  "label": "Retention Days",
                  "type": "Microsoft.Common.TextBox",
                  "defaultValue": "30",
                  "toolTip": "Enter the number of days to retain the network watcher flow logs. If you want to retain the data forever and do not want to apply any retention policy, set retention (days) to 0.",
                  "constraints": {
                    "required": true,
                    "regex": "^36[0-5]$|^3[0-5][0-9]$|^[1-2][0-9][0-9]$|^[0-9][0-9]$|^[0-9]$",
                    "message": "The value must be between 0 and 365."
                  }
                },
                {
                  "name": "deployTrafficAnalytics",
                  "label": "Enable Traffic Analytics",
                  "type": "Microsoft.Common.CheckBox",
                  "defaultValue": false,
                  "toolTip": "Enable this option to deploy Network Watcher Traffic Analytics."
                }
              ]
            }
          ]
        },
        {
          "name": "server",
          "label": "Server",
          "elements": [
            {
              "name": "esri",
              "type": "Microsoft.Common.Section",
              "label": "Architecture",
              "visible": true,
              "elements": [
                {
                  "name": "architecture",
                  "type": "Microsoft.Common.OptionsGroup",
                  "label": "Select the ESRI architecture",
                  "defaultValue": "Single Machine (Single-Tier)",
                  "toolTip": "",
                  "constraints": {
                    "allowedValues": [
                      {
                        "label": "Single Machine (Single-Tier)",
                        "value": false
                      },
                      {
                        "label": "Multiple Machines (Multi-Tier)",
                        "value": true
                      }
                    ],
                    "required": true
                  },
                  "visible": true
                }
              ]
            },
            {
              "name": "domain",
              "type": "Microsoft.Common.Section",
              "label": "Domain Settings",
              "visible": true,
              "elements": [
                {
                  "name": "identity",
                  "type": "Microsoft.Common.OptionsGroup",
                  "visible": true,
                  "label": "Microsoft Entra Domain Services",
                  "defaultValue": "Microsoft Entra ID",
                  "toolTip": "Choose the Active Directory solution that already exists.",
                  "constraints": {
                    "required": true,
                    "allowedValues": [
                      {
                        "label": "Microsoft Entra ID",
                        "value": false
                      },
                      {
                        "label": "Active Directory Domain Services (ADDS)",
                        "value": true
                      }
                    ]
                  }
                },
                {
                  "name": "name",
                  "type": "Microsoft.Common.TextBox",
                  "visible": "[steps('server').domain.identity]",
                  "label": "Domain Name",
                  "toolTip": "Provide domain name for Active Directory Domain Services.",
                  "placeholder": "Example: contoso.com",
                  "constraints": {
                    "required": true
                  }
                },
                {
                  "name": "ouPath",
                  "type": "Microsoft.Common.TextBox",
                  "visible": "[steps('server').domain.identity]",
                  "label": "OU Path",
                  "toolTip": "Input the distinguished name of the desired organization unit.",
                  "placeholder": "Example: OU=servers,OU=arcgis,DC=contoso,DC=com",
                  "constraints": {
                    "required": true
                  }
                },
                {
                  "name": "userPrincipalName",
                  "type": "Microsoft.Common.TextBox",
                  "visible": "[steps('server').domain.identity]",
                  "label": "User principal name (do not include the @ domainname)",
                  "toolTip": "Enter the user principal name with domain join privileges.",
                  "placeholder": "admin",
                  "required": true,
                  "constraints": {}
                },
                {
                  "name": "password",
                  "type": "Microsoft.Common.PasswordBox",
                  "visible": "[steps('server').domain.identity]",
                  "label": {
                    "password": "Domain join password"
                  },
                  "toolTip": "Enter a password that is alphanumeric, contains at least 12 characters, 1 letter, 1 number and 1 special character.",
                  "constraints": {
                    "required": true
                  },
                  "options": {
                    "hideConfirmation": true
                  }
                }
              ]
            },
            {
              "name": "localAdminCredentials",
              "type": "Microsoft.Common.Section",
              "visible": true,
              "label": "Local administrator credential",
              "elements": [
                {
                  "name": "username",
                  "type": "Microsoft.Common.TextBox",
                  "label": "Username",
                  "defaultValue": "",
                  "toolTip": "Input the username for the local administrator account.",
                  "constraints": {
                    "required": true,
                    "regex": "",
                    "validationMessage": ""
                  },
                  "visible": true
                },
                {
                  "name": "password",
                  "type": "Microsoft.Common.PasswordBox",
                  "label": {
                    "password": "Password",
                    "confirmPassword": "Confirm Password"
                  },
                  "toolTip": "Input the password for the local administrator account.",
                  "constraints": {
                    "required": true,
                    "regex": "^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[@#$%^&+=_!*<>()])(?=\\S+$).{12,123}$",
                    "validationMessage": "The value must be within 12 to 123 characters, be alphanumeric, and include 1 lower case character, 1 upper case character, 1 number, and 1 special character that is not '\\' or '-'."
                  },
                  "options": {
                    "hideConfirmation": false
                  },
                  "visible": true
                }
              ]
            },
            {
              "name": "configuration",
              "type": "Microsoft.Common.Section",
              "label": "Configuration settings",
              "visible": true,
              "elements": [
                {
                  "name": "useAzureStorage",
                  "type": "Microsoft.Common.CheckBox",
                  "label": "Use Azure Storage",
                  "defaultValue": false,
                  "visible": "[steps('server').esri.architecture]",
                  "toolTip": "Indicates whether the server is store esri portal and server content on an Azure storage file share."
                },
                {
                  "name": "osDiskSize",
                  "type": "Microsoft.Common.Slider",
                  "label": "OS Disk Size (GB)",
                  "defaultValue": 128,
                  "toolTip": "Input the virtual machine OS disk size in GB.",
                  "min": 32,
                  "max": 1024,
                  "showStepMarkers": false,
                  "constraints": {
                    "required": true
                  },
                  "visible": true
                },
                {
                  "name": "enableVirtualMachineDataDisk",
                  "type": "Microsoft.Common.CheckBox",
                  "label": "Enable data disk",
                  "defaultValue": false,
                  "toolTip": "Indicates whether an additional Managed Disk is attached to the Virtual Machine(s)."
                },
                {
                  "name": "enableMonitoring",
                  "type": "Microsoft.Common.CheckBox",
                  "label": "Enable monitoring",
                  "defaultValue": false,
                  "toolTip": "Indicates whether the Azure Monitor Agent will be installed on the virtual machine."
                },
                {
                  "name": "diskEncryptionSetSelector",
                  "type": "Microsoft.Solutions.ResourceSelector",
                  "label": "Select disk encryption set",
                  "resourceType": "Microsoft.Compute/diskEncryptionSets",
                  "required": true,
                  "options": {
                    "filter": {
                      "subscription": "onBasics",
                      "location": "onBasics"
                    }
                  }
                }
              ]
            }
          ]
        },
        {
          "name": "portal",
          "label": "Portal",
          "elements": [
            {
              "name": "primarySiteAdministratorAccount",
              "type": "Microsoft.Common.Section",
              "label": "ArcGIS primary site administrator account",
              "visible": true,
              "elements": [
                {
                  "name": "username",
                  "type": "Microsoft.Common.TextBox",
                  "label": "Username",
                  "defaultValue": "",
                  "toolTip": "Input the username for the ArcGIS primary site administrator account.",
                  "constraints": {
                    "required": true,
                    "regex": "",
                    "validationMessage": ""
                  },
                  "visible": true
                },
                {
                  "name": "password",
                  "type": "Microsoft.Common.PasswordBox",
                  "label": {
                    "password": "Password"
                  },
                  "toolTip": "Enter a password that is alphanumeric, contains at least 12 characters, a period special character.",
                  "constraints": {
                    "required": true,
                    "regex": "^[a-zA-Z0-9.]+$",
                    "validationMessage": "The value must be within 12 to 24 characters, and be alphanumeric, contains at least 12 characters, a period special character."
                  },
                  "options": {
                    "hideConfirmation": false
                  }
                }
              ]
            },
            {
              "name": "arcgisServiceAccount",
              "type": "Microsoft.Common.Section",
              "label": "ArcGIS service account",
              "visible": true,
              "elements": [
                {
                  "name": "isDomainAccount",
                  "type": "Microsoft.Common.CheckBox",
                  "label": "Is the ArcGIS service account a domain account?",
                  "defaultValue": true,
                  "toolTip": "Indicates whether the account is a domain or local account."
                },
                {
                  "name": "username",
                  "type": "Microsoft.Common.TextBox",
                  "label": "Username",
                  "defaultValue": "arcgis",
                  "toolTip": "Input the username for the service account.",
                  "constraints": {
                    "required": true,
                    "regex": "",
                    "validationMessage": ""
                  },
                  "visible": true
                },
                {
                  "name": "password",
                  "type": "Microsoft.Common.PasswordBox",
                  "label": {
                    "password": "Password"
                  },
                  "toolTip": "Enter a password that is alphanumeric, contains at least 12 characters, 1 letter, 1 number and 1 special character.",
                  "constraints": {
                    "required": true,
                    "regex": "^[a-zA-Z0-9@#$%^&+=_!*<>()]{12,123}$",
                    "validationMessage": "The value must be within 12 to 123 characters, be alphanumeric, and include 1 lower case character, 1 upper case character, 1 number, and 1 special character that is not '\\' or '-'."
                  },
                  "options": {
                    "hideConfirmation": false
                  }
                }
              ]
            },
            {
              "name": "configuration",
              "type": "Microsoft.Common.Section",
              "label": "Configuration settings",
              "visible": true,
              "elements": [
                {
                  "name": "externalDnsHostname",
                  "type": "Microsoft.Common.TextBox",
                  "label": "Fully Qualified Domain Name (FQDN) for the portal.",
                  "toolTip": "Input the Fully Qualified Domain Name (FQDN) for the portal.",
                  "placeholder": "Example: esri.contoso.com",
                  "constraints": {
                    "required": true,
                    "regex": "(?=^.{1,253}$)(^(((?!-)[a-zA-Z0-9-]{1,63}(?<!-))|((?!-)[a-zA-Z0-9-]{1,63}(?<!-)\\.)+[a-zA-Z]{2,63})$)",
                    "validationMessage": "The value must be a valid FQDN."
                  }
                },
                {
                  "name": "debugMode",
                  "type": "Microsoft.Common.CheckBox",
                  "label": "Enable debug mode",
                  "defaultValue": false,
                  "toolTip": "Indicates whether to enable the debug settings on the site deployment. Used for troubleshooting only and should not be used for a production deployment."
                }
              ]
            }
          ]
        },
        {
          "name": "datastoretypes",
          "label": "Data Store",
          "elements": [
            {
              "name": "dataStores",
              "type": "Microsoft.Common.Section",
              "label": "Data Store Types",
              "visible": true,
              "elements": [
                {
                  "name": "relational",
                  "type": "Microsoft.Common.CheckBox",
                  "defaultValue": true,
                  "label": "Relational",
                  "constraints": {
                    "required": true,
                    "value": true,
                    "validationMessage": "This is a required datastore type used by hosted feature layers."
                  }
                },
                {
                  "name": "tilecache",
                  "type": "Microsoft.Common.CheckBox",
                  "defaultValue": false,
                  "label": "Tilecache",
                  "constraints": {}
                },
                {
                  "name": "spatioTemporal",
                  "type": "Microsoft.Common.CheckBox",
                  "defaultValue": false,
                  "label": "SpatioTemporal",
                  "constraints": {}
                },
                {
                  "name": "graphstore",
                  "type": "Microsoft.Common.CheckBox",
                  "defaultValue": false,
                  "label": "Graph Store",
                  "visible": "[steps('server').esri.architecture]",
                  "constraints": {}
                },
                {
                  "name": "objectstore",
                  "type": "Microsoft.Common.CheckBox",
                  "defaultValue": false,
                  "label": "Object Store",
                  "visible": "[steps('server').esri.architecture]",
                  "constraints": {}
                }
              ]
            },
            {
              "name": "multitier",
              "type": "Microsoft.Common.Section",
              "label": "Multitier settings",
              "visible": "[steps('server').esri.architecture]",
              "elements": [
                {
                  "name": "numnberOfPortalMachines",
                  "type": "Microsoft.Common.Slider",
                  "label": "Portal",
                  "defaultValue": 2,
                  "toolTip": "Input the ESRI portal virtual machine",
                  "min": 1,
                  "max": 2,
                  "showStepMarkers": false,
                  "constraints": {
                    "required": true
                  },
                  "visible": true
                },
                {
                  "name": "numnberOfServerMachines",
                  "type": "Microsoft.Common.Slider",
                  "label": "Server",
                  "defaultValue": 1,
                  "toolTip": "Input the ESRI server virtual machine",
                  "min": 1,
                  "max": 10,
                  "showStepMarkers": false,
                  "constraints": {
                    "required": true
                  },
                  "visible": true
                },
                {
                  "name": "numberOfFileShareMachines",
                  "type": "Microsoft.Common.Slider",
                  "label": "File Share",
                  "defaultValue": 1,
                  "toolTip": "Input the ESRI file server virtual machines",
                  "min": 1,
                  "max": 1,
                  "showStepMarkers": false,
                  "constraints": {
                    "required": true
                  },
                  "visible": true
                },
                {
                  "name": "numberOfDataStoreMachines",
                  "type": "Microsoft.Common.Slider",
                  "label": "Relational Datastore",
                  "defaultValue": 1,
                  "toolTip": "Input the ESRI relation data store server virtual machines",
                  "min": 1,
                  "max": 2,
                  "showStepMarkers": false,
                  "constraints": {
                    "required": true
                  },
                  "visible": true
                },
                {
                  "name": "numberOfTilecacheDataStoreMachines",
                  "type": "Microsoft.Common.Slider",
                  "label": "Tile Cache",
                  "defaultValue": 1,
                  "toolTip": "Input the ESRI tilecache data store server virtual machines",
                  "min": 1,
                  "max": 10,
                  "showStepMarkers": false,
                  "constraints": {
                    "required": true
                  },
                  "visible": "[steps('datastoretypes').dataStores.tilecache]"
                },
                {
                  "name": "numberOfSpatioTemporalDataStoreMachines",
                  "type": "Microsoft.Common.Slider",
                  "label": "SpatioTemporal",
                  "defaultValue": 1,
                  "toolTip": "Input the ESRI spatioTemporal data store server virtual machines",
                  "min": 1,
                  "max": 10,
                  "showStepMarkers": false,
                  "constraints": {
                    "required": true
                  },
                  "visible": "[steps('datastoretypes').dataStores.spatioTemporal]"
                },
                {
                  "name": "numberOfGraphStoreDataStoreMachines",
                  "type": "Microsoft.Common.Slider",
                  "label": "Graph Datastore",
                  "defaultValue": 1,
                  "toolTip": "Input the ESRI graphstore data store server virtual machines",
                  "min": 1,
                  "max": 1,
                  "showStepMarkers": false,
                  "constraints": {
                    "required": true
                  },
                  "visible": "[steps('datastoretypes').dataStores.graphstore]"
                },
                {
                  "name": "numberOfObjectStoreDataStoreMachines",
                  "type": "Microsoft.Common.Slider",
                  "label": "Object Datastore",
                  "defaultValue": 1,
                  "toolTip": "Input the ESRI object data store server virtual machines",
                  "min": 3,
                  "max": 9,
                  "showStepMarkers": false,
                  "constraints": {
                    "required": true
                  },
                  "visible": "[steps('datastoretypes').dataStores.objectstore]"
                }
              ]
            }
          ]
        },
        {
          "name": "licenses",
          "label": "Licenses",
          "elements": [
            {
              "name": "files",
              "type": "Microsoft.Common.Section",
              "label": "License files",
              "visible": true,
              "elements": [
                {
                  "name": "portal",
                  "type": "Microsoft.Common.FileUpload",
                  "label": "Select your portal license file (.json)",
                  "toolTip": "Upload the portal license file with the JSON file extension.",
                  "constraints": {
                    "required": true,
                    "accept": ""
                  },
                  "options": {
                    "multiple": false,
                    "uploadMode": "file",
                    "openMode": "binary",
                    "encoding": ""
                  },
                  "visible": true,
                  "scope": {
                    "subscriptionId": "[steps('basics').resourceScope.subscription.subscriptionId]"
                  },
                  "resourceTypeMetadata": []
                },
                {
                  "name": "server",
                  "type": "Microsoft.Common.FileUpload",
                  "label": "Select your server license file (.prvc)",
                  "toolTip": "Upload the server license file with the PRVC file extension.",
                  "constraints": {
                    "required": true,
                    "accept": ""
                  },
                  "options": {
                    "multiple": false,
                    "uploadMode": "file",
                    "openMode": "binary",
                    "encoding": ""
                  },
                  "visible": true,
                  "scope": {
                    "subscriptionId": "[steps('basics').resourceScope.subscription.subscriptionId]"
                  },
                  "resourceTypeMetadata": []
                },
                {
                  "name": "licenseUserType",
                  "type": "Microsoft.Common.DropDown",
                  "label": "License Type",
                  "placeholder": "",
                  "defaultValue": [],
                  "toolTip": "License User Type",
                  "multiselect": false,
                  "selectAll": false,
                  "filter": false,
                  "filterPlaceholder": "Filter items ...",
                  "multiLine": false,
                  "defaultDescription": "A value for selection",
                  "constraints": {
                    "allowedValues": [
                      {
                        "label": "CreatorUT",
                        "description": "The value to select for option 1.",
                        "value": "CreatorUT"
                      },
                      {
                        "label": "editorUT",
                        "description": "The value to select for option 1.",
                        "value": "editorUT"
                      },
                      {
                        "label": "fieldWorkerUT",
                        "description": "The value to select for option 1.",
                        "value": "fieldWorkerUT"
                      },
                      {
                        "label": "GISProfessionalAdvUT",
                        "description": "The value to select for option 1.",
                        "value": "GISProfessionalAdvUT"
                      },
                      {
                        "label": "GISProfessionalBasicUTUT",
                        "description": "The value to select for option 1.",
                        "value": "GISProfessionalBasicUTUT"
                      },
                      {
                        "value": "GISProfessionalStdUT",
                        "label": "GISProfessionalStdUT",
                        "description": "The value to select for option 1."
                      },
                      {
                        "label": "IndoorsUserUT",
                        "description": "The value to select for option 1.",
                        "value": "IndoorsUserUT"
                      },
                      {
                        "label": "insightsAnalystUT",
                        "description": "The value to select for option 1.",
                        "value": "insightsAnalystUT"
                      },
                      {
                        "label": "viewerUT",
                        "description": "The value to select for option 1.",
                        "value": "viewerUT"
                      }
                    ],
                    "required": true
                  },
                  "visible": true
                }
              ]
            }
          ]
        },
        {
          "name": "certificates",
          "label": "Certificates",
          "elements": [
            {
              "name": "storageAccount",
              "type": "Microsoft.Common.Section",
              "label": "Storage Account",
              "visible": true,
              "elements": [
                {
                  "name": "storageSelector",
                  "type": "Microsoft.Solutions.ResourceSelector",
                  "label": "Storage where your ESRI pre-req files uploaded",
                  "resourceType": "Microsoft.Storage/storageAccounts",
                  "required": true,
                  "options": {
                    "filter": {}
                  }
                },
                {
                  "name": "containerApi",
                  "type": "Microsoft.Solutions.ArmApiControl",
                  "request": {
                    "method": "GET",
                    "path": "[concat(steps('certificates').storageAccount.storageSelector.id, '/blobServices/default/containers?api-version=2023-01-01')]"
                  }
                },
                {
                  "name": "container",
                  "type": "Microsoft.Common.DropDown",
                  "visible": true,
                  "label": "Container",
                  "defaultValue": "",
                  "toolTip": "Select an existing container where your ESRI pre-req files are uploaded.",
                  "constraints": {
                    "required": true,
                    "allowedValues": "[map(steps('certificates').storageAccount.containerApi.value, (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.id, '\"}')))]"
                  }
                }
              ]
            },
            {
              "name": "pfx",
              "type": "Microsoft.Common.Section",
              "label": "Certificate",
              "visible": true,
              "elements": [
                {
                  "name": "certificateFileName",
                  "type": "Microsoft.Common.TextBox",
                  "label": "Name",
                  "defaultValue": "",
                  "toolTip": "",
                  "placeholder": "wildcard_contoso_com.pfx",
                  "multiLine": false,
                  "constraints": {
                    "required": true,
                    "validations": []
                  },
                  "visible": true,
                  "required": true
                },
                {
                  "name": "certificatePassword",
                  "type": "Microsoft.Common.PasswordBox",
                  "visible": true,
                  "label": "certificate password",
                  "toolTip": "Enter the password associated with the certificate.",
                  "constraints": {
                    "required": true
                  },
                  "options": {
                    "hideConfirmation": true
                  }
                }
              ]
            }
          ]
        },
        {
          "name": "compliance",
          "label": "Compliance",
          "elements": [
            {
              "name": "defenderForCloud",
              "label": "Defender for Cloud",
              "type": "Microsoft.Common.Section",
              "elements": [
                {
                  "name": "workspaceSettingsApi",
                  "type": "Microsoft.Solutions.ArmApiControl",
                  "request": {
                    "method": "GET",
                    "path": "[concat(steps('basics').scope.subscription.id, '/providers/Microsoft.Security/workspaceSettings?api-version=2017-08-01-preview')]"
                  }
                },
                {
                  "name": "deployDefender",
                  "type": "Microsoft.Common.CheckBox",
                  "label": "Enable Defender for Cloud?",
                  "toolTip": "Check here to to deploy defender for cloud to the target subscription.",
                  "constraints": {
                    "required": false
                  }
                },
                {
                  "name": "emailSecurityContact",
                  "type": "Microsoft.Common.TextBox",
                  "label": "Email Address for Security Notifications",
                  "defaultValue": "",
                  "toolTip": "Please enter a valid email address for the security team.",
                  "constraints": {
                    "required": true,
                    "regex": "^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+$",
                    "validationMessage": "Email is not valid. Please re-enter."
                  },
                  "visible": "[steps('compliance').defenderForCloud.deployDefender]"
                }
              ]
            },
            {
              "name": "policySection",
              "label": "Azure Policy",
              "type": "Microsoft.Common.Section",
              "elements": [
                {
                  "name": "policySubsetDetailsTextBlock",
                  "type": "Microsoft.Common.TextBlock",
                  "options": {
                    "text": "Mission Landing Zone comes bundled with a relevant subset of available Azure policies."
                  }
                },
                {
                  "name": "policyOptionalTextBlock",
                  "type": "Microsoft.Common.TextBlock",
                  "options": {
                    "text": "Enabling policies is optional, but recommended."
                  }
                },
                {
                  "name": "deployPolicy",
                  "type": "Microsoft.Common.CheckBox",
                  "label": "Deploy policy assignments?",
                  "toolTip": "Check here to create policy assignments for the resources created by Mission Landing Zone.",
                  "constraints": {
                    "required": false
                  }
                },
                {
                  "name": "policy",
                  "type": "Microsoft.Common.DropDown",
                  "label": "Policy Assignment",
                  "placeholder": "",
                  "defaultValue": "NIST SP 800-53",
                  "toolTip": "DoD IL5 is only available in AzureUsGovernment and will switch to NISTRev4 if tried in AzureCloud.",
                  "multiselect": false,
                  "selectAll": false,
                  "filter": true,
                  "filterPlaceholder": "Filter items ...",
                  "multiLine": true,
                  "defaultDescription": "Select one of the bundled built-in policy assignments.",
                  "constraints": {
                    "allowedValues": [
                      {
                        "label": "NIST SP 800-53 Rev4",
                        "description": "The US National Institute of Standards and Technology (NIST) publishes a catalog of security and privacy controls, Special Publication (SP) 800-53, for all federal information systems in the United States (except those related to national security).",
                        "value": "NISTRev4"
                      },
                      {
                        "label": "NIST SP 800-53 Rev5",
                        "description": "The US National Institute of Standards and Technology (NIST) publishes a catalog of security and privacy controls, Special Publication (SP) 800-53, for all federal information systems in the United States (except those related to national security).",
                        "value": "NISTRev5"
                      },
                      {
                        "label": "DoD IL5",
                        "description": "The Defense Information Systems Agency (DISA) is an agency of the US Department of Defense (DoD) that is responsible for developing and maintaining the DoD Cloud Computing Security Requirements Guide (SRG). These policies are only available for AzureUsGovernment and will switch to NISTRev4 if tried in AzureCloud.",
                        "value": "IL5"
                      },
                      {
                        "label": "CMMC",
                        "description": "The Cybersecurity Maturity Model Certification (CMMC) is a new framework developed by the US Department of Defense (DoD) that requires formal third-party audits of defense industrial base (DIB) contractor cybersecurity practices.",
                        "value": "CMMC"
                      }
                    ]
                  },
                  "visible": "[steps('compliance').policySection.deployPolicy]"
                }
              ]
            },
            {
              "name": "virtualNetworkApi",
              "type": "Microsoft.Solutions.ArmApiControl",
              "request": {
                "method": "GET",
                "path": "[concat(steps('basics').hub.virtualNetwork, '?api-version=2023-09-01')]"
              }
            },
            {
              "name": "logAnalyticsWorkspacesApi",
              "type": "Microsoft.Solutions.ArmApiControl",
              "request": {
                "method": "GET",
                "path": "[concat('/subscriptions/', first(skip(split(first(map(filter(steps('compliance').virtualNetworkApi.properties.virtualNetworkPeerings, (item) => contains(item.properties.remoteVirtualNetwork.id, 'operations')), (item) => item.properties.remoteVirtualNetwork.id)), '/'), 2)), '/resourcegroups/', first(skip(split(first(map(filter(steps('compliance').virtualNetworkApi.properties.virtualNetworkPeerings, (item) => contains(item.properties.remoteVirtualNetwork.id, 'operations')), (item) => item.properties.remoteVirtualNetwork.id)), '/'), 4)), '/providers/Microsoft.OperationalInsights/workspaces?api-version=2023-09-01')]"
              }
            },
            {
              "name": "logAnalyticsWorkspace",
              "type": "Microsoft.Common.DropDown",
              "visible": true,
              "label": "Existing Log Analytics Workspace for Central Logging",
              "defaultValue": "[first(map(steps('compliance').logAnalyticsWorkspacesApi.value, (item) => item.name))]",
              "filter": true,
              "toolTip": "Select the existing Hub Azure firewall.",
              "constraints": {
                "required": true,
                "allowedValues": "[map(steps('compliance').logAnalyticsWorkspacesApi.value, (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.id, '\"}')))]"
              }
            },
            {
              "name": "diagnosticSettingsApi",
              "type": "Microsoft.Solutions.ArmApiControl",
              "request": {
                "method": "GET",
                "path": "[concat(steps('basics').scope.subscription.id, '/providers/Microsoft.Insights/diagnosticSettings?api-version=2021-05-01-preview')]"
              }
            }
          ]
        },
        {
          "name": "tags",
          "label": "Tags",
          "elements": [
            {
              "name": "tags",
              "type": "Microsoft.Common.TagsByResource",
              "resources": [
                "Microsoft.Compute/availabilitySets",
                "Microsoft.Compute/diskEncryptionSets",
                "Microsoft.Compute/virtualMachines",
                "Microsoft.KeyVault/vaults",
                "Microsoft.ManagedIdentity/userAssignedIdentities",
                "Microsoft.Network/applicationGateways",
                "Microsoft.Network/networkInterfaces",
                "Microsoft.Network/networkSecurityGroups",
                "Microsoft.Network/networkWatchers",
                "Microsoft.Network/privateEndpoints",
                "Microsoft.Network/publicIPAddresses",
                "Microsoft.Network/routeTables",
                "Microsoft.Network/virtualNetworks",
                "Microsoft.Resources/deploymentScripts",
                "Microsoft.Resources/resourceGroups",
                "Microsoft.Storage/storageAccounts"
              ]
            }
          ]
        }
      ]
    },
    "outputs": {
      "parameters": {
        "applicationGatewaySubnetAddressPrefix": "[steps('network').vnet.appGwSubnetAddressCidrRange]",
        "arcgisServiceAccountIsDomainAccount": "[steps('portal').arcgisServiceAccount.isDomainAccount]",
        "arcgisServiceAccountPassword": "[steps('portal').arcgisServiceAccount.password]",
        "arcgisServiceAccountUsername": "[steps('portal').arcgisServiceAccount.username]",
        "architecture": "[if(equals(steps('server').esri.architecture, true), 'multitier', 'singletier')]",
        "artifactsContainerName": "[first(skip(split(steps('certificates').storageAccount.container, '/'), 12))]",
        "artifactsStorageAccountName": "[steps('certificates').storageAccount.storageSelector.name]",
        "artifactsStorageAccountResourceGroupName": "[first(skip(split(steps('certificates').storageAccount.storageSelector.id, '/'), 4))]",
        "artifactsStorageAccountSubscriptionId": "[first(skip(split(steps('certificates').storageAccount.storageSelector.id, '/'), 2))]",
        "azureFirewallName": "[first(skip(split(steps('basics').hub.azureFirewall, '/'), 8))]",
        "certificateFileName": "[steps('certificates').pfx.certificateFileName]",
        "certificatePassword": "[steps('certificates').pfx.certificatePassword]",
        "debugMode": "[steps('portal').configuration.debugMode]",
        "defaultSubnetAddressPrefix": "[steps('network').vnet.esriSubnetAddressCidrRange]",
        "deployDefender": "[and(steps('compliance').defenderForCloud.deployDefender, empty(steps('compliance').defenderForCloud.workspaceSettingsApi.value))]",
        "deployNetworkWatcherTrafficAnalytics": "[steps('networking').flowLogsSection.deployTrafficAnalytics]",
        "deployPolicy": "[steps('compliance').policySection.deployPolicy]",
        "diskEncryptionSetResourceId": "[steps('server').configuration.diskEncryptionSetSelector.id]",
        "emailSecurityContact": "",
        "enableGraphDataStore": "[if(equals(steps('server').esri.architecture, true), steps('datastoretypes').dataStores.graphstore, false)]",
        "enableMonitoring": "[steps('server').configuration.enableMonitoring]",
        "enableObjectDataStore": "[if(equals(steps('server').esri.architecture, true), steps('datastoretypes').dataStores.objectstore, false)]",
        "enableSpatiotemporalBigDataStore": "[steps('datastoretypes').dataStores.spatioTemporal]",
        "enableTileCacheDataStore": "[steps('datastoretypes').dataStores.tilecache]",
        "enableVirtualMachineDataDisk": "[steps('server').configuration.enableVirtualMachineDataDisk]",
        "externalDnsHostname": "[steps('portal').configuration.externalDnsHostname]",
        "hubResourceGroupName": "[first(skip(split(steps('basics').hub.azureFirewall, '/'), 4))]",
        "hubSubscriptionId": "[replace(steps('basics').subscriptions.hub, '/subscriptions/', '')]",
        "hubVirtualNetworkName": "[first(skip(split(steps('basics').hub.virtualNetwork, '/'), 8))]",
        "isTileCacheDataStoreClustered": false,
        "isUpdatingCertificates": false,
        "joinEntraDomain": "[if(equals(steps('server').domain.identity, false), true, false)]",
        "joinWindowsDomain": "[if(equals(steps('server').domain.identity, true), true, false)]",
        "logAnalyticsWorkspaceName": "[steps('network').vnet.logAnalyticsWorkspace.name]",
        "networkWatcherFlowLogsRetentionDays": "[steps('networking').flowLogsSection.retentionDays]",
        "networkWatcherFlowLogsType": "[steps('networking').flowLogsSection.flowLogsType]",
        "networkWatcherResourceId": "[if(not(empty(filter(steps('basics').networkWatchersApi.value, (item) => equals(item.location, steps('basics').scope.location.name)))), first(map(filter(steps('basics').networkWatchersApi.value, (item) => equals(item.location, steps('basics').scope.location.name)), (item) => item.id)), '')]",
        "numberOfDataStoreVirtualMachines": "[steps('datastoretypes').multitier.numnberOfPortalMachines]",
        "numberOfEsriServers": "[steps('datastoretypes').multitier.numnberOfServerMachines]",
        "numberOfEsrispatiotemporalBigDataStoreVirtualMachines": "[if(equals(steps('datastoretypes').dataStores.spatioTemporal, true), steps('datastoretypes').multitier.numberOfSpatioTemporalDataStoreMachines, 0)]",
        "numberOfFileShareVirtualMachines": "[steps('datastoretypes').multitier.numberOfFileShareMachines]",
        "numberOfGraphDataStoreVirtualMachines": "[if(equals(steps('datastoretypes').dataStores.graphstore, true), steps('datastoretypes').multitier.numberOfGraphStoreDataStoreMachines, 0)]",
        "numberOfObjectStoreDataStoreVirtualMachines": "[if(equals(steps('datastoretypes').dataStores.objectstore, true), steps('datastoretypes').multitier.numberOfObjectStoreDataStoreMachines, 0)]",
        "numberOfPortalVirtualMachines": "[steps('datastoretypes').multitier.numnberOfPortalMachines]",
        "numberOfRelationalDataStoreVirtualMachines": "[steps('datastoretypes').multitier.numberOfDataStoreMachines]",
        "numberOfTileCacheDataStoreVirtualMachines": "[if(equals(steps('datastoretypes').dataStores.tilecache, true), steps('datastoretypes').multitier.numberOfTilecacheDataStoreMachines, 0)]",
        "ouPath": "[if(equals(steps('server').domain.identity, true), steps('server').domain.ouPath, '')]",
        "portalLicenseFile": "[steps('licenses').files.portal]",
        "portalLicenseUserTypeId": "[steps('licenses').files.licenseUserType]",
        "primarySiteAdministratorAccountPassword": "[steps('portal').primarySiteAdministratorAccount.password]",
        "primarySiteAdministratorAccountUserName": "[steps('portal').primarySiteAdministratorAccount.username]",
        "resourcePrefix": "[steps('basics').naming.resourceSuffix]",
        "resourceSuffix": "[steps('basics').naming.resourceSuffix]",
        "selfSignedCertificatePassword": "[steps('certificates').pfx.certificatePassword]",
        "serverLicenseFile": "[steps('licenses').files.server]",
        "spokelogAnalyticsWorkspaceResourceId": "[steps('network').vnet.logAnalyticsWorkspace.id]",
        "tags": "[steps('tags').tags]",
        "useAzureFiles": "[if(equals(steps('server').esri.architecture, true), steps('server').configuration.useAzureStorage, false)]",
        "useCloudStorage": "[if(equals(steps('server').esri.architecture, true), steps('server').configuration.useAzureStorage, false)]",
        "virtualMachineAdminPassword": "[steps('server').localAdminCredentials.password]",
        "virtualMachineAdminUsername": "[steps('server').localAdminCredentials.username]",
        "virtualMachineOSDiskSize": "[steps('server').configuration.osDiskSize]",
        "virtualNetworkAddressPrefix": "[steps('network').vnet.vnetAddressCidrRange]",
        "windowsDomainAdministratorPassword": "[if(equals(steps('server').domain.identity, true), steps('server').domain.password, '')]",
        "windowsDomainAdministratorUserName": "[if(equals(steps('server').domain.identity, true), steps('server').domain.userPrincipalName, '')]",
        "windowsDomainName": "[if(equals(steps('server').domain.identity, true), steps('server').domain.name, '')]",
        "workloadSubscriptionId": "[replace(steps('basics').subscriptions.spoke , '/subscriptions/', '')]"
      },
      "kind": "Subscription",
      "location": "[steps('basics').scope.location.name]",
      "subscriptionId": "[steps('basics').scope.subscription.id]"
    }
  }
}