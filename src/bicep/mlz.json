{
  "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "_generator": {
      "name": "bicep",
      "version": "0.4.613.9944",
      "templateHash": "3895776258968515169"
    }
  },
  "parameters": {
    "resourcePrefix": {
      "type": "string",
      "defaultValue": "[format('mlz-{0}', parameters('uniqueId'))]",
      "metadata": {
        "description": "A name (3-24 alphanumeric characters in length without whitespace) used to prefix resources and generate uniqueness for resources with globally unique naming requirements like Storage Accounts and Log Analytics Workspaces"
      },
      "maxLength": 24,
      "minLength": 3
    },
    "hubSubscriptionId": {
      "type": "string",
      "defaultValue": "[subscription().subscriptionId]"
    },
    "identitySubscriptionId": {
      "type": "string",
      "defaultValue": "[parameters('hubSubscriptionId')]"
    },
    "operationsSubscriptionId": {
      "type": "string",
      "defaultValue": "[parameters('hubSubscriptionId')]"
    },
    "sharedServicesSubscriptionId": {
      "type": "string",
      "defaultValue": "[parameters('hubSubscriptionId')]"
    },
    "firewallSkuTier": {
      "type": "string",
      "defaultValue": "Premium",
      "allowedValues": [
        "Standard",
        "Premium"
      ]
    },
    "hubResourceGroupName": {
      "type": "string",
      "defaultValue": "[format('{0}-hub', parameters('resourcePrefix'))]"
    },
    "hubLocation": {
      "type": "string",
      "defaultValue": "[deployment().location]"
    },
    "hubVirtualNetworkName": {
      "type": "string",
      "defaultValue": "hub-vnet"
    },
    "hubSubnetName": {
      "type": "string",
      "defaultValue": "hub-subnet"
    },
    "hubVirtualNetworkAddressPrefix": {
      "type": "string",
      "defaultValue": "10.0.100.0/24"
    },
    "hubSubnetAddressPrefix": {
      "type": "string",
      "defaultValue": "10.0.100.128/27"
    },
    "hubVirtualNetworkDiagnosticsLogs": {
      "type": "array",
      "defaultValue": []
    },
    "hubVirtualNetworkDiagnosticsMetrics": {
      "type": "array",
      "defaultValue": []
    },
    "hubNetworkSecurityGroupName": {
      "type": "string",
      "defaultValue": "hub-nsg"
    },
    "hubNetworkSecurityGroupRules": {
      "type": "array",
      "defaultValue": []
    },
    "hubSubnetServiceEndpoints": {
      "type": "array",
      "defaultValue": []
    },
    "hubLogStorageAccountName": {
      "type": "string",
      "defaultValue": "[toLower(take(format('hublogs{0}', parameters('uniqueId')), 24))]"
    },
    "hubLogStorageSkuName": {
      "type": "string",
      "defaultValue": "Standard_GRS"
    },
    "firewallName": {
      "type": "string",
      "defaultValue": "firewall"
    },
    "firewallManagementSubnetAddressPrefix": {
      "type": "string",
      "defaultValue": "10.0.100.64/26"
    },
    "firewallClientSubnetAddressPrefix": {
      "type": "string",
      "defaultValue": "10.0.100.0/26"
    },
    "firewallPolicyName": {
      "type": "string",
      "defaultValue": "firewall-policy"
    },
    "firewallThreatIntelMode": {
      "type": "string",
      "defaultValue": "Alert"
    },
    "firewallClientIpConfigurationName": {
      "type": "string",
      "defaultValue": "firewall-client-ip-config"
    },
    "firewallClientSubnetServiceEndpoints": {
      "type": "array",
      "defaultValue": []
    },
    "firewallClientPublicIPAddressName": {
      "type": "string",
      "defaultValue": "firewall-client-public-ip"
    },
    "firewallClientPublicIPAddressSkuName": {
      "type": "string",
      "defaultValue": "Standard"
    },
    "firewallClientPublicIpAllocationMethod": {
      "type": "string",
      "defaultValue": "Static"
    },
    "firewallClientPublicIPAddressAvailabilityZones": {
      "type": "array",
      "defaultValue": []
    },
    "firewallManagementIpConfigurationName": {
      "type": "string",
      "defaultValue": "firewall-management-ip-config"
    },
    "firewallManagementSubnetServiceEndpoints": {
      "type": "array",
      "defaultValue": []
    },
    "firewallManagementPublicIPAddressName": {
      "type": "string",
      "defaultValue": "firewall-management-public-ip"
    },
    "firewallManagementPublicIPAddressSkuName": {
      "type": "string",
      "defaultValue": "Standard"
    },
    "firewallManagementPublicIpAllocationMethod": {
      "type": "string",
      "defaultValue": "Static"
    },
    "firewallManagementPublicIPAddressAvailabilityZones": {
      "type": "array",
      "defaultValue": []
    },
    "identityResourceGroupName": {
      "type": "string",
      "defaultValue": "[replace(parameters('hubResourceGroupName'), 'hub', 'identity')]"
    },
    "identityLocation": {
      "type": "string",
      "defaultValue": "[parameters('hubLocation')]"
    },
    "identityVirtualNetworkName": {
      "type": "string",
      "defaultValue": "[replace(parameters('hubVirtualNetworkName'), 'hub', 'identity')]"
    },
    "identitySubnetName": {
      "type": "string",
      "defaultValue": "[replace(parameters('hubSubnetName'), 'hub', 'identity')]"
    },
    "identityVirtualNetworkAddressPrefix": {
      "type": "string",
      "defaultValue": "10.0.110.0/26"
    },
    "identitySubnetAddressPrefix": {
      "type": "string",
      "defaultValue": "10.0.110.0/27"
    },
    "identityVirtualNetworkDiagnosticsLogs": {
      "type": "array",
      "defaultValue": []
    },
    "identityVirtualNetworkDiagnosticsMetrics": {
      "type": "array",
      "defaultValue": []
    },
    "identityNetworkSecurityGroupName": {
      "type": "string",
      "defaultValue": "[replace(parameters('hubNetworkSecurityGroupName'), 'hub', 'identity')]"
    },
    "identityNetworkSecurityGroupRules": {
      "type": "array",
      "defaultValue": []
    },
    "identitySubnetServiceEndpoints": {
      "type": "array",
      "defaultValue": []
    },
    "identityLogStorageAccountName": {
      "type": "string",
      "defaultValue": "[toLower(take(format('idlogs{0}', parameters('uniqueId')), 24))]"
    },
    "identityLogStorageSkuName": {
      "type": "string",
      "defaultValue": "[parameters('hubLogStorageSkuName')]"
    },
    "operationsResourceGroupName": {
      "type": "string",
      "defaultValue": "[replace(parameters('hubResourceGroupName'), 'hub', 'operations')]"
    },
    "operationsLocation": {
      "type": "string",
      "defaultValue": "[parameters('hubLocation')]"
    },
    "operationsVirtualNetworkName": {
      "type": "string",
      "defaultValue": "[replace(parameters('hubVirtualNetworkName'), 'hub', 'operations')]"
    },
    "operationsVirtualNetworkAddressPrefix": {
      "type": "string",
      "defaultValue": "10.0.115.0/26"
    },
    "operationsVirtualNetworkDiagnosticsLogs": {
      "type": "array",
      "defaultValue": []
    },
    "operationsVirtualNetworkDiagnosticsMetrics": {
      "type": "array",
      "defaultValue": []
    },
    "operationsNetworkSecurityGroupName": {
      "type": "string",
      "defaultValue": "[replace(parameters('hubNetworkSecurityGroupName'), 'hub', 'operations')]"
    },
    "operationsNetworkSecurityGroupRules": {
      "type": "array",
      "defaultValue": []
    },
    "operationsSubnetName": {
      "type": "string",
      "defaultValue": "[replace(parameters('hubSubnetName'), 'hub', 'operations')]"
    },
    "operationsSubnetAddressPrefix": {
      "type": "string",
      "defaultValue": "10.0.115.0/27"
    },
    "operationsSubnetServiceEndpoints": {
      "type": "array",
      "defaultValue": []
    },
    "operationsLogStorageAccountName": {
      "type": "string",
      "defaultValue": "[toLower(take(format('opslogs{0}', parameters('uniqueId')), 24))]"
    },
    "operationsLogStorageSkuName": {
      "type": "string",
      "defaultValue": "[parameters('hubLogStorageSkuName')]"
    },
    "sharedServicesResourceGroupName": {
      "type": "string",
      "defaultValue": "[replace(parameters('hubResourceGroupName'), 'hub', 'sharedServices')]"
    },
    "sharedServicesLocation": {
      "type": "string",
      "defaultValue": "[parameters('hubLocation')]"
    },
    "sharedServicesVirtualNetworkName": {
      "type": "string",
      "defaultValue": "[replace(parameters('hubVirtualNetworkName'), 'hub', 'sharedServices')]"
    },
    "sharedServicesSubnetName": {
      "type": "string",
      "defaultValue": "[replace(parameters('hubSubnetName'), 'hub', 'sharedServices')]"
    },
    "sharedServicesVirtualNetworkAddressPrefix": {
      "type": "string",
      "defaultValue": "10.0.120.0/26"
    },
    "sharedServicesSubnetAddressPrefix": {
      "type": "string",
      "defaultValue": "10.0.120.0/27"
    },
    "sharedServicesVirtualNetworkDiagnosticsLogs": {
      "type": "array",
      "defaultValue": []
    },
    "sharedServicesVirtualNetworkDiagnosticsMetrics": {
      "type": "array",
      "defaultValue": []
    },
    "sharedServicesNetworkSecurityGroupName": {
      "type": "string",
      "defaultValue": "[replace(parameters('hubNetworkSecurityGroupName'), 'hub', 'sharedServices')]"
    },
    "sharedServicesNetworkSecurityGroupRules": {
      "type": "array",
      "defaultValue": []
    },
    "sharedServicesSubnetServiceEndpoints": {
      "type": "array",
      "defaultValue": []
    },
    "sharedServicesLogStorageAccountName": {
      "type": "string",
      "defaultValue": "[toLower(take(format('shrdSvclogs{0}', parameters('uniqueId')), 24))]"
    },
    "sharedServicesLogStorageSkuName": {
      "type": "string",
      "defaultValue": "[parameters('hubLogStorageSkuName')]"
    },
    "logAnalyticsWorkspaceName": {
      "type": "string",
      "defaultValue": "[take(format('{0}-laws', parameters('resourcePrefix')), 63)]"
    },
    "logAnalyticsWorkspaceLocation": {
      "type": "string",
      "defaultValue": "[parameters('operationsLocation')]"
    },
    "logAnalyticsWorkspaceCappingDailyQuotaGb": {
      "type": "int",
      "defaultValue": -1
    },
    "logAnalyticsWorkspaceRetentionInDays": {
      "type": "int",
      "defaultValue": 30
    },
    "logAnalyticsWorkspaceSkuName": {
      "type": "string",
      "defaultValue": "PerGB2018"
    },
    "policy": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "Built-in policy assignments to assign, default is none. [NIST/IL5/CMMC] IL5 is only availalbe for GOV cloud and will switch to NIST if tried in AzureCloud."
      },
      "allowedValues": [
        "NIST",
        "IL5",
        "CMMC",
        ""
      ]
    },
    "deployRemoteAccess": {
      "type": "bool",
      "defaultValue": false,
      "metadata": {
        "description": "Provision Azure Bastion Host and jumpboxes in this deployment"
      }
    },
    "bastionHostName": {
      "type": "string",
      "defaultValue": "bastionHost"
    },
    "bastionHostSubnetAddressPrefix": {
      "type": "string",
      "defaultValue": "10.0.100.160/27"
    },
    "bastionHostPublicIPAddressName": {
      "type": "string",
      "defaultValue": "bastionHostPublicIPAddress"
    },
    "bastionHostPublicIPAddressSkuName": {
      "type": "string",
      "defaultValue": "Standard"
    },
    "bastionHostPublicIPAddressAllocationMethod": {
      "type": "string",
      "defaultValue": "Static"
    },
    "bastionHostPublicIPAddressAvailabilityZones": {
      "type": "array",
      "defaultValue": []
    },
    "bastionHostIPConfigurationName": {
      "type": "string",
      "defaultValue": "bastionHostIPConfiguration"
    },
    "linuxVmName": {
      "type": "string",
      "defaultValue": "linuxVirtualMachine"
    },
    "linuxVmSize": {
      "type": "string",
      "defaultValue": "Standard_B2s"
    },
    "linuxVmOsDiskCreateOption": {
      "type": "string",
      "defaultValue": "FromImage"
    },
    "linuxVmOsDiskType": {
      "type": "string",
      "defaultValue": "Standard_LRS"
    },
    "linuxVmImagePublisher": {
      "type": "string",
      "defaultValue": "Canonical"
    },
    "linuxVmImageOffer": {
      "type": "string",
      "defaultValue": "UbuntuServer"
    },
    "linuxVmImageSku": {
      "type": "string",
      "defaultValue": "18.04-LTS"
    },
    "linuxVmImageVersion": {
      "type": "string",
      "defaultValue": "latest"
    },
    "linuxVmAdminUsername": {
      "type": "string",
      "defaultValue": "azureuser"
    },
    "linuxVmAuthenticationType": {
      "type": "string",
      "defaultValue": "password",
      "allowedValues": [
        "sshPublicKey",
        "password"
      ]
    },
    "linuxVmAdminPasswordOrKey": {
      "type": "secureString",
      "defaultValue": "[if(parameters('deployRemoteAccess'), '', newGuid())]",
      "minLength": 14
    },
    "linuxVmNetworkInterfaceName": {
      "type": "string",
      "defaultValue": "linuxVmNetworkInterface"
    },
    "linuxNetworkInterfaceIpConfigurationName": {
      "type": "string",
      "defaultValue": "linuxVmIpConfiguration"
    },
    "linuxNetworkInterfacePrivateIPAddressAllocationMethod": {
      "type": "string",
      "defaultValue": "Dynamic"
    },
    "tags": {
      "type": "object",
      "defaultValue": {
        "resourcePrefix": "[parameters('resourcePrefix')]"
      }
    },
    "uniqueId": {
      "type": "string",
      "defaultValue": "[uniqueString(deployment().name)]"
    },
    "nowUtc": {
      "type": "string",
      "defaultValue": "[utcNow()]"
    }
  },
  "functions": [],
  "variables": {
    "firewallClientSubnetName": "AzureFirewallSubnet",
    "firewallManagementSubnetName": "AzureFirewallManagementSubnet"
  },
  "resources": [
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "[format('deploy-hub-rg-{0}', parameters('nowUtc'))]",
      "subscriptionId": "[parameters('hubSubscriptionId')]",
      "location": "[deployment().location]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "name": {
            "value": "[parameters('hubResourceGroupName')]"
          },
          "location": {
            "value": "[parameters('hubLocation')]"
          },
          "tags": {
            "value": "[parameters('tags')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "2597065260920167442"
            }
          },
          "parameters": {
            "name": {
              "type": "string"
            },
            "location": {
              "type": "string"
            },
            "tags": {
              "type": "object",
              "defaultValue": {}
            }
          },
          "functions": [],
          "resources": [
            {
              "type": "Microsoft.Resources/resourceGroups",
              "apiVersion": "2019-05-01",
              "name": "[parameters('name')]",
              "location": "[parameters('location')]",
              "tags": "[parameters('tags')]"
            }
          ],
          "outputs": {
            "id": {
              "type": "string",
              "value": "[subscriptionResourceId('Microsoft.Resources/resourceGroups', parameters('name'))]"
            },
            "name": {
              "type": "string",
              "value": "[parameters('name')]"
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "[format('deploy-identity-rg-{0}', parameters('nowUtc'))]",
      "subscriptionId": "[parameters('identitySubscriptionId')]",
      "location": "[deployment().location]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "name": {
            "value": "[parameters('identityResourceGroupName')]"
          },
          "location": {
            "value": "[parameters('identityLocation')]"
          },
          "tags": {
            "value": "[parameters('tags')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "2597065260920167442"
            }
          },
          "parameters": {
            "name": {
              "type": "string"
            },
            "location": {
              "type": "string"
            },
            "tags": {
              "type": "object",
              "defaultValue": {}
            }
          },
          "functions": [],
          "resources": [
            {
              "type": "Microsoft.Resources/resourceGroups",
              "apiVersion": "2019-05-01",
              "name": "[parameters('name')]",
              "location": "[parameters('location')]",
              "tags": "[parameters('tags')]"
            }
          ],
          "outputs": {
            "id": {
              "type": "string",
              "value": "[subscriptionResourceId('Microsoft.Resources/resourceGroups', parameters('name'))]"
            },
            "name": {
              "type": "string",
              "value": "[parameters('name')]"
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "[format('deploy-operations-rg-{0}', parameters('nowUtc'))]",
      "subscriptionId": "[parameters('operationsSubscriptionId')]",
      "location": "[deployment().location]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "name": {
            "value": "[parameters('operationsResourceGroupName')]"
          },
          "location": {
            "value": "[parameters('operationsLocation')]"
          },
          "tags": {
            "value": "[parameters('tags')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "2597065260920167442"
            }
          },
          "parameters": {
            "name": {
              "type": "string"
            },
            "location": {
              "type": "string"
            },
            "tags": {
              "type": "object",
              "defaultValue": {}
            }
          },
          "functions": [],
          "resources": [
            {
              "type": "Microsoft.Resources/resourceGroups",
              "apiVersion": "2019-05-01",
              "name": "[parameters('name')]",
              "location": "[parameters('location')]",
              "tags": "[parameters('tags')]"
            }
          ],
          "outputs": {
            "id": {
              "type": "string",
              "value": "[subscriptionResourceId('Microsoft.Resources/resourceGroups', parameters('name'))]"
            },
            "name": {
              "type": "string",
              "value": "[parameters('name')]"
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "[format('deploy-sharedServices-rg-{0}', parameters('nowUtc'))]",
      "subscriptionId": "[parameters('sharedServicesSubscriptionId')]",
      "location": "[deployment().location]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "name": {
            "value": "[parameters('sharedServicesResourceGroupName')]"
          },
          "location": {
            "value": "[parameters('sharedServicesLocation')]"
          },
          "tags": {
            "value": "[parameters('tags')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "2597065260920167442"
            }
          },
          "parameters": {
            "name": {
              "type": "string"
            },
            "location": {
              "type": "string"
            },
            "tags": {
              "type": "object",
              "defaultValue": {}
            }
          },
          "functions": [],
          "resources": [
            {
              "type": "Microsoft.Resources/resourceGroups",
              "apiVersion": "2019-05-01",
              "name": "[parameters('name')]",
              "location": "[parameters('location')]",
              "tags": "[parameters('tags')]"
            }
          ],
          "outputs": {
            "id": {
              "type": "string",
              "value": "[subscriptionResourceId('Microsoft.Resources/resourceGroups', parameters('name'))]"
            },
            "name": {
              "type": "string",
              "value": "[parameters('name')]"
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "[format('deploy-laws-{0}', parameters('nowUtc'))]",
      "subscriptionId": "[parameters('operationsSubscriptionId')]",
      "resourceGroup": "[parameters('operationsResourceGroupName')]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "name": {
            "value": "[parameters('logAnalyticsWorkspaceName')]"
          },
          "location": {
            "value": "[parameters('logAnalyticsWorkspaceLocation')]"
          },
          "tags": {
            "value": "[parameters('tags')]"
          },
          "retentionInDays": {
            "value": "[parameters('logAnalyticsWorkspaceRetentionInDays')]"
          },
          "skuName": {
            "value": "[parameters('logAnalyticsWorkspaceSkuName')]"
          },
          "workspaceCappingDailyQuotaGb": {
            "value": "[parameters('logAnalyticsWorkspaceCappingDailyQuotaGb')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "1135244664014368490"
            }
          },
          "parameters": {
            "name": {
              "type": "string"
            },
            "location": {
              "type": "string"
            },
            "tags": {
              "type": "object",
              "defaultValue": {}
            },
            "retentionInDays": {
              "type": "int",
              "defaultValue": 30
            },
            "skuName": {
              "type": "string",
              "defaultValue": "PerGB2018"
            },
            "workspaceCappingDailyQuotaGb": {
              "type": "int",
              "defaultValue": -1
            },
            "deploySentinel": {
              "type": "bool",
              "defaultValue": false
            }
          },
          "functions": [],
          "resources": [
            {
              "type": "Microsoft.OperationalInsights/workspaces",
              "apiVersion": "2021-06-01",
              "name": "[parameters('name')]",
              "location": "[parameters('location')]",
              "tags": "[parameters('tags')]",
              "properties": {
                "retentionInDays": "[parameters('retentionInDays')]",
                "sku": {
                  "name": "[parameters('skuName')]"
                },
                "workspaceCapping": {
                  "dailyQuotaGb": "[parameters('workspaceCappingDailyQuotaGb')]"
                }
              }
            },
            {
              "condition": "[parameters('deploySentinel')]",
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "sentinelSolution",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "workspaceName": {
                    "value": "[parameters('name')]"
                  },
                  "workspaceLocation": {
                    "value": "[parameters('location')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "13919557056268320158"
                    }
                  },
                  "parameters": {
                    "workspaceName": {
                      "type": "string"
                    },
                    "workspaceLocation": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.OperationsManagement/solutions",
                      "apiVersion": "2015-11-01-preview",
                      "name": "[format('SecurityInsights({0})', parameters('workspaceName'))]",
                      "location": "[parameters('workspaceLocation')]",
                      "tags": "[parameters('tags')]",
                      "properties": {
                        "workspaceResourceId": "[resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspaceName'))]"
                      },
                      "plan": {
                        "name": "[format('SecurityInsights({0})', parameters('workspaceName'))]",
                        "publisher": "Microsoft",
                        "product": "OMSGallery/SecurityInsights",
                        "promotionCode": ""
                      }
                    }
                  ]
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.OperationalInsights/workspaces', parameters('name'))]"
              ]
            }
          ],
          "outputs": {
            "id": {
              "type": "string",
              "value": "[resourceId('Microsoft.OperationalInsights/workspaces', parameters('name'))]"
            },
            "name": {
              "type": "string",
              "value": "[parameters('name')]"
            }
          }
        }
      },
      "dependsOn": [
        "[subscriptionResourceId(parameters('operationsSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-operations-rg-{0}', parameters('nowUtc')))]"
      ]
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "[format('deploy-hub-{0}', parameters('nowUtc'))]",
      "subscriptionId": "[parameters('hubSubscriptionId')]",
      "resourceGroup": "[parameters('hubResourceGroupName')]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "location": {
            "value": "[parameters('hubLocation')]"
          },
          "tags": {
            "value": "[parameters('tags')]"
          },
          "logStorageAccountName": {
            "value": "[parameters('hubLogStorageAccountName')]"
          },
          "logStorageSkuName": {
            "value": "[parameters('hubLogStorageSkuName')]"
          },
          "logAnalyticsWorkspaceResourceId": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc'))), '2019-10-01').outputs.id.value]"
          },
          "virtualNetworkName": {
            "value": "[parameters('hubVirtualNetworkName')]"
          },
          "virtualNetworkAddressPrefix": {
            "value": "[parameters('hubVirtualNetworkAddressPrefix')]"
          },
          "virtualNetworkDiagnosticsLogs": {
            "value": "[parameters('hubVirtualNetworkDiagnosticsLogs')]"
          },
          "virtualNetworkDiagnosticsMetrics": {
            "value": "[parameters('hubVirtualNetworkDiagnosticsMetrics')]"
          },
          "networkSecurityGroupName": {
            "value": "[parameters('hubNetworkSecurityGroupName')]"
          },
          "networkSecurityGroupRules": {
            "value": "[parameters('hubNetworkSecurityGroupRules')]"
          },
          "subnetName": {
            "value": "[parameters('hubSubnetName')]"
          },
          "subnetAddressPrefix": {
            "value": "[parameters('hubSubnetAddressPrefix')]"
          },
          "subnetServiceEndpoints": {
            "value": "[parameters('hubSubnetServiceEndpoints')]"
          },
          "firewallName": {
            "value": "[parameters('firewallName')]"
          },
          "firewallSkuTier": {
            "value": "[parameters('firewallSkuTier')]"
          },
          "firewallPolicyName": {
            "value": "[parameters('firewallPolicyName')]"
          },
          "firewallThreatIntelMode": {
            "value": "[parameters('firewallThreatIntelMode')]"
          },
          "firewallClientIpConfigurationName": {
            "value": "[parameters('firewallClientIpConfigurationName')]"
          },
          "firewallClientSubnetName": {
            "value": "[variables('firewallClientSubnetName')]"
          },
          "firewallClientSubnetAddressPrefix": {
            "value": "[parameters('firewallClientSubnetAddressPrefix')]"
          },
          "firewallClientSubnetServiceEndpoints": {
            "value": "[parameters('firewallClientSubnetServiceEndpoints')]"
          },
          "firewallClientPublicIPAddressName": {
            "value": "[parameters('firewallClientPublicIPAddressName')]"
          },
          "firewallClientPublicIPAddressSkuName": {
            "value": "[parameters('firewallClientPublicIPAddressSkuName')]"
          },
          "firewallClientPublicIpAllocationMethod": {
            "value": "[parameters('firewallClientPublicIpAllocationMethod')]"
          },
          "firewallClientPublicIPAddressAvailabilityZones": {
            "value": "[parameters('firewallClientPublicIPAddressAvailabilityZones')]"
          },
          "firewallManagementIpConfigurationName": {
            "value": "[parameters('firewallManagementIpConfigurationName')]"
          },
          "firewallManagementSubnetName": {
            "value": "[variables('firewallManagementSubnetName')]"
          },
          "firewallManagementSubnetAddressPrefix": {
            "value": "[parameters('firewallManagementSubnetAddressPrefix')]"
          },
          "firewallManagementSubnetServiceEndpoints": {
            "value": "[parameters('firewallManagementSubnetServiceEndpoints')]"
          },
          "firewallManagementPublicIPAddressName": {
            "value": "[parameters('firewallManagementPublicIPAddressName')]"
          },
          "firewallManagementPublicIPAddressSkuName": {
            "value": "[parameters('firewallManagementPublicIPAddressSkuName')]"
          },
          "firewallManagementPublicIpAllocationMethod": {
            "value": "[parameters('firewallManagementPublicIpAllocationMethod')]"
          },
          "firewallManagementPublicIPAddressAvailabilityZones": {
            "value": "[parameters('firewallManagementPublicIPAddressAvailabilityZones')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "11367184292724438005"
            }
          },
          "parameters": {
            "location": {
              "type": "string",
              "defaultValue": "[resourceGroup().location]"
            },
            "tags": {
              "type": "object",
              "defaultValue": {}
            },
            "logStorageAccountName": {
              "type": "string"
            },
            "logStorageSkuName": {
              "type": "string"
            },
            "logAnalyticsWorkspaceResourceId": {
              "type": "string"
            },
            "virtualNetworkName": {
              "type": "string"
            },
            "virtualNetworkAddressPrefix": {
              "type": "string"
            },
            "virtualNetworkDiagnosticsLogs": {
              "type": "array"
            },
            "virtualNetworkDiagnosticsMetrics": {
              "type": "array"
            },
            "networkSecurityGroupName": {
              "type": "string"
            },
            "networkSecurityGroupRules": {
              "type": "array"
            },
            "subnetName": {
              "type": "string"
            },
            "subnetAddressPrefix": {
              "type": "string"
            },
            "subnetServiceEndpoints": {
              "type": "array"
            },
            "routeTableName": {
              "type": "string",
              "defaultValue": "[format('{0}-routetable', parameters('subnetName'))]"
            },
            "routeTableRouteName": {
              "type": "string",
              "defaultValue": "default_route"
            },
            "routeTableRouteAddressPrefix": {
              "type": "string",
              "defaultValue": "0.0.0.0/0"
            },
            "routeTableRouteNextHopType": {
              "type": "string",
              "defaultValue": "VirtualAppliance"
            },
            "firewallName": {
              "type": "string"
            },
            "firewallSkuTier": {
              "type": "string"
            },
            "firewallPolicyName": {
              "type": "string"
            },
            "firewallThreatIntelMode": {
              "type": "string"
            },
            "firewallClientIpConfigurationName": {
              "type": "string"
            },
            "firewallClientSubnetName": {
              "type": "string"
            },
            "firewallClientSubnetAddressPrefix": {
              "type": "string"
            },
            "firewallClientSubnetServiceEndpoints": {
              "type": "array"
            },
            "firewallClientPublicIPAddressName": {
              "type": "string"
            },
            "firewallClientPublicIPAddressSkuName": {
              "type": "string"
            },
            "firewallClientPublicIpAllocationMethod": {
              "type": "string"
            },
            "firewallClientPublicIPAddressAvailabilityZones": {
              "type": "array"
            },
            "firewallManagementIpConfigurationName": {
              "type": "string"
            },
            "firewallManagementSubnetName": {
              "type": "string"
            },
            "firewallManagementSubnetAddressPrefix": {
              "type": "string"
            },
            "firewallManagementSubnetServiceEndpoints": {
              "type": "array"
            },
            "firewallManagementPublicIPAddressName": {
              "type": "string"
            },
            "firewallManagementPublicIPAddressSkuName": {
              "type": "string"
            },
            "firewallManagementPublicIpAllocationMethod": {
              "type": "string"
            },
            "firewallManagementPublicIPAddressAvailabilityZones": {
              "type": "array"
            }
          },
          "functions": [],
          "variables": {
            "defaultVirtualNewtorkDiagnosticsLogs": [],
            "defaultVirtualNetworkDiagnosticsMetrics": [
              {
                "category": "AllMetrics",
                "enabled": true
              }
            ],
            "defaultSubnetServiceEndpoints": [
              {
                "service": "Microsoft.Storage"
              }
            ],
            "defaultNetworkSecurityGroupRules": [
              {
                "name": "allow_ssh",
                "properties": {
                  "description": "Allow SSH access from anywhere",
                  "access": "Allow",
                  "priority": 100,
                  "protocol": "Tcp",
                  "direction": "Inbound",
                  "sourcePortRange": "*",
                  "sourceAddressPrefix": "*",
                  "destinationPortRange": "22",
                  "destinationAddressPrefix": "*"
                }
              },
              {
                "name": "allow_rdp",
                "properties": {
                  "description": "Allow RDP access from anywhere",
                  "access": "Allow",
                  "priority": 200,
                  "protocol": "Tcp",
                  "direction": "Inbound",
                  "sourcePortRange": "*",
                  "sourceAddressPrefix": "*",
                  "destinationPortRange": "3389",
                  "destinationAddressPrefix": "*"
                }
              }
            ]
          },
          "resources": [
            {
              "type": "Microsoft.Network/virtualNetworks/subnets",
              "apiVersion": "2021-02-01",
              "name": "[format('{0}/{1}', parameters('virtualNetworkName'), parameters('subnetName'))]",
              "properties": {
                "addressPrefix": "[parameters('subnetAddressPrefix')]",
                "networkSecurityGroup": {
                  "id": "[reference(resourceId('Microsoft.Resources/deployments', 'networkSecurityGroup'), '2019-10-01').outputs.id.value]"
                },
                "routeTable": {
                  "id": "[reference(resourceId('Microsoft.Resources/deployments', 'routeTable'), '2019-10-01').outputs.id.value]"
                },
                "serviceEndpoints": "[if(empty(parameters('subnetServiceEndpoints')), variables('defaultSubnetServiceEndpoints'), parameters('subnetServiceEndpoints'))]"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Resources/deployments', 'firewall')]",
                "[resourceId('Microsoft.Resources/deployments', 'networkSecurityGroup')]",
                "[resourceId('Microsoft.Resources/deployments', 'routeTable')]",
                "[resourceId('Microsoft.Resources/deployments', 'virtualNetwork')]"
              ]
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "logStorage",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "storageAccountName": {
                    "value": "[parameters('logStorageAccountName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "skuName": {
                    "value": "[parameters('logStorageSkuName')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "833209748305454708"
                    }
                  },
                  "parameters": {
                    "storageAccountName": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "skuName": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Storage/storageAccounts",
                      "apiVersion": "2019-06-01",
                      "name": "[parameters('storageAccountName')]",
                      "location": "[parameters('location')]",
                      "kind": "Storage",
                      "sku": {
                        "name": "[parameters('skuName')]"
                      },
                      "tags": "[parameters('tags')]"
                    }
                  ],
                  "outputs": {
                    "id": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName'))]"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "networkSecurityGroup",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[parameters('networkSecurityGroupName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  },
                  "securityRules": {
                    "value": "[if(empty(parameters('networkSecurityGroupRules')), variables('defaultNetworkSecurityGroupRules'), parameters('networkSecurityGroupRules'))]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "5161805386163632044"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    },
                    "securityRules": {
                      "type": "array"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/networkSecurityGroups",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "properties": {
                        "securityRules": "[parameters('securityRules')]"
                      }
                    }
                  ],
                  "outputs": {
                    "id": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('name'))]"
                    },
                    "name": {
                      "type": "string",
                      "value": "[parameters('name')]"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "virtualNetwork",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[parameters('virtualNetworkName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  },
                  "addressPrefix": {
                    "value": "[parameters('virtualNetworkAddressPrefix')]"
                  },
                  "diagnosticsLogs": {
                    "value": "[if(empty(parameters('virtualNetworkDiagnosticsLogs')), variables('defaultVirtualNewtorkDiagnosticsLogs'), parameters('virtualNetworkDiagnosticsLogs'))]"
                  },
                  "diagnosticsMetrics": {
                    "value": "[if(empty(parameters('virtualNetworkDiagnosticsMetrics')), variables('defaultVirtualNetworkDiagnosticsMetrics'), parameters('virtualNetworkDiagnosticsMetrics'))]"
                  },
                  "subnets": {
                    "value": [
                      {
                        "name": "[parameters('firewallClientSubnetName')]",
                        "properties": {
                          "addressPrefix": "[parameters('firewallClientSubnetAddressPrefix')]",
                          "serviceEndpoints": "[parameters('firewallClientSubnetServiceEndpoints')]"
                        }
                      },
                      {
                        "name": "[parameters('firewallManagementSubnetName')]",
                        "properties": {
                          "addressPrefix": "[parameters('firewallManagementSubnetAddressPrefix')]",
                          "serviceEndpoints": "[parameters('firewallManagementSubnetServiceEndpoints')]"
                        }
                      }
                    ]
                  },
                  "logAnalyticsWorkspaceResourceId": {
                    "value": "[parameters('logAnalyticsWorkspaceResourceId')]"
                  },
                  "logStorageAccountResourceId": {
                    "value": "[reference(resourceId('Microsoft.Resources/deployments', 'logStorage'), '2019-10-01').outputs.id.value]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "16117476816851398131"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    },
                    "addressPrefix": {
                      "type": "string"
                    },
                    "logAnalyticsWorkspaceResourceId": {
                      "type": "string"
                    },
                    "logStorageAccountResourceId": {
                      "type": "string"
                    },
                    "subnets": {
                      "type": "array"
                    },
                    "diagnosticsMetrics": {
                      "type": "array"
                    },
                    "diagnosticsLogs": {
                      "type": "array"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/virtualNetworks",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "properties": {
                        "addressSpace": {
                          "addressPrefixes": [
                            "[parameters('addressPrefix')]"
                          ]
                        },
                        "subnets": "[parameters('subnets')]"
                      }
                    },
                    {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "apiVersion": "2017-05-01-preview",
                      "scope": "[format('Microsoft.Network/virtualNetworks/{0}', parameters('name'))]",
                      "name": "[format('{0}-diagnostics', parameters('name'))]",
                      "properties": {
                        "storageAccountId": "[parameters('logStorageAccountResourceId')]",
                        "workspaceId": "[parameters('logAnalyticsWorkspaceResourceId')]",
                        "metrics": "[parameters('diagnosticsMetrics')]",
                        "logs": "[parameters('diagnosticsLogs')]"
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.Network/virtualNetworks', parameters('name'))]"
                      ]
                    }
                  ],
                  "outputs": {
                    "name": {
                      "type": "string",
                      "value": "[parameters('name')]"
                    },
                    "id": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Network/virtualNetworks', parameters('name'))]"
                    },
                    "subnets": {
                      "type": "array",
                      "value": "[reference(resourceId('Microsoft.Network/virtualNetworks', parameters('name'))).subnets]"
                    }
                  }
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Resources/deployments', 'logStorage')]"
              ]
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "routeTable",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[parameters('routeTableName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  },
                  "routeName": {
                    "value": "[parameters('routeTableRouteName')]"
                  },
                  "routeAddressPrefix": {
                    "value": "[parameters('routeTableRouteAddressPrefix')]"
                  },
                  "routeNextHopIpAddress": {
                    "value": "[reference(resourceId('Microsoft.Resources/deployments', 'firewall'), '2019-10-01').outputs.privateIPAddress.value]"
                  },
                  "routeNextHopType": {
                    "value": "[parameters('routeTableRouteNextHopType')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "4341229051409225242"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    },
                    "routeName": {
                      "type": "string"
                    },
                    "routeAddressPrefix": {
                      "type": "string"
                    },
                    "routeNextHopIpAddress": {
                      "type": "string"
                    },
                    "routeNextHopType": {
                      "type": "string"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/routeTables",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "properties": {
                        "routes": [
                          {
                            "name": "[parameters('routeName')]",
                            "properties": {
                              "addressPrefix": "[parameters('routeAddressPrefix')]",
                              "nextHopIpAddress": "[parameters('routeNextHopIpAddress')]",
                              "nextHopType": "[parameters('routeNextHopType')]"
                            }
                          }
                        ]
                      }
                    }
                  ],
                  "outputs": {
                    "id": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Network/routeTables', parameters('name'))]"
                    },
                    "name": {
                      "type": "string",
                      "value": "[parameters('name')]"
                    }
                  }
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Resources/deployments', 'firewall')]"
              ]
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "firewallClientPublicIPAddress",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[parameters('firewallClientPublicIPAddressName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  },
                  "skuName": {
                    "value": "[parameters('firewallClientPublicIPAddressSkuName')]"
                  },
                  "publicIpAllocationMethod": {
                    "value": "[parameters('firewallClientPublicIpAllocationMethod')]"
                  },
                  "availabilityZones": {
                    "value": "[parameters('firewallClientPublicIPAddressAvailabilityZones')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "11905204395726802012"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    },
                    "skuName": {
                      "type": "string"
                    },
                    "publicIpAllocationMethod": {
                      "type": "string"
                    },
                    "availabilityZones": {
                      "type": "array"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/publicIPAddresses",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "sku": {
                        "name": "[parameters('skuName')]"
                      },
                      "properties": {
                        "publicIPAllocationMethod": "[parameters('publicIpAllocationMethod')]"
                      },
                      "zones": "[parameters('availabilityZones')]"
                    }
                  ],
                  "outputs": {
                    "id": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Network/publicIPAddresses', parameters('name'))]"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "firewallManagementPublicIPAddress",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[parameters('firewallManagementPublicIPAddressName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  },
                  "skuName": {
                    "value": "[parameters('firewallManagementPublicIPAddressSkuName')]"
                  },
                  "publicIpAllocationMethod": {
                    "value": "[parameters('firewallManagementPublicIpAllocationMethod')]"
                  },
                  "availabilityZones": {
                    "value": "[parameters('firewallManagementPublicIPAddressAvailabilityZones')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "11905204395726802012"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    },
                    "skuName": {
                      "type": "string"
                    },
                    "publicIpAllocationMethod": {
                      "type": "string"
                    },
                    "availabilityZones": {
                      "type": "array"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/publicIPAddresses",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "sku": {
                        "name": "[parameters('skuName')]"
                      },
                      "properties": {
                        "publicIPAllocationMethod": "[parameters('publicIpAllocationMethod')]"
                      },
                      "zones": "[parameters('availabilityZones')]"
                    }
                  ],
                  "outputs": {
                    "id": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Network/publicIPAddresses', parameters('name'))]"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "firewall",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[parameters('firewallName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  },
                  "skuTier": {
                    "value": "[parameters('firewallSkuTier')]"
                  },
                  "firewallPolicyName": {
                    "value": "[parameters('firewallPolicyName')]"
                  },
                  "threatIntelMode": {
                    "value": "[parameters('firewallThreatIntelMode')]"
                  },
                  "clientIpConfigurationName": {
                    "value": "[parameters('firewallClientIpConfigurationName')]"
                  },
                  "clientIpConfigurationSubnetResourceId": {
                    "value": "[format('{0}/subnets/{1}', reference(resourceId('Microsoft.Resources/deployments', 'virtualNetwork'), '2019-10-01').outputs.id.value, parameters('firewallClientSubnetName'))]"
                  },
                  "clientIpConfigurationPublicIPAddressResourceId": {
                    "value": "[reference(resourceId('Microsoft.Resources/deployments', 'firewallClientPublicIPAddress'), '2019-10-01').outputs.id.value]"
                  },
                  "managementIpConfigurationName": {
                    "value": "[parameters('firewallManagementIpConfigurationName')]"
                  },
                  "managementIpConfigurationSubnetResourceId": {
                    "value": "[format('{0}/subnets/{1}', reference(resourceId('Microsoft.Resources/deployments', 'virtualNetwork'), '2019-10-01').outputs.id.value, parameters('firewallManagementSubnetName'))]"
                  },
                  "managementIpConfigurationPublicIPAddressResourceId": {
                    "value": "[reference(resourceId('Microsoft.Resources/deployments', 'firewallManagementPublicIPAddress'), '2019-10-01').outputs.id.value]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "14377085769738688639"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string",
                      "defaultValue": "[resourceGroup().location]"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    },
                    "skuTier": {
                      "type": "string"
                    },
                    "threatIntelMode": {
                      "type": "string"
                    },
                    "clientIpConfigurationName": {
                      "type": "string"
                    },
                    "clientIpConfigurationSubnetResourceId": {
                      "type": "string"
                    },
                    "clientIpConfigurationPublicIPAddressResourceId": {
                      "type": "string"
                    },
                    "managementIpConfigurationName": {
                      "type": "string"
                    },
                    "managementIpConfigurationSubnetResourceId": {
                      "type": "string"
                    },
                    "managementIpConfigurationPublicIPAddressResourceId": {
                      "type": "string"
                    },
                    "firewallPolicyName": {
                      "type": "string"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/firewallPolicies",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('firewallPolicyName')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "properties": {
                        "threatIntelMode": "[parameters('threatIntelMode')]",
                        "sku": {
                          "tier": "[parameters('skuTier')]"
                        }
                      }
                    },
                    {
                      "type": "Microsoft.Network/azureFirewalls",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "properties": {
                        "ipConfigurations": [
                          {
                            "name": "[parameters('clientIpConfigurationName')]",
                            "properties": {
                              "subnet": {
                                "id": "[parameters('clientIpConfigurationSubnetResourceId')]"
                              },
                              "publicIPAddress": {
                                "id": "[parameters('clientIpConfigurationPublicIPAddressResourceId')]"
                              }
                            }
                          }
                        ],
                        "managementIpConfiguration": {
                          "name": "[parameters('managementIpConfigurationName')]",
                          "properties": {
                            "subnet": {
                              "id": "[parameters('managementIpConfigurationSubnetResourceId')]"
                            },
                            "publicIPAddress": {
                              "id": "[parameters('managementIpConfigurationPublicIPAddressResourceId')]"
                            }
                          }
                        },
                        "firewallPolicy": {
                          "id": "[resourceId('Microsoft.Network/firewallPolicies', parameters('firewallPolicyName'))]"
                        },
                        "sku": {
                          "tier": "[parameters('skuTier')]"
                        }
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.Network/firewallPolicies', parameters('firewallPolicyName'))]"
                      ]
                    }
                  ],
                  "outputs": {
                    "privateIPAddress": {
                      "type": "string",
                      "value": "[reference(resourceId('Microsoft.Network/azureFirewalls', parameters('name'))).ipConfigurations[0].properties.privateIPAddress]"
                    }
                  }
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Resources/deployments', 'firewallClientPublicIPAddress')]",
                "[resourceId('Microsoft.Resources/deployments', 'firewallManagementPublicIPAddress')]",
                "[resourceId('Microsoft.Resources/deployments', 'virtualNetwork')]"
              ]
            }
          ],
          "outputs": {
            "virtualNetworkName": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'virtualNetwork'), '2019-10-01').outputs.name.value]"
            },
            "virtualNetworkResourceId": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'virtualNetwork'), '2019-10-01').outputs.id.value]"
            },
            "subnetName": {
              "type": "string",
              "value": "[format('{0}/{1}', parameters('virtualNetworkName'), parameters('subnetName'))]"
            },
            "subnetAddressPrefix": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Network/virtualNetworks/subnets', split(format('{0}/{1}', parameters('virtualNetworkName'), parameters('subnetName')), '/')[0], split(format('{0}/{1}', parameters('virtualNetworkName'), parameters('subnetName')), '/')[1])).addressPrefix]"
            },
            "subnetResourceId": {
              "type": "string",
              "value": "[resourceId('Microsoft.Network/virtualNetworks/subnets', split(format('{0}/{1}', parameters('virtualNetworkName'), parameters('subnetName')), '/')[0], split(format('{0}/{1}', parameters('virtualNetworkName'), parameters('subnetName')), '/')[1])]"
            },
            "networkSecurityGroupName": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'networkSecurityGroup'), '2019-10-01').outputs.name.value]"
            },
            "networkSecurityGroupResourceId": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'networkSecurityGroup'), '2019-10-01').outputs.id.value]"
            },
            "firewallPrivateIPAddress": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'firewall'), '2019-10-01').outputs.privateIPAddress.value]"
            }
          }
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc')))]"
      ]
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "[format('deploy-identity-spoke-{0}', parameters('nowUtc'))]",
      "subscriptionId": "[parameters('identitySubscriptionId')]",
      "resourceGroup": "[parameters('identityResourceGroupName')]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "location": {
            "value": "[parameters('identityLocation')]"
          },
          "tags": {
            "value": "[parameters('tags')]"
          },
          "logStorageAccountName": {
            "value": "[parameters('identityLogStorageAccountName')]"
          },
          "logStorageSkuName": {
            "value": "[parameters('identityLogStorageSkuName')]"
          },
          "logAnalyticsWorkspaceResourceId": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc'))), '2019-10-01').outputs.id.value]"
          },
          "firewallPrivateIPAddress": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.firewallPrivateIPAddress.value]"
          },
          "virtualNetworkName": {
            "value": "[parameters('identityVirtualNetworkName')]"
          },
          "virtualNetworkAddressPrefix": {
            "value": "[parameters('identityVirtualNetworkAddressPrefix')]"
          },
          "virtualNetworkDiagnosticsLogs": {
            "value": "[parameters('identityVirtualNetworkDiagnosticsLogs')]"
          },
          "virtualNetworkDiagnosticsMetrics": {
            "value": "[parameters('identityVirtualNetworkDiagnosticsMetrics')]"
          },
          "networkSecurityGroupName": {
            "value": "[parameters('identityNetworkSecurityGroupName')]"
          },
          "networkSecurityGroupRules": {
            "value": "[parameters('identityNetworkSecurityGroupRules')]"
          },
          "subnetName": {
            "value": "[parameters('identitySubnetName')]"
          },
          "subnetAddressPrefix": {
            "value": "[parameters('identitySubnetAddressPrefix')]"
          },
          "subnetServiceEndpoints": {
            "value": "[parameters('identitySubnetServiceEndpoints')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "15949869288234268239"
            }
          },
          "parameters": {
            "location": {
              "type": "string",
              "defaultValue": "[resourceGroup().location]"
            },
            "tags": {
              "type": "object",
              "defaultValue": {}
            },
            "logStorageAccountName": {
              "type": "string"
            },
            "logStorageSkuName": {
              "type": "string"
            },
            "logAnalyticsWorkspaceResourceId": {
              "type": "string"
            },
            "firewallPrivateIPAddress": {
              "type": "string"
            },
            "virtualNetworkName": {
              "type": "string"
            },
            "virtualNetworkAddressPrefix": {
              "type": "string"
            },
            "virtualNetworkDiagnosticsLogs": {
              "type": "array"
            },
            "virtualNetworkDiagnosticsMetrics": {
              "type": "array"
            },
            "networkSecurityGroupName": {
              "type": "string"
            },
            "networkSecurityGroupRules": {
              "type": "array"
            },
            "subnetName": {
              "type": "string"
            },
            "subnetAddressPrefix": {
              "type": "string"
            },
            "subnetServiceEndpoints": {
              "type": "array"
            },
            "routeTableName": {
              "type": "string",
              "defaultValue": "[format('{0}-routetable', parameters('subnetName'))]"
            },
            "routeTableRouteName": {
              "type": "string",
              "defaultValue": "default_route"
            },
            "routeTableRouteAddressPrefix": {
              "type": "string",
              "defaultValue": "0.0.0.0/0"
            },
            "routeTableRouteNextHopIpAddress": {
              "type": "string",
              "defaultValue": "[parameters('firewallPrivateIPAddress')]"
            },
            "routeTableRouteNextHopType": {
              "type": "string",
              "defaultValue": "VirtualAppliance"
            }
          },
          "functions": [],
          "variables": {
            "defaultVirtualNetworkDiagnosticsLogs": [],
            "defaultVirtualNetworkDiagnosticsMetrics": [
              {
                "category": "AllMetrics",
                "enabled": true
              }
            ],
            "defaultSubnetServiceEndpoints": [
              {
                "service": "Microsoft.Storage"
              }
            ],
            "defaultNetworkSecurityGroupRules": [
              {
                "name": "allow_ssh",
                "properties": {
                  "description": "Allow SSH access from anywhere",
                  "access": "Allow",
                  "priority": 100,
                  "protocol": "Tcp",
                  "direction": "Inbound",
                  "sourcePortRange": "*",
                  "sourceAddressPrefix": "*",
                  "destinationPortRange": "22",
                  "destinationAddressPrefix": "*"
                }
              },
              {
                "name": "allow_rdp",
                "properties": {
                  "description": "Allow RDP access from anywhere",
                  "access": "Allow",
                  "priority": 200,
                  "protocol": "Tcp",
                  "direction": "Inbound",
                  "sourcePortRange": "*",
                  "sourceAddressPrefix": "*",
                  "destinationPortRange": "3389",
                  "destinationAddressPrefix": "*"
                }
              }
            ]
          },
          "resources": [
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "logStorage",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "storageAccountName": {
                    "value": "[parameters('logStorageAccountName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "skuName": {
                    "value": "[parameters('logStorageSkuName')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "833209748305454708"
                    }
                  },
                  "parameters": {
                    "storageAccountName": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "skuName": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Storage/storageAccounts",
                      "apiVersion": "2019-06-01",
                      "name": "[parameters('storageAccountName')]",
                      "location": "[parameters('location')]",
                      "kind": "Storage",
                      "sku": {
                        "name": "[parameters('skuName')]"
                      },
                      "tags": "[parameters('tags')]"
                    }
                  ],
                  "outputs": {
                    "id": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName'))]"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "networkSecurityGroup",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[parameters('networkSecurityGroupName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  },
                  "securityRules": {
                    "value": "[if(empty(parameters('networkSecurityGroupRules')), variables('defaultNetworkSecurityGroupRules'), parameters('networkSecurityGroupRules'))]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "5161805386163632044"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    },
                    "securityRules": {
                      "type": "array"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/networkSecurityGroups",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "properties": {
                        "securityRules": "[parameters('securityRules')]"
                      }
                    }
                  ],
                  "outputs": {
                    "id": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('name'))]"
                    },
                    "name": {
                      "type": "string",
                      "value": "[parameters('name')]"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "routeTable",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[parameters('routeTableName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  },
                  "routeName": {
                    "value": "[parameters('routeTableRouteName')]"
                  },
                  "routeAddressPrefix": {
                    "value": "[parameters('routeTableRouteAddressPrefix')]"
                  },
                  "routeNextHopIpAddress": {
                    "value": "[parameters('routeTableRouteNextHopIpAddress')]"
                  },
                  "routeNextHopType": {
                    "value": "[parameters('routeTableRouteNextHopType')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "4341229051409225242"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    },
                    "routeName": {
                      "type": "string"
                    },
                    "routeAddressPrefix": {
                      "type": "string"
                    },
                    "routeNextHopIpAddress": {
                      "type": "string"
                    },
                    "routeNextHopType": {
                      "type": "string"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/routeTables",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "properties": {
                        "routes": [
                          {
                            "name": "[parameters('routeName')]",
                            "properties": {
                              "addressPrefix": "[parameters('routeAddressPrefix')]",
                              "nextHopIpAddress": "[parameters('routeNextHopIpAddress')]",
                              "nextHopType": "[parameters('routeNextHopType')]"
                            }
                          }
                        ]
                      }
                    }
                  ],
                  "outputs": {
                    "id": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Network/routeTables', parameters('name'))]"
                    },
                    "name": {
                      "type": "string",
                      "value": "[parameters('name')]"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "virtualNetwork",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[parameters('virtualNetworkName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  },
                  "addressPrefix": {
                    "value": "[parameters('virtualNetworkAddressPrefix')]"
                  },
                  "diagnosticsLogs": {
                    "value": "[if(empty(parameters('virtualNetworkDiagnosticsLogs')), variables('defaultVirtualNetworkDiagnosticsLogs'), parameters('virtualNetworkDiagnosticsLogs'))]"
                  },
                  "diagnosticsMetrics": {
                    "value": "[if(empty(parameters('virtualNetworkDiagnosticsMetrics')), variables('defaultVirtualNetworkDiagnosticsMetrics'), parameters('virtualNetworkDiagnosticsMetrics'))]"
                  },
                  "subnets": {
                    "value": [
                      {
                        "name": "[parameters('subnetName')]",
                        "properties": {
                          "addressPrefix": "[parameters('subnetAddressPrefix')]",
                          "networkSecurityGroup": {
                            "id": "[reference(resourceId('Microsoft.Resources/deployments', 'networkSecurityGroup'), '2019-10-01').outputs.id.value]"
                          },
                          "routeTable": {
                            "id": "[reference(resourceId('Microsoft.Resources/deployments', 'routeTable'), '2019-10-01').outputs.id.value]"
                          },
                          "serviceEndpoints": "[if(empty(parameters('subnetServiceEndpoints')), variables('defaultSubnetServiceEndpoints'), parameters('subnetServiceEndpoints'))]"
                        }
                      }
                    ]
                  },
                  "logAnalyticsWorkspaceResourceId": {
                    "value": "[parameters('logAnalyticsWorkspaceResourceId')]"
                  },
                  "logStorageAccountResourceId": {
                    "value": "[reference(resourceId('Microsoft.Resources/deployments', 'logStorage'), '2019-10-01').outputs.id.value]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "16117476816851398131"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    },
                    "addressPrefix": {
                      "type": "string"
                    },
                    "logAnalyticsWorkspaceResourceId": {
                      "type": "string"
                    },
                    "logStorageAccountResourceId": {
                      "type": "string"
                    },
                    "subnets": {
                      "type": "array"
                    },
                    "diagnosticsMetrics": {
                      "type": "array"
                    },
                    "diagnosticsLogs": {
                      "type": "array"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/virtualNetworks",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "properties": {
                        "addressSpace": {
                          "addressPrefixes": [
                            "[parameters('addressPrefix')]"
                          ]
                        },
                        "subnets": "[parameters('subnets')]"
                      }
                    },
                    {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "apiVersion": "2017-05-01-preview",
                      "scope": "[format('Microsoft.Network/virtualNetworks/{0}', parameters('name'))]",
                      "name": "[format('{0}-diagnostics', parameters('name'))]",
                      "properties": {
                        "storageAccountId": "[parameters('logStorageAccountResourceId')]",
                        "workspaceId": "[parameters('logAnalyticsWorkspaceResourceId')]",
                        "metrics": "[parameters('diagnosticsMetrics')]",
                        "logs": "[parameters('diagnosticsLogs')]"
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.Network/virtualNetworks', parameters('name'))]"
                      ]
                    }
                  ],
                  "outputs": {
                    "name": {
                      "type": "string",
                      "value": "[parameters('name')]"
                    },
                    "id": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Network/virtualNetworks', parameters('name'))]"
                    },
                    "subnets": {
                      "type": "array",
                      "value": "[reference(resourceId('Microsoft.Network/virtualNetworks', parameters('name'))).subnets]"
                    }
                  }
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Resources/deployments', 'logStorage')]",
                "[resourceId('Microsoft.Resources/deployments', 'networkSecurityGroup')]",
                "[resourceId('Microsoft.Resources/deployments', 'routeTable')]"
              ]
            }
          ],
          "outputs": {
            "virtualNetworkName": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'virtualNetwork'), '2019-10-01').outputs.name.value]"
            },
            "virtualNetworkResourceId": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'virtualNetwork'), '2019-10-01').outputs.id.value]"
            },
            "subnetName": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'virtualNetwork'), '2019-10-01').outputs.subnets.value[0].name]"
            },
            "subnetAddressPrefix": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'virtualNetwork'), '2019-10-01').outputs.subnets.value[0].properties.addressPrefix]"
            },
            "subnetResourceId": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'virtualNetwork'), '2019-10-01').outputs.subnets.value[0].id]"
            },
            "networkSecurityGroupName": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'networkSecurityGroup'), '2019-10-01').outputs.name.value]"
            },
            "networkSecurityGroupResourceId": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'networkSecurityGroup'), '2019-10-01').outputs.id.value]"
            }
          }
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc')))]",
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc')))]"
      ]
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "[format('deploy-operations-spoke-{0}', parameters('nowUtc'))]",
      "subscriptionId": "[parameters('operationsSubscriptionId')]",
      "resourceGroup": "[parameters('operationsResourceGroupName')]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "location": {
            "value": "[parameters('operationsLocation')]"
          },
          "tags": {
            "value": "[parameters('tags')]"
          },
          "logStorageAccountName": {
            "value": "[parameters('operationsLogStorageAccountName')]"
          },
          "logStorageSkuName": {
            "value": "[parameters('operationsLogStorageSkuName')]"
          },
          "logAnalyticsWorkspaceResourceId": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc'))), '2019-10-01').outputs.id.value]"
          },
          "firewallPrivateIPAddress": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.firewallPrivateIPAddress.value]"
          },
          "virtualNetworkName": {
            "value": "[parameters('operationsVirtualNetworkName')]"
          },
          "virtualNetworkAddressPrefix": {
            "value": "[parameters('operationsVirtualNetworkAddressPrefix')]"
          },
          "virtualNetworkDiagnosticsLogs": {
            "value": "[parameters('operationsVirtualNetworkDiagnosticsLogs')]"
          },
          "virtualNetworkDiagnosticsMetrics": {
            "value": "[parameters('operationsVirtualNetworkDiagnosticsMetrics')]"
          },
          "networkSecurityGroupName": {
            "value": "[parameters('operationsNetworkSecurityGroupName')]"
          },
          "networkSecurityGroupRules": {
            "value": "[parameters('operationsNetworkSecurityGroupRules')]"
          },
          "subnetName": {
            "value": "[parameters('operationsSubnetName')]"
          },
          "subnetAddressPrefix": {
            "value": "[parameters('operationsSubnetAddressPrefix')]"
          },
          "subnetServiceEndpoints": {
            "value": "[parameters('operationsSubnetServiceEndpoints')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "15949869288234268239"
            }
          },
          "parameters": {
            "location": {
              "type": "string",
              "defaultValue": "[resourceGroup().location]"
            },
            "tags": {
              "type": "object",
              "defaultValue": {}
            },
            "logStorageAccountName": {
              "type": "string"
            },
            "logStorageSkuName": {
              "type": "string"
            },
            "logAnalyticsWorkspaceResourceId": {
              "type": "string"
            },
            "firewallPrivateIPAddress": {
              "type": "string"
            },
            "virtualNetworkName": {
              "type": "string"
            },
            "virtualNetworkAddressPrefix": {
              "type": "string"
            },
            "virtualNetworkDiagnosticsLogs": {
              "type": "array"
            },
            "virtualNetworkDiagnosticsMetrics": {
              "type": "array"
            },
            "networkSecurityGroupName": {
              "type": "string"
            },
            "networkSecurityGroupRules": {
              "type": "array"
            },
            "subnetName": {
              "type": "string"
            },
            "subnetAddressPrefix": {
              "type": "string"
            },
            "subnetServiceEndpoints": {
              "type": "array"
            },
            "routeTableName": {
              "type": "string",
              "defaultValue": "[format('{0}-routetable', parameters('subnetName'))]"
            },
            "routeTableRouteName": {
              "type": "string",
              "defaultValue": "default_route"
            },
            "routeTableRouteAddressPrefix": {
              "type": "string",
              "defaultValue": "0.0.0.0/0"
            },
            "routeTableRouteNextHopIpAddress": {
              "type": "string",
              "defaultValue": "[parameters('firewallPrivateIPAddress')]"
            },
            "routeTableRouteNextHopType": {
              "type": "string",
              "defaultValue": "VirtualAppliance"
            }
          },
          "functions": [],
          "variables": {
            "defaultVirtualNetworkDiagnosticsLogs": [],
            "defaultVirtualNetworkDiagnosticsMetrics": [
              {
                "category": "AllMetrics",
                "enabled": true
              }
            ],
            "defaultSubnetServiceEndpoints": [
              {
                "service": "Microsoft.Storage"
              }
            ],
            "defaultNetworkSecurityGroupRules": [
              {
                "name": "allow_ssh",
                "properties": {
                  "description": "Allow SSH access from anywhere",
                  "access": "Allow",
                  "priority": 100,
                  "protocol": "Tcp",
                  "direction": "Inbound",
                  "sourcePortRange": "*",
                  "sourceAddressPrefix": "*",
                  "destinationPortRange": "22",
                  "destinationAddressPrefix": "*"
                }
              },
              {
                "name": "allow_rdp",
                "properties": {
                  "description": "Allow RDP access from anywhere",
                  "access": "Allow",
                  "priority": 200,
                  "protocol": "Tcp",
                  "direction": "Inbound",
                  "sourcePortRange": "*",
                  "sourceAddressPrefix": "*",
                  "destinationPortRange": "3389",
                  "destinationAddressPrefix": "*"
                }
              }
            ]
          },
          "resources": [
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "logStorage",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "storageAccountName": {
                    "value": "[parameters('logStorageAccountName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "skuName": {
                    "value": "[parameters('logStorageSkuName')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "833209748305454708"
                    }
                  },
                  "parameters": {
                    "storageAccountName": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "skuName": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Storage/storageAccounts",
                      "apiVersion": "2019-06-01",
                      "name": "[parameters('storageAccountName')]",
                      "location": "[parameters('location')]",
                      "kind": "Storage",
                      "sku": {
                        "name": "[parameters('skuName')]"
                      },
                      "tags": "[parameters('tags')]"
                    }
                  ],
                  "outputs": {
                    "id": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName'))]"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "networkSecurityGroup",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[parameters('networkSecurityGroupName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  },
                  "securityRules": {
                    "value": "[if(empty(parameters('networkSecurityGroupRules')), variables('defaultNetworkSecurityGroupRules'), parameters('networkSecurityGroupRules'))]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "5161805386163632044"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    },
                    "securityRules": {
                      "type": "array"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/networkSecurityGroups",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "properties": {
                        "securityRules": "[parameters('securityRules')]"
                      }
                    }
                  ],
                  "outputs": {
                    "id": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('name'))]"
                    },
                    "name": {
                      "type": "string",
                      "value": "[parameters('name')]"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "routeTable",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[parameters('routeTableName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  },
                  "routeName": {
                    "value": "[parameters('routeTableRouteName')]"
                  },
                  "routeAddressPrefix": {
                    "value": "[parameters('routeTableRouteAddressPrefix')]"
                  },
                  "routeNextHopIpAddress": {
                    "value": "[parameters('routeTableRouteNextHopIpAddress')]"
                  },
                  "routeNextHopType": {
                    "value": "[parameters('routeTableRouteNextHopType')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "4341229051409225242"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    },
                    "routeName": {
                      "type": "string"
                    },
                    "routeAddressPrefix": {
                      "type": "string"
                    },
                    "routeNextHopIpAddress": {
                      "type": "string"
                    },
                    "routeNextHopType": {
                      "type": "string"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/routeTables",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "properties": {
                        "routes": [
                          {
                            "name": "[parameters('routeName')]",
                            "properties": {
                              "addressPrefix": "[parameters('routeAddressPrefix')]",
                              "nextHopIpAddress": "[parameters('routeNextHopIpAddress')]",
                              "nextHopType": "[parameters('routeNextHopType')]"
                            }
                          }
                        ]
                      }
                    }
                  ],
                  "outputs": {
                    "id": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Network/routeTables', parameters('name'))]"
                    },
                    "name": {
                      "type": "string",
                      "value": "[parameters('name')]"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "virtualNetwork",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[parameters('virtualNetworkName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  },
                  "addressPrefix": {
                    "value": "[parameters('virtualNetworkAddressPrefix')]"
                  },
                  "diagnosticsLogs": {
                    "value": "[if(empty(parameters('virtualNetworkDiagnosticsLogs')), variables('defaultVirtualNetworkDiagnosticsLogs'), parameters('virtualNetworkDiagnosticsLogs'))]"
                  },
                  "diagnosticsMetrics": {
                    "value": "[if(empty(parameters('virtualNetworkDiagnosticsMetrics')), variables('defaultVirtualNetworkDiagnosticsMetrics'), parameters('virtualNetworkDiagnosticsMetrics'))]"
                  },
                  "subnets": {
                    "value": [
                      {
                        "name": "[parameters('subnetName')]",
                        "properties": {
                          "addressPrefix": "[parameters('subnetAddressPrefix')]",
                          "networkSecurityGroup": {
                            "id": "[reference(resourceId('Microsoft.Resources/deployments', 'networkSecurityGroup'), '2019-10-01').outputs.id.value]"
                          },
                          "routeTable": {
                            "id": "[reference(resourceId('Microsoft.Resources/deployments', 'routeTable'), '2019-10-01').outputs.id.value]"
                          },
                          "serviceEndpoints": "[if(empty(parameters('subnetServiceEndpoints')), variables('defaultSubnetServiceEndpoints'), parameters('subnetServiceEndpoints'))]"
                        }
                      }
                    ]
                  },
                  "logAnalyticsWorkspaceResourceId": {
                    "value": "[parameters('logAnalyticsWorkspaceResourceId')]"
                  },
                  "logStorageAccountResourceId": {
                    "value": "[reference(resourceId('Microsoft.Resources/deployments', 'logStorage'), '2019-10-01').outputs.id.value]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "16117476816851398131"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    },
                    "addressPrefix": {
                      "type": "string"
                    },
                    "logAnalyticsWorkspaceResourceId": {
                      "type": "string"
                    },
                    "logStorageAccountResourceId": {
                      "type": "string"
                    },
                    "subnets": {
                      "type": "array"
                    },
                    "diagnosticsMetrics": {
                      "type": "array"
                    },
                    "diagnosticsLogs": {
                      "type": "array"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/virtualNetworks",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "properties": {
                        "addressSpace": {
                          "addressPrefixes": [
                            "[parameters('addressPrefix')]"
                          ]
                        },
                        "subnets": "[parameters('subnets')]"
                      }
                    },
                    {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "apiVersion": "2017-05-01-preview",
                      "scope": "[format('Microsoft.Network/virtualNetworks/{0}', parameters('name'))]",
                      "name": "[format('{0}-diagnostics', parameters('name'))]",
                      "properties": {
                        "storageAccountId": "[parameters('logStorageAccountResourceId')]",
                        "workspaceId": "[parameters('logAnalyticsWorkspaceResourceId')]",
                        "metrics": "[parameters('diagnosticsMetrics')]",
                        "logs": "[parameters('diagnosticsLogs')]"
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.Network/virtualNetworks', parameters('name'))]"
                      ]
                    }
                  ],
                  "outputs": {
                    "name": {
                      "type": "string",
                      "value": "[parameters('name')]"
                    },
                    "id": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Network/virtualNetworks', parameters('name'))]"
                    },
                    "subnets": {
                      "type": "array",
                      "value": "[reference(resourceId('Microsoft.Network/virtualNetworks', parameters('name'))).subnets]"
                    }
                  }
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Resources/deployments', 'logStorage')]",
                "[resourceId('Microsoft.Resources/deployments', 'networkSecurityGroup')]",
                "[resourceId('Microsoft.Resources/deployments', 'routeTable')]"
              ]
            }
          ],
          "outputs": {
            "virtualNetworkName": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'virtualNetwork'), '2019-10-01').outputs.name.value]"
            },
            "virtualNetworkResourceId": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'virtualNetwork'), '2019-10-01').outputs.id.value]"
            },
            "subnetName": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'virtualNetwork'), '2019-10-01').outputs.subnets.value[0].name]"
            },
            "subnetAddressPrefix": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'virtualNetwork'), '2019-10-01').outputs.subnets.value[0].properties.addressPrefix]"
            },
            "subnetResourceId": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'virtualNetwork'), '2019-10-01').outputs.subnets.value[0].id]"
            },
            "networkSecurityGroupName": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'networkSecurityGroup'), '2019-10-01').outputs.name.value]"
            },
            "networkSecurityGroupResourceId": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'networkSecurityGroup'), '2019-10-01').outputs.id.value]"
            }
          }
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc')))]",
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc')))]"
      ]
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "[format('deploy-sharedServices-spoke-{0}', parameters('nowUtc'))]",
      "subscriptionId": "[parameters('sharedServicesSubscriptionId')]",
      "resourceGroup": "[parameters('sharedServicesResourceGroupName')]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "location": {
            "value": "[parameters('sharedServicesLocation')]"
          },
          "tags": {
            "value": "[parameters('tags')]"
          },
          "logStorageAccountName": {
            "value": "[parameters('sharedServicesLogStorageAccountName')]"
          },
          "logStorageSkuName": {
            "value": "[parameters('sharedServicesLogStorageSkuName')]"
          },
          "logAnalyticsWorkspaceResourceId": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc'))), '2019-10-01').outputs.id.value]"
          },
          "firewallPrivateIPAddress": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.firewallPrivateIPAddress.value]"
          },
          "virtualNetworkName": {
            "value": "[parameters('sharedServicesVirtualNetworkName')]"
          },
          "virtualNetworkAddressPrefix": {
            "value": "[parameters('sharedServicesVirtualNetworkAddressPrefix')]"
          },
          "virtualNetworkDiagnosticsLogs": {
            "value": "[parameters('sharedServicesVirtualNetworkDiagnosticsLogs')]"
          },
          "virtualNetworkDiagnosticsMetrics": {
            "value": "[parameters('sharedServicesVirtualNetworkDiagnosticsMetrics')]"
          },
          "networkSecurityGroupName": {
            "value": "[parameters('sharedServicesNetworkSecurityGroupName')]"
          },
          "networkSecurityGroupRules": {
            "value": "[parameters('sharedServicesNetworkSecurityGroupRules')]"
          },
          "subnetName": {
            "value": "[parameters('sharedServicesSubnetName')]"
          },
          "subnetAddressPrefix": {
            "value": "[parameters('sharedServicesSubnetAddressPrefix')]"
          },
          "subnetServiceEndpoints": {
            "value": "[parameters('sharedServicesSubnetServiceEndpoints')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "15949869288234268239"
            }
          },
          "parameters": {
            "location": {
              "type": "string",
              "defaultValue": "[resourceGroup().location]"
            },
            "tags": {
              "type": "object",
              "defaultValue": {}
            },
            "logStorageAccountName": {
              "type": "string"
            },
            "logStorageSkuName": {
              "type": "string"
            },
            "logAnalyticsWorkspaceResourceId": {
              "type": "string"
            },
            "firewallPrivateIPAddress": {
              "type": "string"
            },
            "virtualNetworkName": {
              "type": "string"
            },
            "virtualNetworkAddressPrefix": {
              "type": "string"
            },
            "virtualNetworkDiagnosticsLogs": {
              "type": "array"
            },
            "virtualNetworkDiagnosticsMetrics": {
              "type": "array"
            },
            "networkSecurityGroupName": {
              "type": "string"
            },
            "networkSecurityGroupRules": {
              "type": "array"
            },
            "subnetName": {
              "type": "string"
            },
            "subnetAddressPrefix": {
              "type": "string"
            },
            "subnetServiceEndpoints": {
              "type": "array"
            },
            "routeTableName": {
              "type": "string",
              "defaultValue": "[format('{0}-routetable', parameters('subnetName'))]"
            },
            "routeTableRouteName": {
              "type": "string",
              "defaultValue": "default_route"
            },
            "routeTableRouteAddressPrefix": {
              "type": "string",
              "defaultValue": "0.0.0.0/0"
            },
            "routeTableRouteNextHopIpAddress": {
              "type": "string",
              "defaultValue": "[parameters('firewallPrivateIPAddress')]"
            },
            "routeTableRouteNextHopType": {
              "type": "string",
              "defaultValue": "VirtualAppliance"
            }
          },
          "functions": [],
          "variables": {
            "defaultVirtualNetworkDiagnosticsLogs": [],
            "defaultVirtualNetworkDiagnosticsMetrics": [
              {
                "category": "AllMetrics",
                "enabled": true
              }
            ],
            "defaultSubnetServiceEndpoints": [
              {
                "service": "Microsoft.Storage"
              }
            ],
            "defaultNetworkSecurityGroupRules": [
              {
                "name": "allow_ssh",
                "properties": {
                  "description": "Allow SSH access from anywhere",
                  "access": "Allow",
                  "priority": 100,
                  "protocol": "Tcp",
                  "direction": "Inbound",
                  "sourcePortRange": "*",
                  "sourceAddressPrefix": "*",
                  "destinationPortRange": "22",
                  "destinationAddressPrefix": "*"
                }
              },
              {
                "name": "allow_rdp",
                "properties": {
                  "description": "Allow RDP access from anywhere",
                  "access": "Allow",
                  "priority": 200,
                  "protocol": "Tcp",
                  "direction": "Inbound",
                  "sourcePortRange": "*",
                  "sourceAddressPrefix": "*",
                  "destinationPortRange": "3389",
                  "destinationAddressPrefix": "*"
                }
              }
            ]
          },
          "resources": [
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "logStorage",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "storageAccountName": {
                    "value": "[parameters('logStorageAccountName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "skuName": {
                    "value": "[parameters('logStorageSkuName')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "833209748305454708"
                    }
                  },
                  "parameters": {
                    "storageAccountName": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "skuName": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Storage/storageAccounts",
                      "apiVersion": "2019-06-01",
                      "name": "[parameters('storageAccountName')]",
                      "location": "[parameters('location')]",
                      "kind": "Storage",
                      "sku": {
                        "name": "[parameters('skuName')]"
                      },
                      "tags": "[parameters('tags')]"
                    }
                  ],
                  "outputs": {
                    "id": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName'))]"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "networkSecurityGroup",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[parameters('networkSecurityGroupName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  },
                  "securityRules": {
                    "value": "[if(empty(parameters('networkSecurityGroupRules')), variables('defaultNetworkSecurityGroupRules'), parameters('networkSecurityGroupRules'))]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "5161805386163632044"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    },
                    "securityRules": {
                      "type": "array"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/networkSecurityGroups",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "properties": {
                        "securityRules": "[parameters('securityRules')]"
                      }
                    }
                  ],
                  "outputs": {
                    "id": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('name'))]"
                    },
                    "name": {
                      "type": "string",
                      "value": "[parameters('name')]"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "routeTable",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[parameters('routeTableName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  },
                  "routeName": {
                    "value": "[parameters('routeTableRouteName')]"
                  },
                  "routeAddressPrefix": {
                    "value": "[parameters('routeTableRouteAddressPrefix')]"
                  },
                  "routeNextHopIpAddress": {
                    "value": "[parameters('routeTableRouteNextHopIpAddress')]"
                  },
                  "routeNextHopType": {
                    "value": "[parameters('routeTableRouteNextHopType')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "4341229051409225242"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    },
                    "routeName": {
                      "type": "string"
                    },
                    "routeAddressPrefix": {
                      "type": "string"
                    },
                    "routeNextHopIpAddress": {
                      "type": "string"
                    },
                    "routeNextHopType": {
                      "type": "string"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/routeTables",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "properties": {
                        "routes": [
                          {
                            "name": "[parameters('routeName')]",
                            "properties": {
                              "addressPrefix": "[parameters('routeAddressPrefix')]",
                              "nextHopIpAddress": "[parameters('routeNextHopIpAddress')]",
                              "nextHopType": "[parameters('routeNextHopType')]"
                            }
                          }
                        ]
                      }
                    }
                  ],
                  "outputs": {
                    "id": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Network/routeTables', parameters('name'))]"
                    },
                    "name": {
                      "type": "string",
                      "value": "[parameters('name')]"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "virtualNetwork",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[parameters('virtualNetworkName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  },
                  "addressPrefix": {
                    "value": "[parameters('virtualNetworkAddressPrefix')]"
                  },
                  "diagnosticsLogs": {
                    "value": "[if(empty(parameters('virtualNetworkDiagnosticsLogs')), variables('defaultVirtualNetworkDiagnosticsLogs'), parameters('virtualNetworkDiagnosticsLogs'))]"
                  },
                  "diagnosticsMetrics": {
                    "value": "[if(empty(parameters('virtualNetworkDiagnosticsMetrics')), variables('defaultVirtualNetworkDiagnosticsMetrics'), parameters('virtualNetworkDiagnosticsMetrics'))]"
                  },
                  "subnets": {
                    "value": [
                      {
                        "name": "[parameters('subnetName')]",
                        "properties": {
                          "addressPrefix": "[parameters('subnetAddressPrefix')]",
                          "networkSecurityGroup": {
                            "id": "[reference(resourceId('Microsoft.Resources/deployments', 'networkSecurityGroup'), '2019-10-01').outputs.id.value]"
                          },
                          "routeTable": {
                            "id": "[reference(resourceId('Microsoft.Resources/deployments', 'routeTable'), '2019-10-01').outputs.id.value]"
                          },
                          "serviceEndpoints": "[if(empty(parameters('subnetServiceEndpoints')), variables('defaultSubnetServiceEndpoints'), parameters('subnetServiceEndpoints'))]"
                        }
                      }
                    ]
                  },
                  "logAnalyticsWorkspaceResourceId": {
                    "value": "[parameters('logAnalyticsWorkspaceResourceId')]"
                  },
                  "logStorageAccountResourceId": {
                    "value": "[reference(resourceId('Microsoft.Resources/deployments', 'logStorage'), '2019-10-01').outputs.id.value]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "16117476816851398131"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    },
                    "addressPrefix": {
                      "type": "string"
                    },
                    "logAnalyticsWorkspaceResourceId": {
                      "type": "string"
                    },
                    "logStorageAccountResourceId": {
                      "type": "string"
                    },
                    "subnets": {
                      "type": "array"
                    },
                    "diagnosticsMetrics": {
                      "type": "array"
                    },
                    "diagnosticsLogs": {
                      "type": "array"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/virtualNetworks",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "properties": {
                        "addressSpace": {
                          "addressPrefixes": [
                            "[parameters('addressPrefix')]"
                          ]
                        },
                        "subnets": "[parameters('subnets')]"
                      }
                    },
                    {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "apiVersion": "2017-05-01-preview",
                      "scope": "[format('Microsoft.Network/virtualNetworks/{0}', parameters('name'))]",
                      "name": "[format('{0}-diagnostics', parameters('name'))]",
                      "properties": {
                        "storageAccountId": "[parameters('logStorageAccountResourceId')]",
                        "workspaceId": "[parameters('logAnalyticsWorkspaceResourceId')]",
                        "metrics": "[parameters('diagnosticsMetrics')]",
                        "logs": "[parameters('diagnosticsLogs')]"
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.Network/virtualNetworks', parameters('name'))]"
                      ]
                    }
                  ],
                  "outputs": {
                    "name": {
                      "type": "string",
                      "value": "[parameters('name')]"
                    },
                    "id": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Network/virtualNetworks', parameters('name'))]"
                    },
                    "subnets": {
                      "type": "array",
                      "value": "[reference(resourceId('Microsoft.Network/virtualNetworks', parameters('name'))).subnets]"
                    }
                  }
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Resources/deployments', 'logStorage')]",
                "[resourceId('Microsoft.Resources/deployments', 'networkSecurityGroup')]",
                "[resourceId('Microsoft.Resources/deployments', 'routeTable')]"
              ]
            }
          ],
          "outputs": {
            "virtualNetworkName": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'virtualNetwork'), '2019-10-01').outputs.name.value]"
            },
            "virtualNetworkResourceId": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'virtualNetwork'), '2019-10-01').outputs.id.value]"
            },
            "subnetName": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'virtualNetwork'), '2019-10-01').outputs.subnets.value[0].name]"
            },
            "subnetAddressPrefix": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'virtualNetwork'), '2019-10-01').outputs.subnets.value[0].properties.addressPrefix]"
            },
            "subnetResourceId": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'virtualNetwork'), '2019-10-01').outputs.subnets.value[0].id]"
            },
            "networkSecurityGroupName": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'networkSecurityGroup'), '2019-10-01').outputs.name.value]"
            },
            "networkSecurityGroupResourceId": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'networkSecurityGroup'), '2019-10-01').outputs.id.value]"
            }
          }
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc')))]",
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc')))]"
      ]
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "[format('deploy-hub-peerings-{0}', parameters('nowUtc'))]",
      "subscriptionId": "[parameters('hubSubscriptionId')]",
      "location": "[deployment().location]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "hubResourceGroupName": {
            "value": "[reference(subscriptionResourceId(parameters('hubSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-hub-rg-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value]"
          },
          "hubVirtualNetworkName": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkName.value]"
          },
          "identityVirtualNetworkName": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('identitySubscriptionId'), parameters('identityResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-identity-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkName.value]"
          },
          "operationsVirtualNetworkName": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-operations-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkName.value]"
          },
          "sharedServicesVirtualNetworkName": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('sharedServicesSubscriptionId'), parameters('sharedServicesResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-sharedServices-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkName.value]"
          },
          "identityVirtualNetworkResourceId": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('identitySubscriptionId'), parameters('identityResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-identity-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkResourceId.value]"
          },
          "operationsVirtualNetworkResourceId": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('sharedServicesSubscriptionId'), parameters('sharedServicesResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-sharedServices-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkResourceId.value]"
          },
          "sharedServicesVirtualNetworkResourceId": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-operations-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkResourceId.value]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "9872315491162767153"
            }
          },
          "parameters": {
            "hubResourceGroupName": {
              "type": "string"
            },
            "hubVirtualNetworkName": {
              "type": "string"
            },
            "identityVirtualNetworkName": {
              "type": "string"
            },
            "identityVirtualNetworkResourceId": {
              "type": "string"
            },
            "operationsVirtualNetworkName": {
              "type": "string"
            },
            "operationsVirtualNetworkResourceId": {
              "type": "string"
            },
            "sharedServicesVirtualNetworkName": {
              "type": "string"
            },
            "sharedServicesVirtualNetworkResourceId": {
              "type": "string"
            }
          },
          "functions": [],
          "resources": [
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "hubToIdentityVirtualNetworkPeering",
              "resourceGroup": "[parameters('hubResourceGroupName')]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[format('{0}/to-{1}', parameters('hubVirtualNetworkName'), parameters('identityVirtualNetworkName'))]"
                  },
                  "remoteVirtualNetworkResourceId": {
                    "value": "[parameters('identityVirtualNetworkResourceId')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "12715137779259556895"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "remoteVirtualNetworkResourceId": {
                      "type": "string"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "properties": {
                        "remoteVirtualNetwork": {
                          "id": "[parameters('remoteVirtualNetworkResourceId')]"
                        }
                      }
                    }
                  ]
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "hubToOperationsVirtualNetworkPeering",
              "resourceGroup": "[parameters('hubResourceGroupName')]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[format('{0}/to-{1}', parameters('hubVirtualNetworkName'), parameters('operationsVirtualNetworkName'))]"
                  },
                  "remoteVirtualNetworkResourceId": {
                    "value": "[parameters('operationsVirtualNetworkResourceId')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "12715137779259556895"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "remoteVirtualNetworkResourceId": {
                      "type": "string"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "properties": {
                        "remoteVirtualNetwork": {
                          "id": "[parameters('remoteVirtualNetworkResourceId')]"
                        }
                      }
                    }
                  ]
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "hubToSharedServicesVirtualNetworkPeering",
              "resourceGroup": "[parameters('hubResourceGroupName')]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[format('{0}/to-{1}', parameters('hubVirtualNetworkName'), parameters('sharedServicesVirtualNetworkName'))]"
                  },
                  "remoteVirtualNetworkResourceId": {
                    "value": "[parameters('sharedServicesVirtualNetworkResourceId')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "12715137779259556895"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "remoteVirtualNetworkResourceId": {
                      "type": "string"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "properties": {
                        "remoteVirtualNetwork": {
                          "id": "[parameters('remoteVirtualNetworkResourceId')]"
                        }
                      }
                    }
                  ]
                }
              }
            }
          ]
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc')))]",
        "[subscriptionResourceId(parameters('hubSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-hub-rg-{0}', parameters('nowUtc')))]",
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('identitySubscriptionId'), parameters('identityResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-identity-spoke-{0}', parameters('nowUtc')))]",
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-operations-spoke-{0}', parameters('nowUtc')))]",
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('sharedServicesSubscriptionId'), parameters('sharedServicesResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-sharedServices-spoke-{0}', parameters('nowUtc')))]"
      ]
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "[format('deploy-identity-peerings-{0}', parameters('nowUtc'))]",
      "subscriptionId": "[parameters('identitySubscriptionId')]",
      "location": "[deployment().location]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "spokeResourceGroupName": {
            "value": "[reference(subscriptionResourceId(parameters('identitySubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-identity-rg-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value]"
          },
          "spokeVirtualNetworkName": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('identitySubscriptionId'), parameters('identityResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-identity-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkName.value]"
          },
          "hubVirtualNetworkName": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkName.value]"
          },
          "hubVirtualNetworkResourceId": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkResourceId.value]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "7742888482530749531"
            }
          },
          "parameters": {
            "spokeResourceGroupName": {
              "type": "string"
            },
            "spokeVirtualNetworkName": {
              "type": "string"
            },
            "hubVirtualNetworkName": {
              "type": "string"
            },
            "hubVirtualNetworkResourceId": {
              "type": "string"
            }
          },
          "functions": [],
          "resources": [
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "spokeNetworkPeering",
              "resourceGroup": "[parameters('spokeResourceGroupName')]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[format('{0}/to-{1}', parameters('spokeVirtualNetworkName'), parameters('hubVirtualNetworkName'))]"
                  },
                  "remoteVirtualNetworkResourceId": {
                    "value": "[parameters('hubVirtualNetworkResourceId')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "12715137779259556895"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "remoteVirtualNetworkResourceId": {
                      "type": "string"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "properties": {
                        "remoteVirtualNetwork": {
                          "id": "[parameters('remoteVirtualNetworkResourceId')]"
                        }
                      }
                    }
                  ]
                }
              }
            }
          ]
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc')))]",
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('identitySubscriptionId'), parameters('identityResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-identity-spoke-{0}', parameters('nowUtc')))]",
        "[subscriptionResourceId(parameters('identitySubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-identity-rg-{0}', parameters('nowUtc')))]"
      ]
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "[format('deploy-operations-peerings-{0}', parameters('nowUtc'))]",
      "subscriptionId": "[parameters('operationsSubscriptionId')]",
      "location": "[deployment().location]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "spokeResourceGroupName": {
            "value": "[reference(subscriptionResourceId(parameters('operationsSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-operations-rg-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value]"
          },
          "spokeVirtualNetworkName": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-operations-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkName.value]"
          },
          "hubVirtualNetworkName": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkName.value]"
          },
          "hubVirtualNetworkResourceId": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkResourceId.value]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "7742888482530749531"
            }
          },
          "parameters": {
            "spokeResourceGroupName": {
              "type": "string"
            },
            "spokeVirtualNetworkName": {
              "type": "string"
            },
            "hubVirtualNetworkName": {
              "type": "string"
            },
            "hubVirtualNetworkResourceId": {
              "type": "string"
            }
          },
          "functions": [],
          "resources": [
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "spokeNetworkPeering",
              "resourceGroup": "[parameters('spokeResourceGroupName')]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[format('{0}/to-{1}', parameters('spokeVirtualNetworkName'), parameters('hubVirtualNetworkName'))]"
                  },
                  "remoteVirtualNetworkResourceId": {
                    "value": "[parameters('hubVirtualNetworkResourceId')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "12715137779259556895"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "remoteVirtualNetworkResourceId": {
                      "type": "string"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "properties": {
                        "remoteVirtualNetwork": {
                          "id": "[parameters('remoteVirtualNetworkResourceId')]"
                        }
                      }
                    }
                  ]
                }
              }
            }
          ]
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc')))]",
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-operations-spoke-{0}', parameters('nowUtc')))]",
        "[subscriptionResourceId(parameters('operationsSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-operations-rg-{0}', parameters('nowUtc')))]"
      ]
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "[format('deploy-sharedServices-peerings-{0}', parameters('nowUtc'))]",
      "subscriptionId": "[parameters('sharedServicesSubscriptionId')]",
      "location": "[deployment().location]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "spokeResourceGroupName": {
            "value": "[reference(subscriptionResourceId(parameters('sharedServicesSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-sharedServices-rg-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value]"
          },
          "spokeVirtualNetworkName": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('sharedServicesSubscriptionId'), parameters('sharedServicesResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-sharedServices-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkName.value]"
          },
          "hubVirtualNetworkName": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkName.value]"
          },
          "hubVirtualNetworkResourceId": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkResourceId.value]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "7742888482530749531"
            }
          },
          "parameters": {
            "spokeResourceGroupName": {
              "type": "string"
            },
            "spokeVirtualNetworkName": {
              "type": "string"
            },
            "hubVirtualNetworkName": {
              "type": "string"
            },
            "hubVirtualNetworkResourceId": {
              "type": "string"
            }
          },
          "functions": [],
          "resources": [
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "spokeNetworkPeering",
              "resourceGroup": "[parameters('spokeResourceGroupName')]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[format('{0}/to-{1}', parameters('spokeVirtualNetworkName'), parameters('hubVirtualNetworkName'))]"
                  },
                  "remoteVirtualNetworkResourceId": {
                    "value": "[parameters('hubVirtualNetworkResourceId')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "12715137779259556895"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "remoteVirtualNetworkResourceId": {
                      "type": "string"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "properties": {
                        "remoteVirtualNetwork": {
                          "id": "[parameters('remoteVirtualNetworkResourceId')]"
                        }
                      }
                    }
                  ]
                }
              }
            }
          ]
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc')))]",
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('sharedServicesSubscriptionId'), parameters('sharedServicesResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-sharedServices-spoke-{0}', parameters('nowUtc')))]",
        "[subscriptionResourceId(parameters('sharedServicesSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-sharedServices-rg-{0}', parameters('nowUtc')))]"
      ]
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "[format('assign-policy-{0}', parameters('hubResourceGroupName'))]",
      "subscriptionId": "[parameters('hubSubscriptionId')]",
      "resourceGroup": "[parameters('hubResourceGroupName')]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "builtInAssignment": {
            "value": "[parameters('policy')]"
          },
          "logAnalyticsWorkspaceName": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value]"
          },
          "logAnalyticsWorkspaceResourceGroupName": {
            "value": "[reference(subscriptionResourceId(parameters('operationsSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-operations-rg-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value]"
          },
          "operationsSubscriptionId": {
            "value": "[parameters('operationsSubscriptionId')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "3675806177489000536"
            }
          },
          "parameters": {
            "builtInAssignment": {
              "type": "string",
              "defaultValue": ""
            },
            "logAnalyticsWorkspaceName": {
              "type": "string"
            },
            "logAnalyticsWorkspaceResourceGroupName": {
              "type": "string"
            },
            "operationsSubscriptionId": {
              "type": "string"
            }
          },
          "functions": [],
          "variables": {
            "modifiedAssignment": "[if(and(equals(toLower(environment().name), toLower('AzureCloud')), equals(toLower(parameters('builtInAssignment')), toLower('IL5'))), 'NIST', parameters('builtInAssignment'))]",
            "assignmentName": "[format('{0} {1}', variables('modifiedAssignment'), resourceGroup().name)]"
          },
          "resources": [
            {
              "condition": "[not(empty(variables('modifiedAssignment')))]",
              "type": "Microsoft.Authorization/policyAssignments",
              "apiVersion": "2020-09-01",
              "name": "[variables('assignmentName')]",
              "location": "[resourceGroup().location]",
              "properties": {
                "policyDefinitionId": "[createObject('NIST', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f', 'parameters', json(replace('    {\n        \"listOfMembersToExcludeFromWindowsVMAdministratorsGroup\": \n        {\n        \"value\": \"admin\"\n        },\n        \"listOfMembersToIncludeInWindowsVMAdministratorsGroup\": \n        {\n        \"value\": \"azureuser\"\n        },\n        \"logAnalyticsWorkspaceIdforVMReporting\": \n        {\n        \"value\": \"<LAWORKSPACE>\"\n        },\n        \"IncludeArcMachines\": \n        {\n            \"value\": \"true\"\n        },\n        \"MinimumTLSVersion-5752e6d6-1206-46d8-8ab1-ecc2f71a8112\": \n        {\n            \"value\": \"1.2\"\n        },\n        \"NotAvailableMachineState-bed48b13-6647-468e-aa2f-1af1d3f4dd40\": \n        {\n            \"value\": \"Compliant\"\n        },\n        \"requiredRetentionDays\": \n        {\n            \"value\": \"365\"\n        },\n        \"resourceGroupName-b6e2945c-0b7b-40f5-9233-7a5323b5cdc6\": \n        {\n            \"value\": \"NetworkWatcherRG\"\n        }\n    }', '<LAWORKSPACE>', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))))), 'IL5', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/f9a961fa-3241-4b20-adc4-bbf8ad9d7197', 'parameters', json(replace('{\n    \"IncludeArcMachines\" : { \n        \"value\" : \"false\"\n        },\n        \"NotAvailableMachineState-bed48b13-6647-468e-aa2f-1af1d3f4dd40\" : { \n        \"value\" : \"Compliant\"\n        },\n        \"MinimumTLSVersionForWindowsServers\" : { \n        \"value\" : \"1.2\"\n        },\n        \"requiredRetentionDays\" : { \n        \"value\" : \"365\"\n        },\n        \"effect-febd0533-8e55-448f-b837-bd0e06f16469\" : { \n        \"value\" : \"audit\"\n        },\n        \"allowedContainerImagesRegex-febd0533-8e55-448f-b837-bd0e06f16469\" : { \n        \"value\" : \"^(.+){0}$\"\n        },\n        \"effect-95edb821-ddaf-4404-9732-666045e056b4\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-440b515e-a580-421e-abeb-b159a61ddcbc\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-233a2a17-77ca-4fb1-9b6b-69223d272a44\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"audit\"\n        },\n        \"cpuLimit-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"0\"\n        },\n        \"memoryLimit-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"0\"\n        },\n        \"effect-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"audit\"\n        },\n        \"runAsUserRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"MustRunAsNonRoot\"\n        },\n        \"runAsGroupRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"supplementalGroupsRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"fsGroupRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"effect-1c6e92c9-99f0-4e55-9cf2-0c234dc48f99\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-df49d893-a74c-421d-bc95-c663042e5b80\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-c26596ff-4d70-4e6a-9a30-c2506bd2f80c\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-511f5417-5d12-434d-ab2e-816901e72a5e\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-82985f06-dc18-4a48-bc1c-b9f4f0098cfe\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-098fc59e-46c7-4d99-9b16-64990e543d75\" : { \n        \"value\" : \"audit\"\n        },\n        \"NetworkWatcherResourceGroupName\" : { \n        \"value\" : \"NetworkWatcherRG\"\n        },\n        \"setting-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n        \"value\" : \"enabled\"\n        },\n        \"aadAuthenticationInServiceFabricMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-71ef260a-8f18-47b7-abcb-62d0673d94dc\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-055aa869-bc98-4af8-bafc-23f1ab6ffe2c\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-564feb30-bf6a-4854-b4bb-0d2d2d1e6c66\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-d9da03a1-f3c3-412a-9709-947156872263\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-617c02be-7f02-4efd-8836-3180d47b6c68\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ec068d99-e9c7-401f-8cef-5bdde4e6ccf1\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-c349d81b-9985-44ae-a8da-ff98d108ede8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-3657f5a0-770e-44a3-b44e-9431ba1e9735\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-b4ac1030-89c5-4697-8e00-28b5ba6a8811\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-ea0dfaed-95fb-448c-934e-d6e713ce393d\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-4733ea7b-a883-42fe-8cac-97454c2a9e4a\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-f4b53539-8df9-40e4-86c6-6b607703bd4e\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-41425d9f-d1a5-499a-9932-f8ed8453932c\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-fc4d8e41-e223-45ea-9bf5-eada37891d87\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-86efb160-8de7-451d-bc08-5d475b0aadae\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-4ec52d6d-beb7-40c4-9a9e-fe753254690e\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-64d314f6-6062-4780-a861-c23e8951bee5\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1fd32ebd-e4c3-4e13-a54a-d7422d4d95f6\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-fa298e57-9444-42ba-bf04-86e8470e32c7\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-67121cc7-ff39-4ab8-b7e3-95b84dab487d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1f905d99-2ab7-462c-a6b0-f709acca6c8f\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ba769a63-b8cc-4b2d-abf6-ac33c7204be8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-81e74cea-30fd-40d5-802f-d72103c2aaaa\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0aa61e00-0a01-4a3c-9945-e93cffedf0e6\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-47031206-ce96-41f8-861b-6a915f3de284\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-87ba29ef-1ab3-4d82-b763-87fcd4f531f7\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-51522a96-0869-4791-82f3-981000c2c67f\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-b5ec538c-daa0-4006-8596-35468b9148e8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-56a5ee18-2ae6-4810-86f7-18e39ce5629b\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-2e94d99a-8a36-4563-bc77-810d8893b671\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1fafeaf6-7927-4059-a50a-8eb2a7a6f2b5\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-99e9ccd8-3db9-4592-b0d1-14b1715a4d8a\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1f68a601-6e6d-4e42-babf-3f643a047ea2\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-f7d52b2d-e161-4dfa-a82b-55e564167385\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-7d7be79c-23ba-4033-84dd-45e2a5ccdd67\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ca91455f-eace-4f96-be59-e6e2c35b4816\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-702dd420-7fcc-42c5-afe8-4026edd20fe0\" : { \n        \"value\" : \"Audit\"\n        },\n        \"diagnosticsLogsInRedisCacheMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"secureTransferToStorageAccountMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-d0793b48-0edc-4296-a390-4c75d1bdfd71\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-7d092e0a-7acd-40d2-a975-dca21cae48c4\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-2a1a9cdf-e04d-429a-8416-3bfb72a1b26f\" : { \n        \"value\" : \"Audit\"\n        },\n        \"disableUnrestrictedNetworkToStorageAccountMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-55615ac9-af46-4a59-874e-391cc3dfb490\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1b8ca024-1d5c-4dec-8995-b1a932b41780\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-037eea7a-bd0a-46c5-9a66-03aea78705d3\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-53503636-bcc9-4748-9663-5348217f160f\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-40cec1dd-a100-4920-b15b-3024fe8901ab\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0725b4dd-7e76-479c-a735-68e7ee23d5ca\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-a049bf77-880b-470f-ba6d-9f21c530cf83\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ee980b6d-0eca-4501-8d54-f6290fd512c3\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1d84d5fb-01f6-4d12-ba4f-4a26081d403d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-37e0d2fe-28a5-43d6-a273-67d37d1f5606\" : { \n        \"value\" : \"Audit\"\n        },\n        \"identityDesignateMoreThanOneOwnerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"diskEncryptionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"emailNotificationToSubscriptionOwnerHighSeverityAlertsEnabledEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlDbEncryptionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vulnerabilityAssessmentOnManagedInstanceMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePHPVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"aadAuthenticationInSqlServerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vmssEndpointProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vmssOsVulnerabilitiesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"adaptiveApplicationControlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"geoRedundantBackupShouldBeEnabledForAzureDatabaseForPostgreSQLEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"ensureJavaVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityDesignateLessThanOwnersMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"securityContactEmailAddressForSubscriptionEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppRestrictCORSAccessMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveDeprecatedAccountMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"ensurePythonVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePythonVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePHPVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePythonVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"geoRedundantBackupShouldBeEnabledForAzureDatabaseForMySQLEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"systemUpdatesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureJavaVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForWritePermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureJavaVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"nextGenerationFirewallMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"useRbacRulesMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"webAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"sqlServerAuditingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vnetEnableDDoSProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlServerAdvancedDataSecurityMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"endpointProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"jitNetworkAccessMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"geoRedundantStorageShouldBeEnabledForStorageAccountsEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"vmssSystemUpdatesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"longtermGeoRedundantBackupEnabledAzureSQLDatabasesEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"systemConfigurationsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForReadPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"containerBenchmarkMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vulnerabilityAssessmentOnServerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"kubernetesServiceVersionUpToDateMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"sqlDbVulnerabilityAssesmentMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"membersToIncludeInLocalAdministratorsGroup\" : { \n        \"value\" : \"\"\n        },\n        \"membersToExcludeInLocalAdministratorsGroup\" : { \n        \"value\" : \"\"\n        },\n        \"logAnalyticsWorkspaceIDForVMAgents\" : { \n        \"value\" : \"<LAWORKSPACE>\"\n        },\n        \"PHPLatestVersionForAppServices\" : { \n        \"value\" : \"7.4\"\n        },\n        \"JavaLatestVersionForAppServices\" : { \n        \"value\" : \"11\"\n        },\n        \"WindowsPythonLatestVersionForAppServices\" : { \n        \"value\" : \"3.6\"\n        },\n        \"LinuxPythonLatestVersionForAppServices\" : { \n        \"value\" : \"3.9\"\n        },\n        \"ensureDotNetFrameworkLatestForFunctionAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityEmailsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"vulnerabilityAssessmentMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensureDotNetFrameworkLatestForWebAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlServerAdvancedDataSecurityEmailsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"microsoftIaaSAntimalwareExtensionShouldBeDeployedOnWindowsServersEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"securityCenterStandardPricingTierShouldBeSelectedEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"theLogAnalyticsAgentShouldBeInstalledOnVirtualMachinesEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensurePHPVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityEmailAdminsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"securityContactPhoneNumberShouldBeProvidedForSubscriptionEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"threatDetectionTypesOnManagedInstanceMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensureDotNetFrameworkLatestForAPIAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlServerAdvancedDataSecurityEmailAdminsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"threatDetectionTypesOnServerMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"theLogAnalyticsAgentShouldBeInstalledOnVirtualMachineScaleSetsEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        }\n}', '<LAWORKSPACE>', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))))), 'CMMC', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/b5629c75-5c77-4422-87b9-2509e680f8de', 'parameters', json(replace('{\n    \"logAnalyticsWorkspaceId-f47b5582-33ec-4c5c-87c0-b010a6b2e917\" : { \n        \"value\" : \"<LAWORKSPACE>\"\n    },\n    \"effect-09024ccc-0c5f-475e-9457-b7c0d9ed487b\" : { \n        \"value\" : \"AuditIfNotExists\"\n    },\n    \"MembersToExclude-69bf4abd-ca1e-4cf6-8b5a-762d42e61d4f\" :{\n        \"value\": \"\"\n    },\n    \"MembersToInclude-30f71ea1-ac77-4f26-9fc5-2d926bbd4ba7\": {\n        \"value\": \"\"\n    },\n    \"effect-0961003e-5a0a-4549-abde-af6a37f2724d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0b15565f-aa9e-48ba-8619-45960f2c314d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0e60b895-3786-45da-8377-9c6b4b6ac5f9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-17k78e20-9358-41c9-923c-fb736d382a12\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-1bc1795e-d44a-4d48-9b3b-6fff0fd5f9ba\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"PHPLatestVersion\" : { \n    \"value\" : \"7.3\"\n    },\n    \"effect-22bee202-a82f-4305-9a2a-6d7f44d4dedb\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-26a828e1-e88f-464e-bbb3-c134a282b9de\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-34c877ad-507e-4c82-993e-3452a6e0ad3c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-404c3081-a854-4457-ae30-26a93ef643f9\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-47a6b606-51aa-4496-8bb7-64b11cf66adc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-496223c3-ad65-4ecd-878a-bae78737e9ed\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"JavaLatestVersion\" : { \n    \"value\" : \"11\"\n    },\n    \"effect-4f11b553-d42e-4e3a-89be-32ca364cad4c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5c607a2e-c700-4744-8254-d77e7c9eb5e4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5f76cf89-fbf2-47fd-a3f4-b891fa780b60\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6b1cbf55-e8b6-442f-ba4c-7246b6381474\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-7008174a-fd10-4ef0-817e-fc820a951d73\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"LinuxPythonLatestVersion\" : { \n    \"value\" : \"3.8\"\n    },\n    \"effect-7238174a-fd10-4ef0-817e-fc820a951d73\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7261b898-8a84-4db8-9e04-18527132abb3\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-74c3584d-afae-46f7-a20a-6f8adba71a16\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-86b3d65f-7626-441e-b690-81a8b71cff60\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-88999f4c-376a-45c8-bcb3-4058f713cf39\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-8c122334-9d20-4eb8-89ea-ac9a705b74ae\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9297c21d-2ed6-4474-b48f-163f75654ce3\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-991310cd-e9f3-47bc-b7b6-f57b557d07db\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9b597639-28e4-48eb-b506-56b05d366257\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9d0b6ea4-93e2-4578-bf2f-6bb17d22b4bc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9daedab3-fb2d-461e-b861-71790eead4f6\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-a4af4a39-4135-47fb-b175-47fbdf85311d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"setting-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n    \"value\" : \"enabled\"\n    },\n    \"effect-a70ca396-0a34-413a-88e1-b956c1e683be\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-aa633080-8b72-40c4-a2d7-d00c03e80bed\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-af6cd1bd-1635-48cb-bde7-5b15693900b9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"resourceGroupName-b6e2945c-0b7b-40f5-9233-7a5323b5cdc6\" : { \n    \"value\" : \"NetworkWatcherRG\"\n    },\n    \"effect-b7ddfbdc-1260-477d-91fd-98bd9be789a6\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c3f317a7-a95c-4547-b7e7-11017ebdf2fe\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-cb510bfd-1cba-4d9f-a230-cb0976f4bb71\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e2c1c086-2d84-4019-bff3-c44ccd95113c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e3576e28-8b17-4677-84c3-db2990658d64\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e8cbc669-f12d-49eb-93e7-9273119e9933\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e9c8d085-d9cc-4b17-9cdc-059f1f01f19e\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ebb62a0c-3560-49e1-89ed-27e074e9f8ad\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-efbde977-ba53-4479-b8e9-10b957924fbf\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f6de0be7-9a8a-4b8a-b349-43cf02d22f7c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f8456c1c-aa66-4dfb-861a-25d127b775c9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f9d614c5-c173-4d56-95a7-b4437057d193\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-fb893a29-21bb-418c-a157-e99480ec364c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-feedbf84-6b99-488c-acc2-71c829aa5ffc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-3b980d31-7904-4bb7-8575-5665739a8052\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6e2593d9-add6-4083-9c9b-4b7d2188c899\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-12430be1-6cc8-4527-a9a8-e3d38f250096\" : { \n    \"value\" : \"Audit\"\n    },\n    \"modeRequirement-12430be1-6cc8-4527-a9a8-e3d38f250096\" : { \n    \"value\" : \"Detection\"\n    },\n    \"effect-425bea59-a659-4cbb-8d31-34499bd030b8\" : { \n    \"value\" : \"Audit\"\n    },\n    \"modeRequirement-425bea59-a659-4cbb-8d31-34499bd030b8\" : { \n    \"value\" : \"Detection\"\n    },\n    \"effect-564feb30-bf6a-4854-b4bb-0d2d2d1e6c66\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-055aa869-bc98-4af8-bafc-23f1ab6ffe2c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-013e242c-8828-4970-87b3-ab247555486d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-d38fc420-0735-4ef3-ac11-c806f651a570\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-a1181c5f-672a-477a-979a-7d58aa086233\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-308fbb08-4ab8-4e67-9b29-592e93fb94fa\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-4da35fc9-c9e7-4960-aec9-797fe7d9051d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-523b5cd1-3e23-492f-a539-13118b6d1e3a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7fe3b40f-802b-4cdd-8bd4-fd799c948cc2\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-c25d9a16-bc35-4e15-a7e5-9db606bf9ed4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b0f33259-77d7-4c9e-aac6-3aabcfae693c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-037eea7a-bd0a-46c5-9a66-03aea78705d3\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-0725b4dd-7e76-479c-a735-68e7ee23d5ca\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-0820b7b9-23aa-4725-a1ce-ae4558f718e5\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2c89a2e5-7285-40fe-afe0-ae8654b92fab\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-358c20a6-3f9e-4f0e-97ff-c6ce485e2aac\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5744710e-cc2f-4ee8-8809-3b11e89f4bc9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ac4a19c2-fa67-49b4-8ae5-0b2e78c49457\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c9d007d0-c057-4772-b18c-01e546713bcd\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-d0793b48-0edc-4296-a390-4c75d1bdfd71\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-e372f825-a257-4fb8-9175-797a8a8627d6\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-d158790f-bfb0-486c-8631-2dc6b4e8e6af\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-e802a67a-daf5-4436-9ea6-f6d821dd0c5d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-a451c1ef-c6ca-483d-87ed-f49761e3ffb5\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftSql-servers-firewallRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftClassicNetwork-networkSecurityGroups-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-securityRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftClassicNetwork-networkSecurityGroups-securityRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ae89ebca-1c92-4898-ac2c-9f63decb045c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-d26f7642-7545-4e18-9b75-8c9bbdee3a9a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-1a4e592a-6a6e-44a5-9814-e36264ca96e7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7796937f-307b-4598-941c-67d3a05ebfe7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-c5447c04-a4d7-4ba8-a263-c9ee321a6858\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-41388f1c-2db0-4c25-95b2-35d7f5ccbfa9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b02aacc0-b073-424e-8298-42b22829ee0a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-057d6cfe-9c4f-4a6d-bc60-14420ea1f1a9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0ec47710-77ff-4a3d-9181-6aa50af424d0\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-48af4db5-9b8b-401c-8e74-076be876a430\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-82339799-d096-41ae-8538-b108becf0970\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1b7aa243-30e4-4c9e-bca8-d0d3022b634a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-bb91dfba-c30d-4263-9add-9c2384e659a6\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e71308d3-144b-4262-b144-efdc3cc90517\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2bdd0062-9d75-436e-89df-487dd8e4b3c7\" : { \n    \"value\" : \"Disabled\"\n    },\n    \"effect-4733ea7b-a883-42fe-8cac-97454c2a9e4a\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-67121cc7-ff39-4ab8-b7e3-95b84dab487d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-6fac406b-40ca-413b-bf8e-0bf964659c25\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-81e74cea-30fd-40d5-802f-d72103c2aaaa\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c349d81b-9985-44ae-a8da-ff98d108ede8\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-f4b53539-8df9-40e4-86c6-6b607703bd4e\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-ec068d99-e9c7-401f-8cef-5bdde4e6ccf1\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-048248b0-55cd-46da-b1ff-39efd52db260\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0d134df8-db83-46fb-ad72-fe0c9428c8dd\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2c89a2e5-7285-40fe-afe0-ae8654b92fb2\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-3657f5a0-770e-44a3-b44e-9431ba1e9735\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-617c02be-7f02-4efd-8836-3180d47b6c68\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-7d7be79c-23ba-4033-84dd-45e2a5ccdd67\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-87ba29ef-1ab3-4d82-b763-87fcd4f531f7\" : { \n    \"value\" : \"audit\"\n    },\n    \"effect-f7d52b2d-e161-4dfa-a82b-55e564167385\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c43e4a30-77cb-48ab-a4dd-93f175c63b57\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1f314764-cb73-4fc9-b863-8eca98ac36e9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-123a3936-f020-408a-ba0c-47873faf1534\" : { \n    \"value\" : \"AuditIfNotExists\"\n    }\n}\n', '<LAWORKSPACE>', reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName')), '2021-06-01').customerId))))[variables('modifiedAssignment')].id]",
                "parameters": "[createObject('NIST', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f', 'parameters', json(replace('    {\n        \"listOfMembersToExcludeFromWindowsVMAdministratorsGroup\": \n        {\n        \"value\": \"admin\"\n        },\n        \"listOfMembersToIncludeInWindowsVMAdministratorsGroup\": \n        {\n        \"value\": \"azureuser\"\n        },\n        \"logAnalyticsWorkspaceIdforVMReporting\": \n        {\n        \"value\": \"<LAWORKSPACE>\"\n        },\n        \"IncludeArcMachines\": \n        {\n            \"value\": \"true\"\n        },\n        \"MinimumTLSVersion-5752e6d6-1206-46d8-8ab1-ecc2f71a8112\": \n        {\n            \"value\": \"1.2\"\n        },\n        \"NotAvailableMachineState-bed48b13-6647-468e-aa2f-1af1d3f4dd40\": \n        {\n            \"value\": \"Compliant\"\n        },\n        \"requiredRetentionDays\": \n        {\n            \"value\": \"365\"\n        },\n        \"resourceGroupName-b6e2945c-0b7b-40f5-9233-7a5323b5cdc6\": \n        {\n            \"value\": \"NetworkWatcherRG\"\n        }\n    }', '<LAWORKSPACE>', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))))), 'IL5', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/f9a961fa-3241-4b20-adc4-bbf8ad9d7197', 'parameters', json(replace('{\n    \"IncludeArcMachines\" : { \n        \"value\" : \"false\"\n        },\n        \"NotAvailableMachineState-bed48b13-6647-468e-aa2f-1af1d3f4dd40\" : { \n        \"value\" : \"Compliant\"\n        },\n        \"MinimumTLSVersionForWindowsServers\" : { \n        \"value\" : \"1.2\"\n        },\n        \"requiredRetentionDays\" : { \n        \"value\" : \"365\"\n        },\n        \"effect-febd0533-8e55-448f-b837-bd0e06f16469\" : { \n        \"value\" : \"audit\"\n        },\n        \"allowedContainerImagesRegex-febd0533-8e55-448f-b837-bd0e06f16469\" : { \n        \"value\" : \"^(.+){0}$\"\n        },\n        \"effect-95edb821-ddaf-4404-9732-666045e056b4\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-440b515e-a580-421e-abeb-b159a61ddcbc\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-233a2a17-77ca-4fb1-9b6b-69223d272a44\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"audit\"\n        },\n        \"cpuLimit-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"0\"\n        },\n        \"memoryLimit-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"0\"\n        },\n        \"effect-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"audit\"\n        },\n        \"runAsUserRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"MustRunAsNonRoot\"\n        },\n        \"runAsGroupRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"supplementalGroupsRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"fsGroupRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"effect-1c6e92c9-99f0-4e55-9cf2-0c234dc48f99\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-df49d893-a74c-421d-bc95-c663042e5b80\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-c26596ff-4d70-4e6a-9a30-c2506bd2f80c\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-511f5417-5d12-434d-ab2e-816901e72a5e\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-82985f06-dc18-4a48-bc1c-b9f4f0098cfe\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-098fc59e-46c7-4d99-9b16-64990e543d75\" : { \n        \"value\" : \"audit\"\n        },\n        \"NetworkWatcherResourceGroupName\" : { \n        \"value\" : \"NetworkWatcherRG\"\n        },\n        \"setting-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n        \"value\" : \"enabled\"\n        },\n        \"aadAuthenticationInServiceFabricMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-71ef260a-8f18-47b7-abcb-62d0673d94dc\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-055aa869-bc98-4af8-bafc-23f1ab6ffe2c\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-564feb30-bf6a-4854-b4bb-0d2d2d1e6c66\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-d9da03a1-f3c3-412a-9709-947156872263\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-617c02be-7f02-4efd-8836-3180d47b6c68\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ec068d99-e9c7-401f-8cef-5bdde4e6ccf1\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-c349d81b-9985-44ae-a8da-ff98d108ede8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-3657f5a0-770e-44a3-b44e-9431ba1e9735\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-b4ac1030-89c5-4697-8e00-28b5ba6a8811\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-ea0dfaed-95fb-448c-934e-d6e713ce393d\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-4733ea7b-a883-42fe-8cac-97454c2a9e4a\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-f4b53539-8df9-40e4-86c6-6b607703bd4e\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-41425d9f-d1a5-499a-9932-f8ed8453932c\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-fc4d8e41-e223-45ea-9bf5-eada37891d87\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-86efb160-8de7-451d-bc08-5d475b0aadae\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-4ec52d6d-beb7-40c4-9a9e-fe753254690e\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-64d314f6-6062-4780-a861-c23e8951bee5\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1fd32ebd-e4c3-4e13-a54a-d7422d4d95f6\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-fa298e57-9444-42ba-bf04-86e8470e32c7\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-67121cc7-ff39-4ab8-b7e3-95b84dab487d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1f905d99-2ab7-462c-a6b0-f709acca6c8f\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ba769a63-b8cc-4b2d-abf6-ac33c7204be8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-81e74cea-30fd-40d5-802f-d72103c2aaaa\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0aa61e00-0a01-4a3c-9945-e93cffedf0e6\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-47031206-ce96-41f8-861b-6a915f3de284\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-87ba29ef-1ab3-4d82-b763-87fcd4f531f7\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-51522a96-0869-4791-82f3-981000c2c67f\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-b5ec538c-daa0-4006-8596-35468b9148e8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-56a5ee18-2ae6-4810-86f7-18e39ce5629b\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-2e94d99a-8a36-4563-bc77-810d8893b671\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1fafeaf6-7927-4059-a50a-8eb2a7a6f2b5\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-99e9ccd8-3db9-4592-b0d1-14b1715a4d8a\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1f68a601-6e6d-4e42-babf-3f643a047ea2\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-f7d52b2d-e161-4dfa-a82b-55e564167385\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-7d7be79c-23ba-4033-84dd-45e2a5ccdd67\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ca91455f-eace-4f96-be59-e6e2c35b4816\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-702dd420-7fcc-42c5-afe8-4026edd20fe0\" : { \n        \"value\" : \"Audit\"\n        },\n        \"diagnosticsLogsInRedisCacheMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"secureTransferToStorageAccountMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-d0793b48-0edc-4296-a390-4c75d1bdfd71\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-7d092e0a-7acd-40d2-a975-dca21cae48c4\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-2a1a9cdf-e04d-429a-8416-3bfb72a1b26f\" : { \n        \"value\" : \"Audit\"\n        },\n        \"disableUnrestrictedNetworkToStorageAccountMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-55615ac9-af46-4a59-874e-391cc3dfb490\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1b8ca024-1d5c-4dec-8995-b1a932b41780\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-037eea7a-bd0a-46c5-9a66-03aea78705d3\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-53503636-bcc9-4748-9663-5348217f160f\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-40cec1dd-a100-4920-b15b-3024fe8901ab\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0725b4dd-7e76-479c-a735-68e7ee23d5ca\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-a049bf77-880b-470f-ba6d-9f21c530cf83\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ee980b6d-0eca-4501-8d54-f6290fd512c3\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1d84d5fb-01f6-4d12-ba4f-4a26081d403d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-37e0d2fe-28a5-43d6-a273-67d37d1f5606\" : { \n        \"value\" : \"Audit\"\n        },\n        \"identityDesignateMoreThanOneOwnerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"diskEncryptionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"emailNotificationToSubscriptionOwnerHighSeverityAlertsEnabledEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlDbEncryptionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vulnerabilityAssessmentOnManagedInstanceMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePHPVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"aadAuthenticationInSqlServerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vmssEndpointProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vmssOsVulnerabilitiesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"adaptiveApplicationControlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"geoRedundantBackupShouldBeEnabledForAzureDatabaseForPostgreSQLEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"ensureJavaVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityDesignateLessThanOwnersMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"securityContactEmailAddressForSubscriptionEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppRestrictCORSAccessMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveDeprecatedAccountMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"ensurePythonVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePythonVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePHPVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePythonVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"geoRedundantBackupShouldBeEnabledForAzureDatabaseForMySQLEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"systemUpdatesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureJavaVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForWritePermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureJavaVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"nextGenerationFirewallMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"useRbacRulesMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"webAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"sqlServerAuditingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vnetEnableDDoSProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlServerAdvancedDataSecurityMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"endpointProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"jitNetworkAccessMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"geoRedundantStorageShouldBeEnabledForStorageAccountsEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"vmssSystemUpdatesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"longtermGeoRedundantBackupEnabledAzureSQLDatabasesEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"systemConfigurationsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForReadPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"containerBenchmarkMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vulnerabilityAssessmentOnServerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"kubernetesServiceVersionUpToDateMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"sqlDbVulnerabilityAssesmentMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"membersToIncludeInLocalAdministratorsGroup\" : { \n        \"value\" : \"\"\n        },\n        \"membersToExcludeInLocalAdministratorsGroup\" : { \n        \"value\" : \"\"\n        },\n        \"logAnalyticsWorkspaceIDForVMAgents\" : { \n        \"value\" : \"<LAWORKSPACE>\"\n        },\n        \"PHPLatestVersionForAppServices\" : { \n        \"value\" : \"7.4\"\n        },\n        \"JavaLatestVersionForAppServices\" : { \n        \"value\" : \"11\"\n        },\n        \"WindowsPythonLatestVersionForAppServices\" : { \n        \"value\" : \"3.6\"\n        },\n        \"LinuxPythonLatestVersionForAppServices\" : { \n        \"value\" : \"3.9\"\n        },\n        \"ensureDotNetFrameworkLatestForFunctionAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityEmailsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"vulnerabilityAssessmentMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensureDotNetFrameworkLatestForWebAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlServerAdvancedDataSecurityEmailsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"microsoftIaaSAntimalwareExtensionShouldBeDeployedOnWindowsServersEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"securityCenterStandardPricingTierShouldBeSelectedEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"theLogAnalyticsAgentShouldBeInstalledOnVirtualMachinesEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensurePHPVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityEmailAdminsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"securityContactPhoneNumberShouldBeProvidedForSubscriptionEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"threatDetectionTypesOnManagedInstanceMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensureDotNetFrameworkLatestForAPIAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlServerAdvancedDataSecurityEmailAdminsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"threatDetectionTypesOnServerMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"theLogAnalyticsAgentShouldBeInstalledOnVirtualMachineScaleSetsEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        }\n}', '<LAWORKSPACE>', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))))), 'CMMC', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/b5629c75-5c77-4422-87b9-2509e680f8de', 'parameters', json(replace('{\n    \"logAnalyticsWorkspaceId-f47b5582-33ec-4c5c-87c0-b010a6b2e917\" : { \n        \"value\" : \"<LAWORKSPACE>\"\n    },\n    \"effect-09024ccc-0c5f-475e-9457-b7c0d9ed487b\" : { \n        \"value\" : \"AuditIfNotExists\"\n    },\n    \"MembersToExclude-69bf4abd-ca1e-4cf6-8b5a-762d42e61d4f\" :{\n        \"value\": \"\"\n    },\n    \"MembersToInclude-30f71ea1-ac77-4f26-9fc5-2d926bbd4ba7\": {\n        \"value\": \"\"\n    },\n    \"effect-0961003e-5a0a-4549-abde-af6a37f2724d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0b15565f-aa9e-48ba-8619-45960f2c314d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0e60b895-3786-45da-8377-9c6b4b6ac5f9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-17k78e20-9358-41c9-923c-fb736d382a12\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-1bc1795e-d44a-4d48-9b3b-6fff0fd5f9ba\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"PHPLatestVersion\" : { \n    \"value\" : \"7.3\"\n    },\n    \"effect-22bee202-a82f-4305-9a2a-6d7f44d4dedb\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-26a828e1-e88f-464e-bbb3-c134a282b9de\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-34c877ad-507e-4c82-993e-3452a6e0ad3c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-404c3081-a854-4457-ae30-26a93ef643f9\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-47a6b606-51aa-4496-8bb7-64b11cf66adc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-496223c3-ad65-4ecd-878a-bae78737e9ed\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"JavaLatestVersion\" : { \n    \"value\" : \"11\"\n    },\n    \"effect-4f11b553-d42e-4e3a-89be-32ca364cad4c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5c607a2e-c700-4744-8254-d77e7c9eb5e4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5f76cf89-fbf2-47fd-a3f4-b891fa780b60\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6b1cbf55-e8b6-442f-ba4c-7246b6381474\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-7008174a-fd10-4ef0-817e-fc820a951d73\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"LinuxPythonLatestVersion\" : { \n    \"value\" : \"3.8\"\n    },\n    \"effect-7238174a-fd10-4ef0-817e-fc820a951d73\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7261b898-8a84-4db8-9e04-18527132abb3\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-74c3584d-afae-46f7-a20a-6f8adba71a16\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-86b3d65f-7626-441e-b690-81a8b71cff60\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-88999f4c-376a-45c8-bcb3-4058f713cf39\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-8c122334-9d20-4eb8-89ea-ac9a705b74ae\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9297c21d-2ed6-4474-b48f-163f75654ce3\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-991310cd-e9f3-47bc-b7b6-f57b557d07db\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9b597639-28e4-48eb-b506-56b05d366257\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9d0b6ea4-93e2-4578-bf2f-6bb17d22b4bc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9daedab3-fb2d-461e-b861-71790eead4f6\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-a4af4a39-4135-47fb-b175-47fbdf85311d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"setting-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n    \"value\" : \"enabled\"\n    },\n    \"effect-a70ca396-0a34-413a-88e1-b956c1e683be\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-aa633080-8b72-40c4-a2d7-d00c03e80bed\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-af6cd1bd-1635-48cb-bde7-5b15693900b9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"resourceGroupName-b6e2945c-0b7b-40f5-9233-7a5323b5cdc6\" : { \n    \"value\" : \"NetworkWatcherRG\"\n    },\n    \"effect-b7ddfbdc-1260-477d-91fd-98bd9be789a6\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c3f317a7-a95c-4547-b7e7-11017ebdf2fe\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-cb510bfd-1cba-4d9f-a230-cb0976f4bb71\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e2c1c086-2d84-4019-bff3-c44ccd95113c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e3576e28-8b17-4677-84c3-db2990658d64\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e8cbc669-f12d-49eb-93e7-9273119e9933\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e9c8d085-d9cc-4b17-9cdc-059f1f01f19e\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ebb62a0c-3560-49e1-89ed-27e074e9f8ad\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-efbde977-ba53-4479-b8e9-10b957924fbf\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f6de0be7-9a8a-4b8a-b349-43cf02d22f7c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f8456c1c-aa66-4dfb-861a-25d127b775c9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f9d614c5-c173-4d56-95a7-b4437057d193\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-fb893a29-21bb-418c-a157-e99480ec364c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-feedbf84-6b99-488c-acc2-71c829aa5ffc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-3b980d31-7904-4bb7-8575-5665739a8052\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6e2593d9-add6-4083-9c9b-4b7d2188c899\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-12430be1-6cc8-4527-a9a8-e3d38f250096\" : { \n    \"value\" : \"Audit\"\n    },\n    \"modeRequirement-12430be1-6cc8-4527-a9a8-e3d38f250096\" : { \n    \"value\" : \"Detection\"\n    },\n    \"effect-425bea59-a659-4cbb-8d31-34499bd030b8\" : { \n    \"value\" : \"Audit\"\n    },\n    \"modeRequirement-425bea59-a659-4cbb-8d31-34499bd030b8\" : { \n    \"value\" : \"Detection\"\n    },\n    \"effect-564feb30-bf6a-4854-b4bb-0d2d2d1e6c66\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-055aa869-bc98-4af8-bafc-23f1ab6ffe2c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-013e242c-8828-4970-87b3-ab247555486d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-d38fc420-0735-4ef3-ac11-c806f651a570\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-a1181c5f-672a-477a-979a-7d58aa086233\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-308fbb08-4ab8-4e67-9b29-592e93fb94fa\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-4da35fc9-c9e7-4960-aec9-797fe7d9051d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-523b5cd1-3e23-492f-a539-13118b6d1e3a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7fe3b40f-802b-4cdd-8bd4-fd799c948cc2\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-c25d9a16-bc35-4e15-a7e5-9db606bf9ed4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b0f33259-77d7-4c9e-aac6-3aabcfae693c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-037eea7a-bd0a-46c5-9a66-03aea78705d3\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-0725b4dd-7e76-479c-a735-68e7ee23d5ca\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-0820b7b9-23aa-4725-a1ce-ae4558f718e5\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2c89a2e5-7285-40fe-afe0-ae8654b92fab\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-358c20a6-3f9e-4f0e-97ff-c6ce485e2aac\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5744710e-cc2f-4ee8-8809-3b11e89f4bc9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ac4a19c2-fa67-49b4-8ae5-0b2e78c49457\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c9d007d0-c057-4772-b18c-01e546713bcd\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-d0793b48-0edc-4296-a390-4c75d1bdfd71\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-e372f825-a257-4fb8-9175-797a8a8627d6\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-d158790f-bfb0-486c-8631-2dc6b4e8e6af\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-e802a67a-daf5-4436-9ea6-f6d821dd0c5d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-a451c1ef-c6ca-483d-87ed-f49761e3ffb5\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftSql-servers-firewallRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftClassicNetwork-networkSecurityGroups-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-securityRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftClassicNetwork-networkSecurityGroups-securityRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ae89ebca-1c92-4898-ac2c-9f63decb045c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-d26f7642-7545-4e18-9b75-8c9bbdee3a9a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-1a4e592a-6a6e-44a5-9814-e36264ca96e7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7796937f-307b-4598-941c-67d3a05ebfe7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-c5447c04-a4d7-4ba8-a263-c9ee321a6858\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-41388f1c-2db0-4c25-95b2-35d7f5ccbfa9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b02aacc0-b073-424e-8298-42b22829ee0a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-057d6cfe-9c4f-4a6d-bc60-14420ea1f1a9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0ec47710-77ff-4a3d-9181-6aa50af424d0\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-48af4db5-9b8b-401c-8e74-076be876a430\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-82339799-d096-41ae-8538-b108becf0970\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1b7aa243-30e4-4c9e-bca8-d0d3022b634a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-bb91dfba-c30d-4263-9add-9c2384e659a6\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e71308d3-144b-4262-b144-efdc3cc90517\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2bdd0062-9d75-436e-89df-487dd8e4b3c7\" : { \n    \"value\" : \"Disabled\"\n    },\n    \"effect-4733ea7b-a883-42fe-8cac-97454c2a9e4a\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-67121cc7-ff39-4ab8-b7e3-95b84dab487d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-6fac406b-40ca-413b-bf8e-0bf964659c25\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-81e74cea-30fd-40d5-802f-d72103c2aaaa\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c349d81b-9985-44ae-a8da-ff98d108ede8\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-f4b53539-8df9-40e4-86c6-6b607703bd4e\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-ec068d99-e9c7-401f-8cef-5bdde4e6ccf1\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-048248b0-55cd-46da-b1ff-39efd52db260\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0d134df8-db83-46fb-ad72-fe0c9428c8dd\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2c89a2e5-7285-40fe-afe0-ae8654b92fb2\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-3657f5a0-770e-44a3-b44e-9431ba1e9735\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-617c02be-7f02-4efd-8836-3180d47b6c68\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-7d7be79c-23ba-4033-84dd-45e2a5ccdd67\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-87ba29ef-1ab3-4d82-b763-87fcd4f531f7\" : { \n    \"value\" : \"audit\"\n    },\n    \"effect-f7d52b2d-e161-4dfa-a82b-55e564167385\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c43e4a30-77cb-48ab-a4dd-93f175c63b57\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1f314764-cb73-4fc9-b863-8eca98ac36e9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-123a3936-f020-408a-ba0c-47873faf1534\" : { \n    \"value\" : \"AuditIfNotExists\"\n    }\n}\n', '<LAWORKSPACE>', reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName')), '2021-06-01').customerId))))[variables('modifiedAssignment')].parameters]"
              },
              "identity": {
                "type": "SystemAssigned"
              }
            }
          ]
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc')))]",
        "[subscriptionResourceId(parameters('operationsSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-operations-rg-{0}', parameters('nowUtc')))]"
      ]
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "[format('assign-policy-{0}', parameters('operationsResourceGroupName'))]",
      "subscriptionId": "[parameters('operationsSubscriptionId')]",
      "resourceGroup": "[parameters('operationsResourceGroupName')]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "builtInAssignment": {
            "value": "[parameters('policy')]"
          },
          "logAnalyticsWorkspaceName": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value]"
          },
          "logAnalyticsWorkspaceResourceGroupName": {
            "value": "[reference(subscriptionResourceId(parameters('operationsSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-operations-rg-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value]"
          },
          "operationsSubscriptionId": {
            "value": "[parameters('operationsSubscriptionId')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "3675806177489000536"
            }
          },
          "parameters": {
            "builtInAssignment": {
              "type": "string",
              "defaultValue": ""
            },
            "logAnalyticsWorkspaceName": {
              "type": "string"
            },
            "logAnalyticsWorkspaceResourceGroupName": {
              "type": "string"
            },
            "operationsSubscriptionId": {
              "type": "string"
            }
          },
          "functions": [],
          "variables": {
            "modifiedAssignment": "[if(and(equals(toLower(environment().name), toLower('AzureCloud')), equals(toLower(parameters('builtInAssignment')), toLower('IL5'))), 'NIST', parameters('builtInAssignment'))]",
            "assignmentName": "[format('{0} {1}', variables('modifiedAssignment'), resourceGroup().name)]"
          },
          "resources": [
            {
              "condition": "[not(empty(variables('modifiedAssignment')))]",
              "type": "Microsoft.Authorization/policyAssignments",
              "apiVersion": "2020-09-01",
              "name": "[variables('assignmentName')]",
              "location": "[resourceGroup().location]",
              "properties": {
                "policyDefinitionId": "[createObject('NIST', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f', 'parameters', json(replace('    {\n        \"listOfMembersToExcludeFromWindowsVMAdministratorsGroup\": \n        {\n        \"value\": \"admin\"\n        },\n        \"listOfMembersToIncludeInWindowsVMAdministratorsGroup\": \n        {\n        \"value\": \"azureuser\"\n        },\n        \"logAnalyticsWorkspaceIdforVMReporting\": \n        {\n        \"value\": \"<LAWORKSPACE>\"\n        },\n        \"IncludeArcMachines\": \n        {\n            \"value\": \"true\"\n        },\n        \"MinimumTLSVersion-5752e6d6-1206-46d8-8ab1-ecc2f71a8112\": \n        {\n            \"value\": \"1.2\"\n        },\n        \"NotAvailableMachineState-bed48b13-6647-468e-aa2f-1af1d3f4dd40\": \n        {\n            \"value\": \"Compliant\"\n        },\n        \"requiredRetentionDays\": \n        {\n            \"value\": \"365\"\n        },\n        \"resourceGroupName-b6e2945c-0b7b-40f5-9233-7a5323b5cdc6\": \n        {\n            \"value\": \"NetworkWatcherRG\"\n        }\n    }', '<LAWORKSPACE>', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))))), 'IL5', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/f9a961fa-3241-4b20-adc4-bbf8ad9d7197', 'parameters', json(replace('{\n    \"IncludeArcMachines\" : { \n        \"value\" : \"false\"\n        },\n        \"NotAvailableMachineState-bed48b13-6647-468e-aa2f-1af1d3f4dd40\" : { \n        \"value\" : \"Compliant\"\n        },\n        \"MinimumTLSVersionForWindowsServers\" : { \n        \"value\" : \"1.2\"\n        },\n        \"requiredRetentionDays\" : { \n        \"value\" : \"365\"\n        },\n        \"effect-febd0533-8e55-448f-b837-bd0e06f16469\" : { \n        \"value\" : \"audit\"\n        },\n        \"allowedContainerImagesRegex-febd0533-8e55-448f-b837-bd0e06f16469\" : { \n        \"value\" : \"^(.+){0}$\"\n        },\n        \"effect-95edb821-ddaf-4404-9732-666045e056b4\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-440b515e-a580-421e-abeb-b159a61ddcbc\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-233a2a17-77ca-4fb1-9b6b-69223d272a44\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"audit\"\n        },\n        \"cpuLimit-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"0\"\n        },\n        \"memoryLimit-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"0\"\n        },\n        \"effect-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"audit\"\n        },\n        \"runAsUserRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"MustRunAsNonRoot\"\n        },\n        \"runAsGroupRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"supplementalGroupsRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"fsGroupRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"effect-1c6e92c9-99f0-4e55-9cf2-0c234dc48f99\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-df49d893-a74c-421d-bc95-c663042e5b80\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-c26596ff-4d70-4e6a-9a30-c2506bd2f80c\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-511f5417-5d12-434d-ab2e-816901e72a5e\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-82985f06-dc18-4a48-bc1c-b9f4f0098cfe\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-098fc59e-46c7-4d99-9b16-64990e543d75\" : { \n        \"value\" : \"audit\"\n        },\n        \"NetworkWatcherResourceGroupName\" : { \n        \"value\" : \"NetworkWatcherRG\"\n        },\n        \"setting-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n        \"value\" : \"enabled\"\n        },\n        \"aadAuthenticationInServiceFabricMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-71ef260a-8f18-47b7-abcb-62d0673d94dc\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-055aa869-bc98-4af8-bafc-23f1ab6ffe2c\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-564feb30-bf6a-4854-b4bb-0d2d2d1e6c66\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-d9da03a1-f3c3-412a-9709-947156872263\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-617c02be-7f02-4efd-8836-3180d47b6c68\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ec068d99-e9c7-401f-8cef-5bdde4e6ccf1\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-c349d81b-9985-44ae-a8da-ff98d108ede8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-3657f5a0-770e-44a3-b44e-9431ba1e9735\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-b4ac1030-89c5-4697-8e00-28b5ba6a8811\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-ea0dfaed-95fb-448c-934e-d6e713ce393d\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-4733ea7b-a883-42fe-8cac-97454c2a9e4a\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-f4b53539-8df9-40e4-86c6-6b607703bd4e\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-41425d9f-d1a5-499a-9932-f8ed8453932c\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-fc4d8e41-e223-45ea-9bf5-eada37891d87\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-86efb160-8de7-451d-bc08-5d475b0aadae\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-4ec52d6d-beb7-40c4-9a9e-fe753254690e\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-64d314f6-6062-4780-a861-c23e8951bee5\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1fd32ebd-e4c3-4e13-a54a-d7422d4d95f6\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-fa298e57-9444-42ba-bf04-86e8470e32c7\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-67121cc7-ff39-4ab8-b7e3-95b84dab487d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1f905d99-2ab7-462c-a6b0-f709acca6c8f\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ba769a63-b8cc-4b2d-abf6-ac33c7204be8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-81e74cea-30fd-40d5-802f-d72103c2aaaa\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0aa61e00-0a01-4a3c-9945-e93cffedf0e6\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-47031206-ce96-41f8-861b-6a915f3de284\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-87ba29ef-1ab3-4d82-b763-87fcd4f531f7\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-51522a96-0869-4791-82f3-981000c2c67f\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-b5ec538c-daa0-4006-8596-35468b9148e8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-56a5ee18-2ae6-4810-86f7-18e39ce5629b\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-2e94d99a-8a36-4563-bc77-810d8893b671\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1fafeaf6-7927-4059-a50a-8eb2a7a6f2b5\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-99e9ccd8-3db9-4592-b0d1-14b1715a4d8a\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1f68a601-6e6d-4e42-babf-3f643a047ea2\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-f7d52b2d-e161-4dfa-a82b-55e564167385\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-7d7be79c-23ba-4033-84dd-45e2a5ccdd67\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ca91455f-eace-4f96-be59-e6e2c35b4816\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-702dd420-7fcc-42c5-afe8-4026edd20fe0\" : { \n        \"value\" : \"Audit\"\n        },\n        \"diagnosticsLogsInRedisCacheMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"secureTransferToStorageAccountMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-d0793b48-0edc-4296-a390-4c75d1bdfd71\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-7d092e0a-7acd-40d2-a975-dca21cae48c4\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-2a1a9cdf-e04d-429a-8416-3bfb72a1b26f\" : { \n        \"value\" : \"Audit\"\n        },\n        \"disableUnrestrictedNetworkToStorageAccountMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-55615ac9-af46-4a59-874e-391cc3dfb490\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1b8ca024-1d5c-4dec-8995-b1a932b41780\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-037eea7a-bd0a-46c5-9a66-03aea78705d3\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-53503636-bcc9-4748-9663-5348217f160f\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-40cec1dd-a100-4920-b15b-3024fe8901ab\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0725b4dd-7e76-479c-a735-68e7ee23d5ca\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-a049bf77-880b-470f-ba6d-9f21c530cf83\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ee980b6d-0eca-4501-8d54-f6290fd512c3\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1d84d5fb-01f6-4d12-ba4f-4a26081d403d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-37e0d2fe-28a5-43d6-a273-67d37d1f5606\" : { \n        \"value\" : \"Audit\"\n        },\n        \"identityDesignateMoreThanOneOwnerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"diskEncryptionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"emailNotificationToSubscriptionOwnerHighSeverityAlertsEnabledEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlDbEncryptionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vulnerabilityAssessmentOnManagedInstanceMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePHPVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"aadAuthenticationInSqlServerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vmssEndpointProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vmssOsVulnerabilitiesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"adaptiveApplicationControlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"geoRedundantBackupShouldBeEnabledForAzureDatabaseForPostgreSQLEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"ensureJavaVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityDesignateLessThanOwnersMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"securityContactEmailAddressForSubscriptionEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppRestrictCORSAccessMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveDeprecatedAccountMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"ensurePythonVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePythonVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePHPVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePythonVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"geoRedundantBackupShouldBeEnabledForAzureDatabaseForMySQLEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"systemUpdatesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureJavaVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForWritePermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureJavaVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"nextGenerationFirewallMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"useRbacRulesMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"webAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"sqlServerAuditingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vnetEnableDDoSProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlServerAdvancedDataSecurityMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"endpointProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"jitNetworkAccessMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"geoRedundantStorageShouldBeEnabledForStorageAccountsEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"vmssSystemUpdatesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"longtermGeoRedundantBackupEnabledAzureSQLDatabasesEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"systemConfigurationsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForReadPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"containerBenchmarkMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vulnerabilityAssessmentOnServerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"kubernetesServiceVersionUpToDateMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"sqlDbVulnerabilityAssesmentMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"membersToIncludeInLocalAdministratorsGroup\" : { \n        \"value\" : \"\"\n        },\n        \"membersToExcludeInLocalAdministratorsGroup\" : { \n        \"value\" : \"\"\n        },\n        \"logAnalyticsWorkspaceIDForVMAgents\" : { \n        \"value\" : \"<LAWORKSPACE>\"\n        },\n        \"PHPLatestVersionForAppServices\" : { \n        \"value\" : \"7.4\"\n        },\n        \"JavaLatestVersionForAppServices\" : { \n        \"value\" : \"11\"\n        },\n        \"WindowsPythonLatestVersionForAppServices\" : { \n        \"value\" : \"3.6\"\n        },\n        \"LinuxPythonLatestVersionForAppServices\" : { \n        \"value\" : \"3.9\"\n        },\n        \"ensureDotNetFrameworkLatestForFunctionAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityEmailsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"vulnerabilityAssessmentMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensureDotNetFrameworkLatestForWebAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlServerAdvancedDataSecurityEmailsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"microsoftIaaSAntimalwareExtensionShouldBeDeployedOnWindowsServersEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"securityCenterStandardPricingTierShouldBeSelectedEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"theLogAnalyticsAgentShouldBeInstalledOnVirtualMachinesEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensurePHPVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityEmailAdminsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"securityContactPhoneNumberShouldBeProvidedForSubscriptionEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"threatDetectionTypesOnManagedInstanceMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensureDotNetFrameworkLatestForAPIAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlServerAdvancedDataSecurityEmailAdminsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"threatDetectionTypesOnServerMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"theLogAnalyticsAgentShouldBeInstalledOnVirtualMachineScaleSetsEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        }\n}', '<LAWORKSPACE>', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))))), 'CMMC', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/b5629c75-5c77-4422-87b9-2509e680f8de', 'parameters', json(replace('{\n    \"logAnalyticsWorkspaceId-f47b5582-33ec-4c5c-87c0-b010a6b2e917\" : { \n        \"value\" : \"<LAWORKSPACE>\"\n    },\n    \"effect-09024ccc-0c5f-475e-9457-b7c0d9ed487b\" : { \n        \"value\" : \"AuditIfNotExists\"\n    },\n    \"MembersToExclude-69bf4abd-ca1e-4cf6-8b5a-762d42e61d4f\" :{\n        \"value\": \"\"\n    },\n    \"MembersToInclude-30f71ea1-ac77-4f26-9fc5-2d926bbd4ba7\": {\n        \"value\": \"\"\n    },\n    \"effect-0961003e-5a0a-4549-abde-af6a37f2724d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0b15565f-aa9e-48ba-8619-45960f2c314d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0e60b895-3786-45da-8377-9c6b4b6ac5f9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-17k78e20-9358-41c9-923c-fb736d382a12\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-1bc1795e-d44a-4d48-9b3b-6fff0fd5f9ba\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"PHPLatestVersion\" : { \n    \"value\" : \"7.3\"\n    },\n    \"effect-22bee202-a82f-4305-9a2a-6d7f44d4dedb\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-26a828e1-e88f-464e-bbb3-c134a282b9de\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-34c877ad-507e-4c82-993e-3452a6e0ad3c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-404c3081-a854-4457-ae30-26a93ef643f9\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-47a6b606-51aa-4496-8bb7-64b11cf66adc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-496223c3-ad65-4ecd-878a-bae78737e9ed\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"JavaLatestVersion\" : { \n    \"value\" : \"11\"\n    },\n    \"effect-4f11b553-d42e-4e3a-89be-32ca364cad4c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5c607a2e-c700-4744-8254-d77e7c9eb5e4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5f76cf89-fbf2-47fd-a3f4-b891fa780b60\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6b1cbf55-e8b6-442f-ba4c-7246b6381474\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-7008174a-fd10-4ef0-817e-fc820a951d73\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"LinuxPythonLatestVersion\" : { \n    \"value\" : \"3.8\"\n    },\n    \"effect-7238174a-fd10-4ef0-817e-fc820a951d73\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7261b898-8a84-4db8-9e04-18527132abb3\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-74c3584d-afae-46f7-a20a-6f8adba71a16\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-86b3d65f-7626-441e-b690-81a8b71cff60\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-88999f4c-376a-45c8-bcb3-4058f713cf39\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-8c122334-9d20-4eb8-89ea-ac9a705b74ae\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9297c21d-2ed6-4474-b48f-163f75654ce3\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-991310cd-e9f3-47bc-b7b6-f57b557d07db\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9b597639-28e4-48eb-b506-56b05d366257\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9d0b6ea4-93e2-4578-bf2f-6bb17d22b4bc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9daedab3-fb2d-461e-b861-71790eead4f6\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-a4af4a39-4135-47fb-b175-47fbdf85311d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"setting-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n    \"value\" : \"enabled\"\n    },\n    \"effect-a70ca396-0a34-413a-88e1-b956c1e683be\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-aa633080-8b72-40c4-a2d7-d00c03e80bed\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-af6cd1bd-1635-48cb-bde7-5b15693900b9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"resourceGroupName-b6e2945c-0b7b-40f5-9233-7a5323b5cdc6\" : { \n    \"value\" : \"NetworkWatcherRG\"\n    },\n    \"effect-b7ddfbdc-1260-477d-91fd-98bd9be789a6\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c3f317a7-a95c-4547-b7e7-11017ebdf2fe\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-cb510bfd-1cba-4d9f-a230-cb0976f4bb71\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e2c1c086-2d84-4019-bff3-c44ccd95113c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e3576e28-8b17-4677-84c3-db2990658d64\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e8cbc669-f12d-49eb-93e7-9273119e9933\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e9c8d085-d9cc-4b17-9cdc-059f1f01f19e\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ebb62a0c-3560-49e1-89ed-27e074e9f8ad\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-efbde977-ba53-4479-b8e9-10b957924fbf\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f6de0be7-9a8a-4b8a-b349-43cf02d22f7c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f8456c1c-aa66-4dfb-861a-25d127b775c9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f9d614c5-c173-4d56-95a7-b4437057d193\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-fb893a29-21bb-418c-a157-e99480ec364c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-feedbf84-6b99-488c-acc2-71c829aa5ffc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-3b980d31-7904-4bb7-8575-5665739a8052\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6e2593d9-add6-4083-9c9b-4b7d2188c899\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-12430be1-6cc8-4527-a9a8-e3d38f250096\" : { \n    \"value\" : \"Audit\"\n    },\n    \"modeRequirement-12430be1-6cc8-4527-a9a8-e3d38f250096\" : { \n    \"value\" : \"Detection\"\n    },\n    \"effect-425bea59-a659-4cbb-8d31-34499bd030b8\" : { \n    \"value\" : \"Audit\"\n    },\n    \"modeRequirement-425bea59-a659-4cbb-8d31-34499bd030b8\" : { \n    \"value\" : \"Detection\"\n    },\n    \"effect-564feb30-bf6a-4854-b4bb-0d2d2d1e6c66\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-055aa869-bc98-4af8-bafc-23f1ab6ffe2c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-013e242c-8828-4970-87b3-ab247555486d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-d38fc420-0735-4ef3-ac11-c806f651a570\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-a1181c5f-672a-477a-979a-7d58aa086233\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-308fbb08-4ab8-4e67-9b29-592e93fb94fa\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-4da35fc9-c9e7-4960-aec9-797fe7d9051d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-523b5cd1-3e23-492f-a539-13118b6d1e3a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7fe3b40f-802b-4cdd-8bd4-fd799c948cc2\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-c25d9a16-bc35-4e15-a7e5-9db606bf9ed4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b0f33259-77d7-4c9e-aac6-3aabcfae693c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-037eea7a-bd0a-46c5-9a66-03aea78705d3\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-0725b4dd-7e76-479c-a735-68e7ee23d5ca\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-0820b7b9-23aa-4725-a1ce-ae4558f718e5\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2c89a2e5-7285-40fe-afe0-ae8654b92fab\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-358c20a6-3f9e-4f0e-97ff-c6ce485e2aac\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5744710e-cc2f-4ee8-8809-3b11e89f4bc9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ac4a19c2-fa67-49b4-8ae5-0b2e78c49457\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c9d007d0-c057-4772-b18c-01e546713bcd\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-d0793b48-0edc-4296-a390-4c75d1bdfd71\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-e372f825-a257-4fb8-9175-797a8a8627d6\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-d158790f-bfb0-486c-8631-2dc6b4e8e6af\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-e802a67a-daf5-4436-9ea6-f6d821dd0c5d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-a451c1ef-c6ca-483d-87ed-f49761e3ffb5\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftSql-servers-firewallRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftClassicNetwork-networkSecurityGroups-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-securityRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftClassicNetwork-networkSecurityGroups-securityRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ae89ebca-1c92-4898-ac2c-9f63decb045c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-d26f7642-7545-4e18-9b75-8c9bbdee3a9a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-1a4e592a-6a6e-44a5-9814-e36264ca96e7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7796937f-307b-4598-941c-67d3a05ebfe7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-c5447c04-a4d7-4ba8-a263-c9ee321a6858\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-41388f1c-2db0-4c25-95b2-35d7f5ccbfa9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b02aacc0-b073-424e-8298-42b22829ee0a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-057d6cfe-9c4f-4a6d-bc60-14420ea1f1a9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0ec47710-77ff-4a3d-9181-6aa50af424d0\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-48af4db5-9b8b-401c-8e74-076be876a430\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-82339799-d096-41ae-8538-b108becf0970\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1b7aa243-30e4-4c9e-bca8-d0d3022b634a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-bb91dfba-c30d-4263-9add-9c2384e659a6\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e71308d3-144b-4262-b144-efdc3cc90517\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2bdd0062-9d75-436e-89df-487dd8e4b3c7\" : { \n    \"value\" : \"Disabled\"\n    },\n    \"effect-4733ea7b-a883-42fe-8cac-97454c2a9e4a\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-67121cc7-ff39-4ab8-b7e3-95b84dab487d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-6fac406b-40ca-413b-bf8e-0bf964659c25\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-81e74cea-30fd-40d5-802f-d72103c2aaaa\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c349d81b-9985-44ae-a8da-ff98d108ede8\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-f4b53539-8df9-40e4-86c6-6b607703bd4e\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-ec068d99-e9c7-401f-8cef-5bdde4e6ccf1\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-048248b0-55cd-46da-b1ff-39efd52db260\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0d134df8-db83-46fb-ad72-fe0c9428c8dd\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2c89a2e5-7285-40fe-afe0-ae8654b92fb2\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-3657f5a0-770e-44a3-b44e-9431ba1e9735\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-617c02be-7f02-4efd-8836-3180d47b6c68\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-7d7be79c-23ba-4033-84dd-45e2a5ccdd67\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-87ba29ef-1ab3-4d82-b763-87fcd4f531f7\" : { \n    \"value\" : \"audit\"\n    },\n    \"effect-f7d52b2d-e161-4dfa-a82b-55e564167385\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c43e4a30-77cb-48ab-a4dd-93f175c63b57\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1f314764-cb73-4fc9-b863-8eca98ac36e9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-123a3936-f020-408a-ba0c-47873faf1534\" : { \n    \"value\" : \"AuditIfNotExists\"\n    }\n}\n', '<LAWORKSPACE>', reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName')), '2021-06-01').customerId))))[variables('modifiedAssignment')].id]",
                "parameters": "[createObject('NIST', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f', 'parameters', json(replace('    {\n        \"listOfMembersToExcludeFromWindowsVMAdministratorsGroup\": \n        {\n        \"value\": \"admin\"\n        },\n        \"listOfMembersToIncludeInWindowsVMAdministratorsGroup\": \n        {\n        \"value\": \"azureuser\"\n        },\n        \"logAnalyticsWorkspaceIdforVMReporting\": \n        {\n        \"value\": \"<LAWORKSPACE>\"\n        },\n        \"IncludeArcMachines\": \n        {\n            \"value\": \"true\"\n        },\n        \"MinimumTLSVersion-5752e6d6-1206-46d8-8ab1-ecc2f71a8112\": \n        {\n            \"value\": \"1.2\"\n        },\n        \"NotAvailableMachineState-bed48b13-6647-468e-aa2f-1af1d3f4dd40\": \n        {\n            \"value\": \"Compliant\"\n        },\n        \"requiredRetentionDays\": \n        {\n            \"value\": \"365\"\n        },\n        \"resourceGroupName-b6e2945c-0b7b-40f5-9233-7a5323b5cdc6\": \n        {\n            \"value\": \"NetworkWatcherRG\"\n        }\n    }', '<LAWORKSPACE>', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))))), 'IL5', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/f9a961fa-3241-4b20-adc4-bbf8ad9d7197', 'parameters', json(replace('{\n    \"IncludeArcMachines\" : { \n        \"value\" : \"false\"\n        },\n        \"NotAvailableMachineState-bed48b13-6647-468e-aa2f-1af1d3f4dd40\" : { \n        \"value\" : \"Compliant\"\n        },\n        \"MinimumTLSVersionForWindowsServers\" : { \n        \"value\" : \"1.2\"\n        },\n        \"requiredRetentionDays\" : { \n        \"value\" : \"365\"\n        },\n        \"effect-febd0533-8e55-448f-b837-bd0e06f16469\" : { \n        \"value\" : \"audit\"\n        },\n        \"allowedContainerImagesRegex-febd0533-8e55-448f-b837-bd0e06f16469\" : { \n        \"value\" : \"^(.+){0}$\"\n        },\n        \"effect-95edb821-ddaf-4404-9732-666045e056b4\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-440b515e-a580-421e-abeb-b159a61ddcbc\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-233a2a17-77ca-4fb1-9b6b-69223d272a44\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"audit\"\n        },\n        \"cpuLimit-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"0\"\n        },\n        \"memoryLimit-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"0\"\n        },\n        \"effect-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"audit\"\n        },\n        \"runAsUserRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"MustRunAsNonRoot\"\n        },\n        \"runAsGroupRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"supplementalGroupsRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"fsGroupRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"effect-1c6e92c9-99f0-4e55-9cf2-0c234dc48f99\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-df49d893-a74c-421d-bc95-c663042e5b80\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-c26596ff-4d70-4e6a-9a30-c2506bd2f80c\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-511f5417-5d12-434d-ab2e-816901e72a5e\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-82985f06-dc18-4a48-bc1c-b9f4f0098cfe\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-098fc59e-46c7-4d99-9b16-64990e543d75\" : { \n        \"value\" : \"audit\"\n        },\n        \"NetworkWatcherResourceGroupName\" : { \n        \"value\" : \"NetworkWatcherRG\"\n        },\n        \"setting-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n        \"value\" : \"enabled\"\n        },\n        \"aadAuthenticationInServiceFabricMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-71ef260a-8f18-47b7-abcb-62d0673d94dc\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-055aa869-bc98-4af8-bafc-23f1ab6ffe2c\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-564feb30-bf6a-4854-b4bb-0d2d2d1e6c66\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-d9da03a1-f3c3-412a-9709-947156872263\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-617c02be-7f02-4efd-8836-3180d47b6c68\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ec068d99-e9c7-401f-8cef-5bdde4e6ccf1\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-c349d81b-9985-44ae-a8da-ff98d108ede8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-3657f5a0-770e-44a3-b44e-9431ba1e9735\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-b4ac1030-89c5-4697-8e00-28b5ba6a8811\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-ea0dfaed-95fb-448c-934e-d6e713ce393d\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-4733ea7b-a883-42fe-8cac-97454c2a9e4a\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-f4b53539-8df9-40e4-86c6-6b607703bd4e\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-41425d9f-d1a5-499a-9932-f8ed8453932c\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-fc4d8e41-e223-45ea-9bf5-eada37891d87\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-86efb160-8de7-451d-bc08-5d475b0aadae\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-4ec52d6d-beb7-40c4-9a9e-fe753254690e\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-64d314f6-6062-4780-a861-c23e8951bee5\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1fd32ebd-e4c3-4e13-a54a-d7422d4d95f6\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-fa298e57-9444-42ba-bf04-86e8470e32c7\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-67121cc7-ff39-4ab8-b7e3-95b84dab487d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1f905d99-2ab7-462c-a6b0-f709acca6c8f\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ba769a63-b8cc-4b2d-abf6-ac33c7204be8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-81e74cea-30fd-40d5-802f-d72103c2aaaa\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0aa61e00-0a01-4a3c-9945-e93cffedf0e6\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-47031206-ce96-41f8-861b-6a915f3de284\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-87ba29ef-1ab3-4d82-b763-87fcd4f531f7\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-51522a96-0869-4791-82f3-981000c2c67f\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-b5ec538c-daa0-4006-8596-35468b9148e8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-56a5ee18-2ae6-4810-86f7-18e39ce5629b\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-2e94d99a-8a36-4563-bc77-810d8893b671\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1fafeaf6-7927-4059-a50a-8eb2a7a6f2b5\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-99e9ccd8-3db9-4592-b0d1-14b1715a4d8a\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1f68a601-6e6d-4e42-babf-3f643a047ea2\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-f7d52b2d-e161-4dfa-a82b-55e564167385\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-7d7be79c-23ba-4033-84dd-45e2a5ccdd67\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ca91455f-eace-4f96-be59-e6e2c35b4816\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-702dd420-7fcc-42c5-afe8-4026edd20fe0\" : { \n        \"value\" : \"Audit\"\n        },\n        \"diagnosticsLogsInRedisCacheMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"secureTransferToStorageAccountMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-d0793b48-0edc-4296-a390-4c75d1bdfd71\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-7d092e0a-7acd-40d2-a975-dca21cae48c4\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-2a1a9cdf-e04d-429a-8416-3bfb72a1b26f\" : { \n        \"value\" : \"Audit\"\n        },\n        \"disableUnrestrictedNetworkToStorageAccountMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-55615ac9-af46-4a59-874e-391cc3dfb490\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1b8ca024-1d5c-4dec-8995-b1a932b41780\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-037eea7a-bd0a-46c5-9a66-03aea78705d3\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-53503636-bcc9-4748-9663-5348217f160f\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-40cec1dd-a100-4920-b15b-3024fe8901ab\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0725b4dd-7e76-479c-a735-68e7ee23d5ca\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-a049bf77-880b-470f-ba6d-9f21c530cf83\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ee980b6d-0eca-4501-8d54-f6290fd512c3\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1d84d5fb-01f6-4d12-ba4f-4a26081d403d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-37e0d2fe-28a5-43d6-a273-67d37d1f5606\" : { \n        \"value\" : \"Audit\"\n        },\n        \"identityDesignateMoreThanOneOwnerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"diskEncryptionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"emailNotificationToSubscriptionOwnerHighSeverityAlertsEnabledEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlDbEncryptionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vulnerabilityAssessmentOnManagedInstanceMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePHPVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"aadAuthenticationInSqlServerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vmssEndpointProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vmssOsVulnerabilitiesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"adaptiveApplicationControlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"geoRedundantBackupShouldBeEnabledForAzureDatabaseForPostgreSQLEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"ensureJavaVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityDesignateLessThanOwnersMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"securityContactEmailAddressForSubscriptionEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppRestrictCORSAccessMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveDeprecatedAccountMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"ensurePythonVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePythonVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePHPVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePythonVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"geoRedundantBackupShouldBeEnabledForAzureDatabaseForMySQLEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"systemUpdatesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureJavaVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForWritePermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureJavaVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"nextGenerationFirewallMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"useRbacRulesMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"webAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"sqlServerAuditingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vnetEnableDDoSProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlServerAdvancedDataSecurityMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"endpointProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"jitNetworkAccessMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"geoRedundantStorageShouldBeEnabledForStorageAccountsEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"vmssSystemUpdatesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"longtermGeoRedundantBackupEnabledAzureSQLDatabasesEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"systemConfigurationsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForReadPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"containerBenchmarkMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vulnerabilityAssessmentOnServerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"kubernetesServiceVersionUpToDateMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"sqlDbVulnerabilityAssesmentMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"membersToIncludeInLocalAdministratorsGroup\" : { \n        \"value\" : \"\"\n        },\n        \"membersToExcludeInLocalAdministratorsGroup\" : { \n        \"value\" : \"\"\n        },\n        \"logAnalyticsWorkspaceIDForVMAgents\" : { \n        \"value\" : \"<LAWORKSPACE>\"\n        },\n        \"PHPLatestVersionForAppServices\" : { \n        \"value\" : \"7.4\"\n        },\n        \"JavaLatestVersionForAppServices\" : { \n        \"value\" : \"11\"\n        },\n        \"WindowsPythonLatestVersionForAppServices\" : { \n        \"value\" : \"3.6\"\n        },\n        \"LinuxPythonLatestVersionForAppServices\" : { \n        \"value\" : \"3.9\"\n        },\n        \"ensureDotNetFrameworkLatestForFunctionAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityEmailsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"vulnerabilityAssessmentMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensureDotNetFrameworkLatestForWebAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlServerAdvancedDataSecurityEmailsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"microsoftIaaSAntimalwareExtensionShouldBeDeployedOnWindowsServersEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"securityCenterStandardPricingTierShouldBeSelectedEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"theLogAnalyticsAgentShouldBeInstalledOnVirtualMachinesEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensurePHPVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityEmailAdminsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"securityContactPhoneNumberShouldBeProvidedForSubscriptionEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"threatDetectionTypesOnManagedInstanceMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensureDotNetFrameworkLatestForAPIAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlServerAdvancedDataSecurityEmailAdminsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"threatDetectionTypesOnServerMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"theLogAnalyticsAgentShouldBeInstalledOnVirtualMachineScaleSetsEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        }\n}', '<LAWORKSPACE>', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))))), 'CMMC', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/b5629c75-5c77-4422-87b9-2509e680f8de', 'parameters', json(replace('{\n    \"logAnalyticsWorkspaceId-f47b5582-33ec-4c5c-87c0-b010a6b2e917\" : { \n        \"value\" : \"<LAWORKSPACE>\"\n    },\n    \"effect-09024ccc-0c5f-475e-9457-b7c0d9ed487b\" : { \n        \"value\" : \"AuditIfNotExists\"\n    },\n    \"MembersToExclude-69bf4abd-ca1e-4cf6-8b5a-762d42e61d4f\" :{\n        \"value\": \"\"\n    },\n    \"MembersToInclude-30f71ea1-ac77-4f26-9fc5-2d926bbd4ba7\": {\n        \"value\": \"\"\n    },\n    \"effect-0961003e-5a0a-4549-abde-af6a37f2724d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0b15565f-aa9e-48ba-8619-45960f2c314d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0e60b895-3786-45da-8377-9c6b4b6ac5f9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-17k78e20-9358-41c9-923c-fb736d382a12\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-1bc1795e-d44a-4d48-9b3b-6fff0fd5f9ba\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"PHPLatestVersion\" : { \n    \"value\" : \"7.3\"\n    },\n    \"effect-22bee202-a82f-4305-9a2a-6d7f44d4dedb\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-26a828e1-e88f-464e-bbb3-c134a282b9de\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-34c877ad-507e-4c82-993e-3452a6e0ad3c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-404c3081-a854-4457-ae30-26a93ef643f9\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-47a6b606-51aa-4496-8bb7-64b11cf66adc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-496223c3-ad65-4ecd-878a-bae78737e9ed\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"JavaLatestVersion\" : { \n    \"value\" : \"11\"\n    },\n    \"effect-4f11b553-d42e-4e3a-89be-32ca364cad4c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5c607a2e-c700-4744-8254-d77e7c9eb5e4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5f76cf89-fbf2-47fd-a3f4-b891fa780b60\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6b1cbf55-e8b6-442f-ba4c-7246b6381474\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-7008174a-fd10-4ef0-817e-fc820a951d73\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"LinuxPythonLatestVersion\" : { \n    \"value\" : \"3.8\"\n    },\n    \"effect-7238174a-fd10-4ef0-817e-fc820a951d73\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7261b898-8a84-4db8-9e04-18527132abb3\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-74c3584d-afae-46f7-a20a-6f8adba71a16\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-86b3d65f-7626-441e-b690-81a8b71cff60\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-88999f4c-376a-45c8-bcb3-4058f713cf39\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-8c122334-9d20-4eb8-89ea-ac9a705b74ae\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9297c21d-2ed6-4474-b48f-163f75654ce3\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-991310cd-e9f3-47bc-b7b6-f57b557d07db\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9b597639-28e4-48eb-b506-56b05d366257\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9d0b6ea4-93e2-4578-bf2f-6bb17d22b4bc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9daedab3-fb2d-461e-b861-71790eead4f6\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-a4af4a39-4135-47fb-b175-47fbdf85311d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"setting-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n    \"value\" : \"enabled\"\n    },\n    \"effect-a70ca396-0a34-413a-88e1-b956c1e683be\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-aa633080-8b72-40c4-a2d7-d00c03e80bed\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-af6cd1bd-1635-48cb-bde7-5b15693900b9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"resourceGroupName-b6e2945c-0b7b-40f5-9233-7a5323b5cdc6\" : { \n    \"value\" : \"NetworkWatcherRG\"\n    },\n    \"effect-b7ddfbdc-1260-477d-91fd-98bd9be789a6\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c3f317a7-a95c-4547-b7e7-11017ebdf2fe\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-cb510bfd-1cba-4d9f-a230-cb0976f4bb71\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e2c1c086-2d84-4019-bff3-c44ccd95113c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e3576e28-8b17-4677-84c3-db2990658d64\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e8cbc669-f12d-49eb-93e7-9273119e9933\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e9c8d085-d9cc-4b17-9cdc-059f1f01f19e\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ebb62a0c-3560-49e1-89ed-27e074e9f8ad\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-efbde977-ba53-4479-b8e9-10b957924fbf\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f6de0be7-9a8a-4b8a-b349-43cf02d22f7c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f8456c1c-aa66-4dfb-861a-25d127b775c9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f9d614c5-c173-4d56-95a7-b4437057d193\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-fb893a29-21bb-418c-a157-e99480ec364c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-feedbf84-6b99-488c-acc2-71c829aa5ffc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-3b980d31-7904-4bb7-8575-5665739a8052\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6e2593d9-add6-4083-9c9b-4b7d2188c899\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-12430be1-6cc8-4527-a9a8-e3d38f250096\" : { \n    \"value\" : \"Audit\"\n    },\n    \"modeRequirement-12430be1-6cc8-4527-a9a8-e3d38f250096\" : { \n    \"value\" : \"Detection\"\n    },\n    \"effect-425bea59-a659-4cbb-8d31-34499bd030b8\" : { \n    \"value\" : \"Audit\"\n    },\n    \"modeRequirement-425bea59-a659-4cbb-8d31-34499bd030b8\" : { \n    \"value\" : \"Detection\"\n    },\n    \"effect-564feb30-bf6a-4854-b4bb-0d2d2d1e6c66\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-055aa869-bc98-4af8-bafc-23f1ab6ffe2c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-013e242c-8828-4970-87b3-ab247555486d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-d38fc420-0735-4ef3-ac11-c806f651a570\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-a1181c5f-672a-477a-979a-7d58aa086233\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-308fbb08-4ab8-4e67-9b29-592e93fb94fa\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-4da35fc9-c9e7-4960-aec9-797fe7d9051d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-523b5cd1-3e23-492f-a539-13118b6d1e3a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7fe3b40f-802b-4cdd-8bd4-fd799c948cc2\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-c25d9a16-bc35-4e15-a7e5-9db606bf9ed4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b0f33259-77d7-4c9e-aac6-3aabcfae693c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-037eea7a-bd0a-46c5-9a66-03aea78705d3\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-0725b4dd-7e76-479c-a735-68e7ee23d5ca\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-0820b7b9-23aa-4725-a1ce-ae4558f718e5\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2c89a2e5-7285-40fe-afe0-ae8654b92fab\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-358c20a6-3f9e-4f0e-97ff-c6ce485e2aac\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5744710e-cc2f-4ee8-8809-3b11e89f4bc9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ac4a19c2-fa67-49b4-8ae5-0b2e78c49457\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c9d007d0-c057-4772-b18c-01e546713bcd\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-d0793b48-0edc-4296-a390-4c75d1bdfd71\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-e372f825-a257-4fb8-9175-797a8a8627d6\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-d158790f-bfb0-486c-8631-2dc6b4e8e6af\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-e802a67a-daf5-4436-9ea6-f6d821dd0c5d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-a451c1ef-c6ca-483d-87ed-f49761e3ffb5\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftSql-servers-firewallRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftClassicNetwork-networkSecurityGroups-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-securityRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftClassicNetwork-networkSecurityGroups-securityRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ae89ebca-1c92-4898-ac2c-9f63decb045c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-d26f7642-7545-4e18-9b75-8c9bbdee3a9a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-1a4e592a-6a6e-44a5-9814-e36264ca96e7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7796937f-307b-4598-941c-67d3a05ebfe7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-c5447c04-a4d7-4ba8-a263-c9ee321a6858\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-41388f1c-2db0-4c25-95b2-35d7f5ccbfa9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b02aacc0-b073-424e-8298-42b22829ee0a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-057d6cfe-9c4f-4a6d-bc60-14420ea1f1a9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0ec47710-77ff-4a3d-9181-6aa50af424d0\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-48af4db5-9b8b-401c-8e74-076be876a430\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-82339799-d096-41ae-8538-b108becf0970\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1b7aa243-30e4-4c9e-bca8-d0d3022b634a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-bb91dfba-c30d-4263-9add-9c2384e659a6\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e71308d3-144b-4262-b144-efdc3cc90517\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2bdd0062-9d75-436e-89df-487dd8e4b3c7\" : { \n    \"value\" : \"Disabled\"\n    },\n    \"effect-4733ea7b-a883-42fe-8cac-97454c2a9e4a\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-67121cc7-ff39-4ab8-b7e3-95b84dab487d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-6fac406b-40ca-413b-bf8e-0bf964659c25\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-81e74cea-30fd-40d5-802f-d72103c2aaaa\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c349d81b-9985-44ae-a8da-ff98d108ede8\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-f4b53539-8df9-40e4-86c6-6b607703bd4e\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-ec068d99-e9c7-401f-8cef-5bdde4e6ccf1\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-048248b0-55cd-46da-b1ff-39efd52db260\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0d134df8-db83-46fb-ad72-fe0c9428c8dd\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2c89a2e5-7285-40fe-afe0-ae8654b92fb2\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-3657f5a0-770e-44a3-b44e-9431ba1e9735\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-617c02be-7f02-4efd-8836-3180d47b6c68\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-7d7be79c-23ba-4033-84dd-45e2a5ccdd67\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-87ba29ef-1ab3-4d82-b763-87fcd4f531f7\" : { \n    \"value\" : \"audit\"\n    },\n    \"effect-f7d52b2d-e161-4dfa-a82b-55e564167385\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c43e4a30-77cb-48ab-a4dd-93f175c63b57\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1f314764-cb73-4fc9-b863-8eca98ac36e9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-123a3936-f020-408a-ba0c-47873faf1534\" : { \n    \"value\" : \"AuditIfNotExists\"\n    }\n}\n', '<LAWORKSPACE>', reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName')), '2021-06-01').customerId))))[variables('modifiedAssignment')].parameters]"
              },
              "identity": {
                "type": "SystemAssigned"
              }
            }
          ]
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc')))]",
        "[subscriptionResourceId(parameters('operationsSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-operations-rg-{0}', parameters('nowUtc')))]"
      ]
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "[format('assign-policy-{0}', parameters('sharedServicesResourceGroupName'))]",
      "subscriptionId": "[parameters('sharedServicesSubscriptionId')]",
      "resourceGroup": "[parameters('sharedServicesResourceGroupName')]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "builtInAssignment": {
            "value": "[parameters('policy')]"
          },
          "logAnalyticsWorkspaceName": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value]"
          },
          "logAnalyticsWorkspaceResourceGroupName": {
            "value": "[reference(subscriptionResourceId(parameters('operationsSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-operations-rg-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value]"
          },
          "operationsSubscriptionId": {
            "value": "[parameters('operationsSubscriptionId')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "3675806177489000536"
            }
          },
          "parameters": {
            "builtInAssignment": {
              "type": "string",
              "defaultValue": ""
            },
            "logAnalyticsWorkspaceName": {
              "type": "string"
            },
            "logAnalyticsWorkspaceResourceGroupName": {
              "type": "string"
            },
            "operationsSubscriptionId": {
              "type": "string"
            }
          },
          "functions": [],
          "variables": {
            "modifiedAssignment": "[if(and(equals(toLower(environment().name), toLower('AzureCloud')), equals(toLower(parameters('builtInAssignment')), toLower('IL5'))), 'NIST', parameters('builtInAssignment'))]",
            "assignmentName": "[format('{0} {1}', variables('modifiedAssignment'), resourceGroup().name)]"
          },
          "resources": [
            {
              "condition": "[not(empty(variables('modifiedAssignment')))]",
              "type": "Microsoft.Authorization/policyAssignments",
              "apiVersion": "2020-09-01",
              "name": "[variables('assignmentName')]",
              "location": "[resourceGroup().location]",
              "properties": {
                "policyDefinitionId": "[createObject('NIST', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f', 'parameters', json(replace('    {\n        \"listOfMembersToExcludeFromWindowsVMAdministratorsGroup\": \n        {\n        \"value\": \"admin\"\n        },\n        \"listOfMembersToIncludeInWindowsVMAdministratorsGroup\": \n        {\n        \"value\": \"azureuser\"\n        },\n        \"logAnalyticsWorkspaceIdforVMReporting\": \n        {\n        \"value\": \"<LAWORKSPACE>\"\n        },\n        \"IncludeArcMachines\": \n        {\n            \"value\": \"true\"\n        },\n        \"MinimumTLSVersion-5752e6d6-1206-46d8-8ab1-ecc2f71a8112\": \n        {\n            \"value\": \"1.2\"\n        },\n        \"NotAvailableMachineState-bed48b13-6647-468e-aa2f-1af1d3f4dd40\": \n        {\n            \"value\": \"Compliant\"\n        },\n        \"requiredRetentionDays\": \n        {\n            \"value\": \"365\"\n        },\n        \"resourceGroupName-b6e2945c-0b7b-40f5-9233-7a5323b5cdc6\": \n        {\n            \"value\": \"NetworkWatcherRG\"\n        }\n    }', '<LAWORKSPACE>', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))))), 'IL5', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/f9a961fa-3241-4b20-adc4-bbf8ad9d7197', 'parameters', json(replace('{\n    \"IncludeArcMachines\" : { \n        \"value\" : \"false\"\n        },\n        \"NotAvailableMachineState-bed48b13-6647-468e-aa2f-1af1d3f4dd40\" : { \n        \"value\" : \"Compliant\"\n        },\n        \"MinimumTLSVersionForWindowsServers\" : { \n        \"value\" : \"1.2\"\n        },\n        \"requiredRetentionDays\" : { \n        \"value\" : \"365\"\n        },\n        \"effect-febd0533-8e55-448f-b837-bd0e06f16469\" : { \n        \"value\" : \"audit\"\n        },\n        \"allowedContainerImagesRegex-febd0533-8e55-448f-b837-bd0e06f16469\" : { \n        \"value\" : \"^(.+){0}$\"\n        },\n        \"effect-95edb821-ddaf-4404-9732-666045e056b4\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-440b515e-a580-421e-abeb-b159a61ddcbc\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-233a2a17-77ca-4fb1-9b6b-69223d272a44\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"audit\"\n        },\n        \"cpuLimit-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"0\"\n        },\n        \"memoryLimit-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"0\"\n        },\n        \"effect-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"audit\"\n        },\n        \"runAsUserRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"MustRunAsNonRoot\"\n        },\n        \"runAsGroupRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"supplementalGroupsRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"fsGroupRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"effect-1c6e92c9-99f0-4e55-9cf2-0c234dc48f99\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-df49d893-a74c-421d-bc95-c663042e5b80\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-c26596ff-4d70-4e6a-9a30-c2506bd2f80c\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-511f5417-5d12-434d-ab2e-816901e72a5e\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-82985f06-dc18-4a48-bc1c-b9f4f0098cfe\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-098fc59e-46c7-4d99-9b16-64990e543d75\" : { \n        \"value\" : \"audit\"\n        },\n        \"NetworkWatcherResourceGroupName\" : { \n        \"value\" : \"NetworkWatcherRG\"\n        },\n        \"setting-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n        \"value\" : \"enabled\"\n        },\n        \"aadAuthenticationInServiceFabricMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-71ef260a-8f18-47b7-abcb-62d0673d94dc\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-055aa869-bc98-4af8-bafc-23f1ab6ffe2c\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-564feb30-bf6a-4854-b4bb-0d2d2d1e6c66\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-d9da03a1-f3c3-412a-9709-947156872263\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-617c02be-7f02-4efd-8836-3180d47b6c68\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ec068d99-e9c7-401f-8cef-5bdde4e6ccf1\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-c349d81b-9985-44ae-a8da-ff98d108ede8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-3657f5a0-770e-44a3-b44e-9431ba1e9735\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-b4ac1030-89c5-4697-8e00-28b5ba6a8811\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-ea0dfaed-95fb-448c-934e-d6e713ce393d\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-4733ea7b-a883-42fe-8cac-97454c2a9e4a\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-f4b53539-8df9-40e4-86c6-6b607703bd4e\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-41425d9f-d1a5-499a-9932-f8ed8453932c\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-fc4d8e41-e223-45ea-9bf5-eada37891d87\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-86efb160-8de7-451d-bc08-5d475b0aadae\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-4ec52d6d-beb7-40c4-9a9e-fe753254690e\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-64d314f6-6062-4780-a861-c23e8951bee5\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1fd32ebd-e4c3-4e13-a54a-d7422d4d95f6\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-fa298e57-9444-42ba-bf04-86e8470e32c7\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-67121cc7-ff39-4ab8-b7e3-95b84dab487d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1f905d99-2ab7-462c-a6b0-f709acca6c8f\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ba769a63-b8cc-4b2d-abf6-ac33c7204be8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-81e74cea-30fd-40d5-802f-d72103c2aaaa\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0aa61e00-0a01-4a3c-9945-e93cffedf0e6\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-47031206-ce96-41f8-861b-6a915f3de284\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-87ba29ef-1ab3-4d82-b763-87fcd4f531f7\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-51522a96-0869-4791-82f3-981000c2c67f\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-b5ec538c-daa0-4006-8596-35468b9148e8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-56a5ee18-2ae6-4810-86f7-18e39ce5629b\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-2e94d99a-8a36-4563-bc77-810d8893b671\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1fafeaf6-7927-4059-a50a-8eb2a7a6f2b5\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-99e9ccd8-3db9-4592-b0d1-14b1715a4d8a\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1f68a601-6e6d-4e42-babf-3f643a047ea2\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-f7d52b2d-e161-4dfa-a82b-55e564167385\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-7d7be79c-23ba-4033-84dd-45e2a5ccdd67\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ca91455f-eace-4f96-be59-e6e2c35b4816\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-702dd420-7fcc-42c5-afe8-4026edd20fe0\" : { \n        \"value\" : \"Audit\"\n        },\n        \"diagnosticsLogsInRedisCacheMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"secureTransferToStorageAccountMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-d0793b48-0edc-4296-a390-4c75d1bdfd71\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-7d092e0a-7acd-40d2-a975-dca21cae48c4\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-2a1a9cdf-e04d-429a-8416-3bfb72a1b26f\" : { \n        \"value\" : \"Audit\"\n        },\n        \"disableUnrestrictedNetworkToStorageAccountMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-55615ac9-af46-4a59-874e-391cc3dfb490\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1b8ca024-1d5c-4dec-8995-b1a932b41780\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-037eea7a-bd0a-46c5-9a66-03aea78705d3\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-53503636-bcc9-4748-9663-5348217f160f\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-40cec1dd-a100-4920-b15b-3024fe8901ab\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0725b4dd-7e76-479c-a735-68e7ee23d5ca\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-a049bf77-880b-470f-ba6d-9f21c530cf83\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ee980b6d-0eca-4501-8d54-f6290fd512c3\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1d84d5fb-01f6-4d12-ba4f-4a26081d403d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-37e0d2fe-28a5-43d6-a273-67d37d1f5606\" : { \n        \"value\" : \"Audit\"\n        },\n        \"identityDesignateMoreThanOneOwnerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"diskEncryptionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"emailNotificationToSubscriptionOwnerHighSeverityAlertsEnabledEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlDbEncryptionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vulnerabilityAssessmentOnManagedInstanceMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePHPVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"aadAuthenticationInSqlServerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vmssEndpointProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vmssOsVulnerabilitiesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"adaptiveApplicationControlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"geoRedundantBackupShouldBeEnabledForAzureDatabaseForPostgreSQLEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"ensureJavaVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityDesignateLessThanOwnersMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"securityContactEmailAddressForSubscriptionEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppRestrictCORSAccessMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveDeprecatedAccountMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"ensurePythonVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePythonVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePHPVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePythonVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"geoRedundantBackupShouldBeEnabledForAzureDatabaseForMySQLEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"systemUpdatesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureJavaVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForWritePermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureJavaVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"nextGenerationFirewallMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"useRbacRulesMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"webAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"sqlServerAuditingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vnetEnableDDoSProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlServerAdvancedDataSecurityMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"endpointProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"jitNetworkAccessMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"geoRedundantStorageShouldBeEnabledForStorageAccountsEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"vmssSystemUpdatesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"longtermGeoRedundantBackupEnabledAzureSQLDatabasesEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"systemConfigurationsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForReadPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"containerBenchmarkMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vulnerabilityAssessmentOnServerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"kubernetesServiceVersionUpToDateMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"sqlDbVulnerabilityAssesmentMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"membersToIncludeInLocalAdministratorsGroup\" : { \n        \"value\" : \"\"\n        },\n        \"membersToExcludeInLocalAdministratorsGroup\" : { \n        \"value\" : \"\"\n        },\n        \"logAnalyticsWorkspaceIDForVMAgents\" : { \n        \"value\" : \"<LAWORKSPACE>\"\n        },\n        \"PHPLatestVersionForAppServices\" : { \n        \"value\" : \"7.4\"\n        },\n        \"JavaLatestVersionForAppServices\" : { \n        \"value\" : \"11\"\n        },\n        \"WindowsPythonLatestVersionForAppServices\" : { \n        \"value\" : \"3.6\"\n        },\n        \"LinuxPythonLatestVersionForAppServices\" : { \n        \"value\" : \"3.9\"\n        },\n        \"ensureDotNetFrameworkLatestForFunctionAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityEmailsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"vulnerabilityAssessmentMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensureDotNetFrameworkLatestForWebAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlServerAdvancedDataSecurityEmailsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"microsoftIaaSAntimalwareExtensionShouldBeDeployedOnWindowsServersEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"securityCenterStandardPricingTierShouldBeSelectedEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"theLogAnalyticsAgentShouldBeInstalledOnVirtualMachinesEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensurePHPVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityEmailAdminsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"securityContactPhoneNumberShouldBeProvidedForSubscriptionEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"threatDetectionTypesOnManagedInstanceMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensureDotNetFrameworkLatestForAPIAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlServerAdvancedDataSecurityEmailAdminsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"threatDetectionTypesOnServerMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"theLogAnalyticsAgentShouldBeInstalledOnVirtualMachineScaleSetsEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        }\n}', '<LAWORKSPACE>', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))))), 'CMMC', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/b5629c75-5c77-4422-87b9-2509e680f8de', 'parameters', json(replace('{\n    \"logAnalyticsWorkspaceId-f47b5582-33ec-4c5c-87c0-b010a6b2e917\" : { \n        \"value\" : \"<LAWORKSPACE>\"\n    },\n    \"effect-09024ccc-0c5f-475e-9457-b7c0d9ed487b\" : { \n        \"value\" : \"AuditIfNotExists\"\n    },\n    \"MembersToExclude-69bf4abd-ca1e-4cf6-8b5a-762d42e61d4f\" :{\n        \"value\": \"\"\n    },\n    \"MembersToInclude-30f71ea1-ac77-4f26-9fc5-2d926bbd4ba7\": {\n        \"value\": \"\"\n    },\n    \"effect-0961003e-5a0a-4549-abde-af6a37f2724d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0b15565f-aa9e-48ba-8619-45960f2c314d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0e60b895-3786-45da-8377-9c6b4b6ac5f9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-17k78e20-9358-41c9-923c-fb736d382a12\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-1bc1795e-d44a-4d48-9b3b-6fff0fd5f9ba\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"PHPLatestVersion\" : { \n    \"value\" : \"7.3\"\n    },\n    \"effect-22bee202-a82f-4305-9a2a-6d7f44d4dedb\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-26a828e1-e88f-464e-bbb3-c134a282b9de\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-34c877ad-507e-4c82-993e-3452a6e0ad3c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-404c3081-a854-4457-ae30-26a93ef643f9\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-47a6b606-51aa-4496-8bb7-64b11cf66adc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-496223c3-ad65-4ecd-878a-bae78737e9ed\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"JavaLatestVersion\" : { \n    \"value\" : \"11\"\n    },\n    \"effect-4f11b553-d42e-4e3a-89be-32ca364cad4c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5c607a2e-c700-4744-8254-d77e7c9eb5e4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5f76cf89-fbf2-47fd-a3f4-b891fa780b60\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6b1cbf55-e8b6-442f-ba4c-7246b6381474\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-7008174a-fd10-4ef0-817e-fc820a951d73\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"LinuxPythonLatestVersion\" : { \n    \"value\" : \"3.8\"\n    },\n    \"effect-7238174a-fd10-4ef0-817e-fc820a951d73\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7261b898-8a84-4db8-9e04-18527132abb3\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-74c3584d-afae-46f7-a20a-6f8adba71a16\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-86b3d65f-7626-441e-b690-81a8b71cff60\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-88999f4c-376a-45c8-bcb3-4058f713cf39\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-8c122334-9d20-4eb8-89ea-ac9a705b74ae\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9297c21d-2ed6-4474-b48f-163f75654ce3\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-991310cd-e9f3-47bc-b7b6-f57b557d07db\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9b597639-28e4-48eb-b506-56b05d366257\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9d0b6ea4-93e2-4578-bf2f-6bb17d22b4bc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9daedab3-fb2d-461e-b861-71790eead4f6\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-a4af4a39-4135-47fb-b175-47fbdf85311d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"setting-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n    \"value\" : \"enabled\"\n    },\n    \"effect-a70ca396-0a34-413a-88e1-b956c1e683be\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-aa633080-8b72-40c4-a2d7-d00c03e80bed\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-af6cd1bd-1635-48cb-bde7-5b15693900b9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"resourceGroupName-b6e2945c-0b7b-40f5-9233-7a5323b5cdc6\" : { \n    \"value\" : \"NetworkWatcherRG\"\n    },\n    \"effect-b7ddfbdc-1260-477d-91fd-98bd9be789a6\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c3f317a7-a95c-4547-b7e7-11017ebdf2fe\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-cb510bfd-1cba-4d9f-a230-cb0976f4bb71\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e2c1c086-2d84-4019-bff3-c44ccd95113c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e3576e28-8b17-4677-84c3-db2990658d64\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e8cbc669-f12d-49eb-93e7-9273119e9933\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e9c8d085-d9cc-4b17-9cdc-059f1f01f19e\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ebb62a0c-3560-49e1-89ed-27e074e9f8ad\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-efbde977-ba53-4479-b8e9-10b957924fbf\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f6de0be7-9a8a-4b8a-b349-43cf02d22f7c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f8456c1c-aa66-4dfb-861a-25d127b775c9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f9d614c5-c173-4d56-95a7-b4437057d193\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-fb893a29-21bb-418c-a157-e99480ec364c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-feedbf84-6b99-488c-acc2-71c829aa5ffc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-3b980d31-7904-4bb7-8575-5665739a8052\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6e2593d9-add6-4083-9c9b-4b7d2188c899\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-12430be1-6cc8-4527-a9a8-e3d38f250096\" : { \n    \"value\" : \"Audit\"\n    },\n    \"modeRequirement-12430be1-6cc8-4527-a9a8-e3d38f250096\" : { \n    \"value\" : \"Detection\"\n    },\n    \"effect-425bea59-a659-4cbb-8d31-34499bd030b8\" : { \n    \"value\" : \"Audit\"\n    },\n    \"modeRequirement-425bea59-a659-4cbb-8d31-34499bd030b8\" : { \n    \"value\" : \"Detection\"\n    },\n    \"effect-564feb30-bf6a-4854-b4bb-0d2d2d1e6c66\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-055aa869-bc98-4af8-bafc-23f1ab6ffe2c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-013e242c-8828-4970-87b3-ab247555486d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-d38fc420-0735-4ef3-ac11-c806f651a570\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-a1181c5f-672a-477a-979a-7d58aa086233\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-308fbb08-4ab8-4e67-9b29-592e93fb94fa\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-4da35fc9-c9e7-4960-aec9-797fe7d9051d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-523b5cd1-3e23-492f-a539-13118b6d1e3a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7fe3b40f-802b-4cdd-8bd4-fd799c948cc2\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-c25d9a16-bc35-4e15-a7e5-9db606bf9ed4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b0f33259-77d7-4c9e-aac6-3aabcfae693c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-037eea7a-bd0a-46c5-9a66-03aea78705d3\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-0725b4dd-7e76-479c-a735-68e7ee23d5ca\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-0820b7b9-23aa-4725-a1ce-ae4558f718e5\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2c89a2e5-7285-40fe-afe0-ae8654b92fab\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-358c20a6-3f9e-4f0e-97ff-c6ce485e2aac\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5744710e-cc2f-4ee8-8809-3b11e89f4bc9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ac4a19c2-fa67-49b4-8ae5-0b2e78c49457\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c9d007d0-c057-4772-b18c-01e546713bcd\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-d0793b48-0edc-4296-a390-4c75d1bdfd71\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-e372f825-a257-4fb8-9175-797a8a8627d6\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-d158790f-bfb0-486c-8631-2dc6b4e8e6af\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-e802a67a-daf5-4436-9ea6-f6d821dd0c5d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-a451c1ef-c6ca-483d-87ed-f49761e3ffb5\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftSql-servers-firewallRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftClassicNetwork-networkSecurityGroups-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-securityRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftClassicNetwork-networkSecurityGroups-securityRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ae89ebca-1c92-4898-ac2c-9f63decb045c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-d26f7642-7545-4e18-9b75-8c9bbdee3a9a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-1a4e592a-6a6e-44a5-9814-e36264ca96e7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7796937f-307b-4598-941c-67d3a05ebfe7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-c5447c04-a4d7-4ba8-a263-c9ee321a6858\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-41388f1c-2db0-4c25-95b2-35d7f5ccbfa9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b02aacc0-b073-424e-8298-42b22829ee0a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-057d6cfe-9c4f-4a6d-bc60-14420ea1f1a9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0ec47710-77ff-4a3d-9181-6aa50af424d0\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-48af4db5-9b8b-401c-8e74-076be876a430\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-82339799-d096-41ae-8538-b108becf0970\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1b7aa243-30e4-4c9e-bca8-d0d3022b634a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-bb91dfba-c30d-4263-9add-9c2384e659a6\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e71308d3-144b-4262-b144-efdc3cc90517\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2bdd0062-9d75-436e-89df-487dd8e4b3c7\" : { \n    \"value\" : \"Disabled\"\n    },\n    \"effect-4733ea7b-a883-42fe-8cac-97454c2a9e4a\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-67121cc7-ff39-4ab8-b7e3-95b84dab487d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-6fac406b-40ca-413b-bf8e-0bf964659c25\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-81e74cea-30fd-40d5-802f-d72103c2aaaa\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c349d81b-9985-44ae-a8da-ff98d108ede8\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-f4b53539-8df9-40e4-86c6-6b607703bd4e\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-ec068d99-e9c7-401f-8cef-5bdde4e6ccf1\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-048248b0-55cd-46da-b1ff-39efd52db260\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0d134df8-db83-46fb-ad72-fe0c9428c8dd\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2c89a2e5-7285-40fe-afe0-ae8654b92fb2\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-3657f5a0-770e-44a3-b44e-9431ba1e9735\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-617c02be-7f02-4efd-8836-3180d47b6c68\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-7d7be79c-23ba-4033-84dd-45e2a5ccdd67\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-87ba29ef-1ab3-4d82-b763-87fcd4f531f7\" : { \n    \"value\" : \"audit\"\n    },\n    \"effect-f7d52b2d-e161-4dfa-a82b-55e564167385\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c43e4a30-77cb-48ab-a4dd-93f175c63b57\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1f314764-cb73-4fc9-b863-8eca98ac36e9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-123a3936-f020-408a-ba0c-47873faf1534\" : { \n    \"value\" : \"AuditIfNotExists\"\n    }\n}\n', '<LAWORKSPACE>', reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName')), '2021-06-01').customerId))))[variables('modifiedAssignment')].id]",
                "parameters": "[createObject('NIST', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f', 'parameters', json(replace('    {\n        \"listOfMembersToExcludeFromWindowsVMAdministratorsGroup\": \n        {\n        \"value\": \"admin\"\n        },\n        \"listOfMembersToIncludeInWindowsVMAdministratorsGroup\": \n        {\n        \"value\": \"azureuser\"\n        },\n        \"logAnalyticsWorkspaceIdforVMReporting\": \n        {\n        \"value\": \"<LAWORKSPACE>\"\n        },\n        \"IncludeArcMachines\": \n        {\n            \"value\": \"true\"\n        },\n        \"MinimumTLSVersion-5752e6d6-1206-46d8-8ab1-ecc2f71a8112\": \n        {\n            \"value\": \"1.2\"\n        },\n        \"NotAvailableMachineState-bed48b13-6647-468e-aa2f-1af1d3f4dd40\": \n        {\n            \"value\": \"Compliant\"\n        },\n        \"requiredRetentionDays\": \n        {\n            \"value\": \"365\"\n        },\n        \"resourceGroupName-b6e2945c-0b7b-40f5-9233-7a5323b5cdc6\": \n        {\n            \"value\": \"NetworkWatcherRG\"\n        }\n    }', '<LAWORKSPACE>', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))))), 'IL5', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/f9a961fa-3241-4b20-adc4-bbf8ad9d7197', 'parameters', json(replace('{\n    \"IncludeArcMachines\" : { \n        \"value\" : \"false\"\n        },\n        \"NotAvailableMachineState-bed48b13-6647-468e-aa2f-1af1d3f4dd40\" : { \n        \"value\" : \"Compliant\"\n        },\n        \"MinimumTLSVersionForWindowsServers\" : { \n        \"value\" : \"1.2\"\n        },\n        \"requiredRetentionDays\" : { \n        \"value\" : \"365\"\n        },\n        \"effect-febd0533-8e55-448f-b837-bd0e06f16469\" : { \n        \"value\" : \"audit\"\n        },\n        \"allowedContainerImagesRegex-febd0533-8e55-448f-b837-bd0e06f16469\" : { \n        \"value\" : \"^(.+){0}$\"\n        },\n        \"effect-95edb821-ddaf-4404-9732-666045e056b4\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-440b515e-a580-421e-abeb-b159a61ddcbc\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-233a2a17-77ca-4fb1-9b6b-69223d272a44\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"audit\"\n        },\n        \"cpuLimit-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"0\"\n        },\n        \"memoryLimit-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"0\"\n        },\n        \"effect-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"audit\"\n        },\n        \"runAsUserRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"MustRunAsNonRoot\"\n        },\n        \"runAsGroupRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"supplementalGroupsRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"fsGroupRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"effect-1c6e92c9-99f0-4e55-9cf2-0c234dc48f99\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-df49d893-a74c-421d-bc95-c663042e5b80\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-c26596ff-4d70-4e6a-9a30-c2506bd2f80c\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-511f5417-5d12-434d-ab2e-816901e72a5e\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-82985f06-dc18-4a48-bc1c-b9f4f0098cfe\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-098fc59e-46c7-4d99-9b16-64990e543d75\" : { \n        \"value\" : \"audit\"\n        },\n        \"NetworkWatcherResourceGroupName\" : { \n        \"value\" : \"NetworkWatcherRG\"\n        },\n        \"setting-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n        \"value\" : \"enabled\"\n        },\n        \"aadAuthenticationInServiceFabricMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-71ef260a-8f18-47b7-abcb-62d0673d94dc\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-055aa869-bc98-4af8-bafc-23f1ab6ffe2c\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-564feb30-bf6a-4854-b4bb-0d2d2d1e6c66\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-d9da03a1-f3c3-412a-9709-947156872263\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-617c02be-7f02-4efd-8836-3180d47b6c68\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ec068d99-e9c7-401f-8cef-5bdde4e6ccf1\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-c349d81b-9985-44ae-a8da-ff98d108ede8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-3657f5a0-770e-44a3-b44e-9431ba1e9735\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-b4ac1030-89c5-4697-8e00-28b5ba6a8811\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-ea0dfaed-95fb-448c-934e-d6e713ce393d\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-4733ea7b-a883-42fe-8cac-97454c2a9e4a\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-f4b53539-8df9-40e4-86c6-6b607703bd4e\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-41425d9f-d1a5-499a-9932-f8ed8453932c\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-fc4d8e41-e223-45ea-9bf5-eada37891d87\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-86efb160-8de7-451d-bc08-5d475b0aadae\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-4ec52d6d-beb7-40c4-9a9e-fe753254690e\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-64d314f6-6062-4780-a861-c23e8951bee5\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1fd32ebd-e4c3-4e13-a54a-d7422d4d95f6\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-fa298e57-9444-42ba-bf04-86e8470e32c7\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-67121cc7-ff39-4ab8-b7e3-95b84dab487d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1f905d99-2ab7-462c-a6b0-f709acca6c8f\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ba769a63-b8cc-4b2d-abf6-ac33c7204be8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-81e74cea-30fd-40d5-802f-d72103c2aaaa\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0aa61e00-0a01-4a3c-9945-e93cffedf0e6\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-47031206-ce96-41f8-861b-6a915f3de284\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-87ba29ef-1ab3-4d82-b763-87fcd4f531f7\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-51522a96-0869-4791-82f3-981000c2c67f\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-b5ec538c-daa0-4006-8596-35468b9148e8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-56a5ee18-2ae6-4810-86f7-18e39ce5629b\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-2e94d99a-8a36-4563-bc77-810d8893b671\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1fafeaf6-7927-4059-a50a-8eb2a7a6f2b5\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-99e9ccd8-3db9-4592-b0d1-14b1715a4d8a\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1f68a601-6e6d-4e42-babf-3f643a047ea2\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-f7d52b2d-e161-4dfa-a82b-55e564167385\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-7d7be79c-23ba-4033-84dd-45e2a5ccdd67\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ca91455f-eace-4f96-be59-e6e2c35b4816\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-702dd420-7fcc-42c5-afe8-4026edd20fe0\" : { \n        \"value\" : \"Audit\"\n        },\n        \"diagnosticsLogsInRedisCacheMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"secureTransferToStorageAccountMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-d0793b48-0edc-4296-a390-4c75d1bdfd71\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-7d092e0a-7acd-40d2-a975-dca21cae48c4\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-2a1a9cdf-e04d-429a-8416-3bfb72a1b26f\" : { \n        \"value\" : \"Audit\"\n        },\n        \"disableUnrestrictedNetworkToStorageAccountMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-55615ac9-af46-4a59-874e-391cc3dfb490\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1b8ca024-1d5c-4dec-8995-b1a932b41780\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-037eea7a-bd0a-46c5-9a66-03aea78705d3\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-53503636-bcc9-4748-9663-5348217f160f\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-40cec1dd-a100-4920-b15b-3024fe8901ab\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0725b4dd-7e76-479c-a735-68e7ee23d5ca\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-a049bf77-880b-470f-ba6d-9f21c530cf83\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ee980b6d-0eca-4501-8d54-f6290fd512c3\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1d84d5fb-01f6-4d12-ba4f-4a26081d403d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-37e0d2fe-28a5-43d6-a273-67d37d1f5606\" : { \n        \"value\" : \"Audit\"\n        },\n        \"identityDesignateMoreThanOneOwnerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"diskEncryptionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"emailNotificationToSubscriptionOwnerHighSeverityAlertsEnabledEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlDbEncryptionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vulnerabilityAssessmentOnManagedInstanceMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePHPVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"aadAuthenticationInSqlServerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vmssEndpointProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vmssOsVulnerabilitiesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"adaptiveApplicationControlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"geoRedundantBackupShouldBeEnabledForAzureDatabaseForPostgreSQLEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"ensureJavaVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityDesignateLessThanOwnersMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"securityContactEmailAddressForSubscriptionEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppRestrictCORSAccessMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveDeprecatedAccountMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"ensurePythonVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePythonVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePHPVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePythonVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"geoRedundantBackupShouldBeEnabledForAzureDatabaseForMySQLEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"systemUpdatesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureJavaVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForWritePermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureJavaVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"nextGenerationFirewallMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"useRbacRulesMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"webAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"sqlServerAuditingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vnetEnableDDoSProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlServerAdvancedDataSecurityMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"endpointProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"jitNetworkAccessMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"geoRedundantStorageShouldBeEnabledForStorageAccountsEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"vmssSystemUpdatesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"longtermGeoRedundantBackupEnabledAzureSQLDatabasesEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"systemConfigurationsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForReadPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"containerBenchmarkMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vulnerabilityAssessmentOnServerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"kubernetesServiceVersionUpToDateMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"sqlDbVulnerabilityAssesmentMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"membersToIncludeInLocalAdministratorsGroup\" : { \n        \"value\" : \"\"\n        },\n        \"membersToExcludeInLocalAdministratorsGroup\" : { \n        \"value\" : \"\"\n        },\n        \"logAnalyticsWorkspaceIDForVMAgents\" : { \n        \"value\" : \"<LAWORKSPACE>\"\n        },\n        \"PHPLatestVersionForAppServices\" : { \n        \"value\" : \"7.4\"\n        },\n        \"JavaLatestVersionForAppServices\" : { \n        \"value\" : \"11\"\n        },\n        \"WindowsPythonLatestVersionForAppServices\" : { \n        \"value\" : \"3.6\"\n        },\n        \"LinuxPythonLatestVersionForAppServices\" : { \n        \"value\" : \"3.9\"\n        },\n        \"ensureDotNetFrameworkLatestForFunctionAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityEmailsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"vulnerabilityAssessmentMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensureDotNetFrameworkLatestForWebAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlServerAdvancedDataSecurityEmailsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"microsoftIaaSAntimalwareExtensionShouldBeDeployedOnWindowsServersEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"securityCenterStandardPricingTierShouldBeSelectedEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"theLogAnalyticsAgentShouldBeInstalledOnVirtualMachinesEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensurePHPVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityEmailAdminsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"securityContactPhoneNumberShouldBeProvidedForSubscriptionEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"threatDetectionTypesOnManagedInstanceMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensureDotNetFrameworkLatestForAPIAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlServerAdvancedDataSecurityEmailAdminsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"threatDetectionTypesOnServerMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"theLogAnalyticsAgentShouldBeInstalledOnVirtualMachineScaleSetsEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        }\n}', '<LAWORKSPACE>', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))))), 'CMMC', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/b5629c75-5c77-4422-87b9-2509e680f8de', 'parameters', json(replace('{\n    \"logAnalyticsWorkspaceId-f47b5582-33ec-4c5c-87c0-b010a6b2e917\" : { \n        \"value\" : \"<LAWORKSPACE>\"\n    },\n    \"effect-09024ccc-0c5f-475e-9457-b7c0d9ed487b\" : { \n        \"value\" : \"AuditIfNotExists\"\n    },\n    \"MembersToExclude-69bf4abd-ca1e-4cf6-8b5a-762d42e61d4f\" :{\n        \"value\": \"\"\n    },\n    \"MembersToInclude-30f71ea1-ac77-4f26-9fc5-2d926bbd4ba7\": {\n        \"value\": \"\"\n    },\n    \"effect-0961003e-5a0a-4549-abde-af6a37f2724d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0b15565f-aa9e-48ba-8619-45960f2c314d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0e60b895-3786-45da-8377-9c6b4b6ac5f9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-17k78e20-9358-41c9-923c-fb736d382a12\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-1bc1795e-d44a-4d48-9b3b-6fff0fd5f9ba\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"PHPLatestVersion\" : { \n    \"value\" : \"7.3\"\n    },\n    \"effect-22bee202-a82f-4305-9a2a-6d7f44d4dedb\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-26a828e1-e88f-464e-bbb3-c134a282b9de\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-34c877ad-507e-4c82-993e-3452a6e0ad3c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-404c3081-a854-4457-ae30-26a93ef643f9\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-47a6b606-51aa-4496-8bb7-64b11cf66adc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-496223c3-ad65-4ecd-878a-bae78737e9ed\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"JavaLatestVersion\" : { \n    \"value\" : \"11\"\n    },\n    \"effect-4f11b553-d42e-4e3a-89be-32ca364cad4c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5c607a2e-c700-4744-8254-d77e7c9eb5e4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5f76cf89-fbf2-47fd-a3f4-b891fa780b60\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6b1cbf55-e8b6-442f-ba4c-7246b6381474\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-7008174a-fd10-4ef0-817e-fc820a951d73\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"LinuxPythonLatestVersion\" : { \n    \"value\" : \"3.8\"\n    },\n    \"effect-7238174a-fd10-4ef0-817e-fc820a951d73\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7261b898-8a84-4db8-9e04-18527132abb3\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-74c3584d-afae-46f7-a20a-6f8adba71a16\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-86b3d65f-7626-441e-b690-81a8b71cff60\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-88999f4c-376a-45c8-bcb3-4058f713cf39\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-8c122334-9d20-4eb8-89ea-ac9a705b74ae\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9297c21d-2ed6-4474-b48f-163f75654ce3\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-991310cd-e9f3-47bc-b7b6-f57b557d07db\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9b597639-28e4-48eb-b506-56b05d366257\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9d0b6ea4-93e2-4578-bf2f-6bb17d22b4bc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9daedab3-fb2d-461e-b861-71790eead4f6\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-a4af4a39-4135-47fb-b175-47fbdf85311d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"setting-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n    \"value\" : \"enabled\"\n    },\n    \"effect-a70ca396-0a34-413a-88e1-b956c1e683be\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-aa633080-8b72-40c4-a2d7-d00c03e80bed\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-af6cd1bd-1635-48cb-bde7-5b15693900b9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"resourceGroupName-b6e2945c-0b7b-40f5-9233-7a5323b5cdc6\" : { \n    \"value\" : \"NetworkWatcherRG\"\n    },\n    \"effect-b7ddfbdc-1260-477d-91fd-98bd9be789a6\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c3f317a7-a95c-4547-b7e7-11017ebdf2fe\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-cb510bfd-1cba-4d9f-a230-cb0976f4bb71\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e2c1c086-2d84-4019-bff3-c44ccd95113c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e3576e28-8b17-4677-84c3-db2990658d64\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e8cbc669-f12d-49eb-93e7-9273119e9933\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e9c8d085-d9cc-4b17-9cdc-059f1f01f19e\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ebb62a0c-3560-49e1-89ed-27e074e9f8ad\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-efbde977-ba53-4479-b8e9-10b957924fbf\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f6de0be7-9a8a-4b8a-b349-43cf02d22f7c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f8456c1c-aa66-4dfb-861a-25d127b775c9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f9d614c5-c173-4d56-95a7-b4437057d193\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-fb893a29-21bb-418c-a157-e99480ec364c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-feedbf84-6b99-488c-acc2-71c829aa5ffc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-3b980d31-7904-4bb7-8575-5665739a8052\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6e2593d9-add6-4083-9c9b-4b7d2188c899\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-12430be1-6cc8-4527-a9a8-e3d38f250096\" : { \n    \"value\" : \"Audit\"\n    },\n    \"modeRequirement-12430be1-6cc8-4527-a9a8-e3d38f250096\" : { \n    \"value\" : \"Detection\"\n    },\n    \"effect-425bea59-a659-4cbb-8d31-34499bd030b8\" : { \n    \"value\" : \"Audit\"\n    },\n    \"modeRequirement-425bea59-a659-4cbb-8d31-34499bd030b8\" : { \n    \"value\" : \"Detection\"\n    },\n    \"effect-564feb30-bf6a-4854-b4bb-0d2d2d1e6c66\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-055aa869-bc98-4af8-bafc-23f1ab6ffe2c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-013e242c-8828-4970-87b3-ab247555486d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-d38fc420-0735-4ef3-ac11-c806f651a570\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-a1181c5f-672a-477a-979a-7d58aa086233\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-308fbb08-4ab8-4e67-9b29-592e93fb94fa\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-4da35fc9-c9e7-4960-aec9-797fe7d9051d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-523b5cd1-3e23-492f-a539-13118b6d1e3a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7fe3b40f-802b-4cdd-8bd4-fd799c948cc2\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-c25d9a16-bc35-4e15-a7e5-9db606bf9ed4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b0f33259-77d7-4c9e-aac6-3aabcfae693c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-037eea7a-bd0a-46c5-9a66-03aea78705d3\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-0725b4dd-7e76-479c-a735-68e7ee23d5ca\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-0820b7b9-23aa-4725-a1ce-ae4558f718e5\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2c89a2e5-7285-40fe-afe0-ae8654b92fab\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-358c20a6-3f9e-4f0e-97ff-c6ce485e2aac\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5744710e-cc2f-4ee8-8809-3b11e89f4bc9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ac4a19c2-fa67-49b4-8ae5-0b2e78c49457\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c9d007d0-c057-4772-b18c-01e546713bcd\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-d0793b48-0edc-4296-a390-4c75d1bdfd71\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-e372f825-a257-4fb8-9175-797a8a8627d6\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-d158790f-bfb0-486c-8631-2dc6b4e8e6af\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-e802a67a-daf5-4436-9ea6-f6d821dd0c5d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-a451c1ef-c6ca-483d-87ed-f49761e3ffb5\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftSql-servers-firewallRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftClassicNetwork-networkSecurityGroups-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-securityRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftClassicNetwork-networkSecurityGroups-securityRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ae89ebca-1c92-4898-ac2c-9f63decb045c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-d26f7642-7545-4e18-9b75-8c9bbdee3a9a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-1a4e592a-6a6e-44a5-9814-e36264ca96e7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7796937f-307b-4598-941c-67d3a05ebfe7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-c5447c04-a4d7-4ba8-a263-c9ee321a6858\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-41388f1c-2db0-4c25-95b2-35d7f5ccbfa9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b02aacc0-b073-424e-8298-42b22829ee0a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-057d6cfe-9c4f-4a6d-bc60-14420ea1f1a9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0ec47710-77ff-4a3d-9181-6aa50af424d0\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-48af4db5-9b8b-401c-8e74-076be876a430\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-82339799-d096-41ae-8538-b108becf0970\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1b7aa243-30e4-4c9e-bca8-d0d3022b634a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-bb91dfba-c30d-4263-9add-9c2384e659a6\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e71308d3-144b-4262-b144-efdc3cc90517\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2bdd0062-9d75-436e-89df-487dd8e4b3c7\" : { \n    \"value\" : \"Disabled\"\n    },\n    \"effect-4733ea7b-a883-42fe-8cac-97454c2a9e4a\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-67121cc7-ff39-4ab8-b7e3-95b84dab487d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-6fac406b-40ca-413b-bf8e-0bf964659c25\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-81e74cea-30fd-40d5-802f-d72103c2aaaa\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c349d81b-9985-44ae-a8da-ff98d108ede8\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-f4b53539-8df9-40e4-86c6-6b607703bd4e\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-ec068d99-e9c7-401f-8cef-5bdde4e6ccf1\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-048248b0-55cd-46da-b1ff-39efd52db260\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0d134df8-db83-46fb-ad72-fe0c9428c8dd\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2c89a2e5-7285-40fe-afe0-ae8654b92fb2\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-3657f5a0-770e-44a3-b44e-9431ba1e9735\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-617c02be-7f02-4efd-8836-3180d47b6c68\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-7d7be79c-23ba-4033-84dd-45e2a5ccdd67\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-87ba29ef-1ab3-4d82-b763-87fcd4f531f7\" : { \n    \"value\" : \"audit\"\n    },\n    \"effect-f7d52b2d-e161-4dfa-a82b-55e564167385\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c43e4a30-77cb-48ab-a4dd-93f175c63b57\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1f314764-cb73-4fc9-b863-8eca98ac36e9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-123a3936-f020-408a-ba0c-47873faf1534\" : { \n    \"value\" : \"AuditIfNotExists\"\n    }\n}\n', '<LAWORKSPACE>', reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName')), '2021-06-01').customerId))))[variables('modifiedAssignment')].parameters]"
              },
              "identity": {
                "type": "SystemAssigned"
              }
            }
          ]
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc')))]",
        "[subscriptionResourceId(parameters('operationsSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-operations-rg-{0}', parameters('nowUtc')))]"
      ]
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "[format('assign-policy-{0}', parameters('identityResourceGroupName'))]",
      "subscriptionId": "[parameters('identitySubscriptionId')]",
      "resourceGroup": "[parameters('identityResourceGroupName')]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "builtInAssignment": {
            "value": "[parameters('policy')]"
          },
          "logAnalyticsWorkspaceName": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value]"
          },
          "logAnalyticsWorkspaceResourceGroupName": {
            "value": "[reference(subscriptionResourceId(parameters('operationsSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-operations-rg-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value]"
          },
          "operationsSubscriptionId": {
            "value": "[parameters('operationsSubscriptionId')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "3675806177489000536"
            }
          },
          "parameters": {
            "builtInAssignment": {
              "type": "string",
              "defaultValue": ""
            },
            "logAnalyticsWorkspaceName": {
              "type": "string"
            },
            "logAnalyticsWorkspaceResourceGroupName": {
              "type": "string"
            },
            "operationsSubscriptionId": {
              "type": "string"
            }
          },
          "functions": [],
          "variables": {
            "modifiedAssignment": "[if(and(equals(toLower(environment().name), toLower('AzureCloud')), equals(toLower(parameters('builtInAssignment')), toLower('IL5'))), 'NIST', parameters('builtInAssignment'))]",
            "assignmentName": "[format('{0} {1}', variables('modifiedAssignment'), resourceGroup().name)]"
          },
          "resources": [
            {
              "condition": "[not(empty(variables('modifiedAssignment')))]",
              "type": "Microsoft.Authorization/policyAssignments",
              "apiVersion": "2020-09-01",
              "name": "[variables('assignmentName')]",
              "location": "[resourceGroup().location]",
              "properties": {
                "policyDefinitionId": "[createObject('NIST', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f', 'parameters', json(replace('    {\n        \"listOfMembersToExcludeFromWindowsVMAdministratorsGroup\": \n        {\n        \"value\": \"admin\"\n        },\n        \"listOfMembersToIncludeInWindowsVMAdministratorsGroup\": \n        {\n        \"value\": \"azureuser\"\n        },\n        \"logAnalyticsWorkspaceIdforVMReporting\": \n        {\n        \"value\": \"<LAWORKSPACE>\"\n        },\n        \"IncludeArcMachines\": \n        {\n            \"value\": \"true\"\n        },\n        \"MinimumTLSVersion-5752e6d6-1206-46d8-8ab1-ecc2f71a8112\": \n        {\n            \"value\": \"1.2\"\n        },\n        \"NotAvailableMachineState-bed48b13-6647-468e-aa2f-1af1d3f4dd40\": \n        {\n            \"value\": \"Compliant\"\n        },\n        \"requiredRetentionDays\": \n        {\n            \"value\": \"365\"\n        },\n        \"resourceGroupName-b6e2945c-0b7b-40f5-9233-7a5323b5cdc6\": \n        {\n            \"value\": \"NetworkWatcherRG\"\n        }\n    }', '<LAWORKSPACE>', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))))), 'IL5', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/f9a961fa-3241-4b20-adc4-bbf8ad9d7197', 'parameters', json(replace('{\n    \"IncludeArcMachines\" : { \n        \"value\" : \"false\"\n        },\n        \"NotAvailableMachineState-bed48b13-6647-468e-aa2f-1af1d3f4dd40\" : { \n        \"value\" : \"Compliant\"\n        },\n        \"MinimumTLSVersionForWindowsServers\" : { \n        \"value\" : \"1.2\"\n        },\n        \"requiredRetentionDays\" : { \n        \"value\" : \"365\"\n        },\n        \"effect-febd0533-8e55-448f-b837-bd0e06f16469\" : { \n        \"value\" : \"audit\"\n        },\n        \"allowedContainerImagesRegex-febd0533-8e55-448f-b837-bd0e06f16469\" : { \n        \"value\" : \"^(.+){0}$\"\n        },\n        \"effect-95edb821-ddaf-4404-9732-666045e056b4\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-440b515e-a580-421e-abeb-b159a61ddcbc\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-233a2a17-77ca-4fb1-9b6b-69223d272a44\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"audit\"\n        },\n        \"cpuLimit-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"0\"\n        },\n        \"memoryLimit-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"0\"\n        },\n        \"effect-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"audit\"\n        },\n        \"runAsUserRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"MustRunAsNonRoot\"\n        },\n        \"runAsGroupRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"supplementalGroupsRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"fsGroupRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"effect-1c6e92c9-99f0-4e55-9cf2-0c234dc48f99\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-df49d893-a74c-421d-bc95-c663042e5b80\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-c26596ff-4d70-4e6a-9a30-c2506bd2f80c\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-511f5417-5d12-434d-ab2e-816901e72a5e\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-82985f06-dc18-4a48-bc1c-b9f4f0098cfe\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-098fc59e-46c7-4d99-9b16-64990e543d75\" : { \n        \"value\" : \"audit\"\n        },\n        \"NetworkWatcherResourceGroupName\" : { \n        \"value\" : \"NetworkWatcherRG\"\n        },\n        \"setting-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n        \"value\" : \"enabled\"\n        },\n        \"aadAuthenticationInServiceFabricMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-71ef260a-8f18-47b7-abcb-62d0673d94dc\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-055aa869-bc98-4af8-bafc-23f1ab6ffe2c\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-564feb30-bf6a-4854-b4bb-0d2d2d1e6c66\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-d9da03a1-f3c3-412a-9709-947156872263\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-617c02be-7f02-4efd-8836-3180d47b6c68\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ec068d99-e9c7-401f-8cef-5bdde4e6ccf1\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-c349d81b-9985-44ae-a8da-ff98d108ede8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-3657f5a0-770e-44a3-b44e-9431ba1e9735\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-b4ac1030-89c5-4697-8e00-28b5ba6a8811\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-ea0dfaed-95fb-448c-934e-d6e713ce393d\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-4733ea7b-a883-42fe-8cac-97454c2a9e4a\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-f4b53539-8df9-40e4-86c6-6b607703bd4e\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-41425d9f-d1a5-499a-9932-f8ed8453932c\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-fc4d8e41-e223-45ea-9bf5-eada37891d87\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-86efb160-8de7-451d-bc08-5d475b0aadae\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-4ec52d6d-beb7-40c4-9a9e-fe753254690e\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-64d314f6-6062-4780-a861-c23e8951bee5\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1fd32ebd-e4c3-4e13-a54a-d7422d4d95f6\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-fa298e57-9444-42ba-bf04-86e8470e32c7\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-67121cc7-ff39-4ab8-b7e3-95b84dab487d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1f905d99-2ab7-462c-a6b0-f709acca6c8f\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ba769a63-b8cc-4b2d-abf6-ac33c7204be8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-81e74cea-30fd-40d5-802f-d72103c2aaaa\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0aa61e00-0a01-4a3c-9945-e93cffedf0e6\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-47031206-ce96-41f8-861b-6a915f3de284\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-87ba29ef-1ab3-4d82-b763-87fcd4f531f7\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-51522a96-0869-4791-82f3-981000c2c67f\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-b5ec538c-daa0-4006-8596-35468b9148e8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-56a5ee18-2ae6-4810-86f7-18e39ce5629b\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-2e94d99a-8a36-4563-bc77-810d8893b671\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1fafeaf6-7927-4059-a50a-8eb2a7a6f2b5\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-99e9ccd8-3db9-4592-b0d1-14b1715a4d8a\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1f68a601-6e6d-4e42-babf-3f643a047ea2\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-f7d52b2d-e161-4dfa-a82b-55e564167385\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-7d7be79c-23ba-4033-84dd-45e2a5ccdd67\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ca91455f-eace-4f96-be59-e6e2c35b4816\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-702dd420-7fcc-42c5-afe8-4026edd20fe0\" : { \n        \"value\" : \"Audit\"\n        },\n        \"diagnosticsLogsInRedisCacheMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"secureTransferToStorageAccountMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-d0793b48-0edc-4296-a390-4c75d1bdfd71\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-7d092e0a-7acd-40d2-a975-dca21cae48c4\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-2a1a9cdf-e04d-429a-8416-3bfb72a1b26f\" : { \n        \"value\" : \"Audit\"\n        },\n        \"disableUnrestrictedNetworkToStorageAccountMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-55615ac9-af46-4a59-874e-391cc3dfb490\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1b8ca024-1d5c-4dec-8995-b1a932b41780\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-037eea7a-bd0a-46c5-9a66-03aea78705d3\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-53503636-bcc9-4748-9663-5348217f160f\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-40cec1dd-a100-4920-b15b-3024fe8901ab\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0725b4dd-7e76-479c-a735-68e7ee23d5ca\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-a049bf77-880b-470f-ba6d-9f21c530cf83\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ee980b6d-0eca-4501-8d54-f6290fd512c3\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1d84d5fb-01f6-4d12-ba4f-4a26081d403d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-37e0d2fe-28a5-43d6-a273-67d37d1f5606\" : { \n        \"value\" : \"Audit\"\n        },\n        \"identityDesignateMoreThanOneOwnerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"diskEncryptionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"emailNotificationToSubscriptionOwnerHighSeverityAlertsEnabledEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlDbEncryptionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vulnerabilityAssessmentOnManagedInstanceMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePHPVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"aadAuthenticationInSqlServerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vmssEndpointProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vmssOsVulnerabilitiesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"adaptiveApplicationControlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"geoRedundantBackupShouldBeEnabledForAzureDatabaseForPostgreSQLEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"ensureJavaVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityDesignateLessThanOwnersMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"securityContactEmailAddressForSubscriptionEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppRestrictCORSAccessMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveDeprecatedAccountMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"ensurePythonVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePythonVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePHPVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePythonVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"geoRedundantBackupShouldBeEnabledForAzureDatabaseForMySQLEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"systemUpdatesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureJavaVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForWritePermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureJavaVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"nextGenerationFirewallMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"useRbacRulesMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"webAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"sqlServerAuditingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vnetEnableDDoSProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlServerAdvancedDataSecurityMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"endpointProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"jitNetworkAccessMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"geoRedundantStorageShouldBeEnabledForStorageAccountsEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"vmssSystemUpdatesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"longtermGeoRedundantBackupEnabledAzureSQLDatabasesEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"systemConfigurationsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForReadPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"containerBenchmarkMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vulnerabilityAssessmentOnServerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"kubernetesServiceVersionUpToDateMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"sqlDbVulnerabilityAssesmentMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"membersToIncludeInLocalAdministratorsGroup\" : { \n        \"value\" : \"\"\n        },\n        \"membersToExcludeInLocalAdministratorsGroup\" : { \n        \"value\" : \"\"\n        },\n        \"logAnalyticsWorkspaceIDForVMAgents\" : { \n        \"value\" : \"<LAWORKSPACE>\"\n        },\n        \"PHPLatestVersionForAppServices\" : { \n        \"value\" : \"7.4\"\n        },\n        \"JavaLatestVersionForAppServices\" : { \n        \"value\" : \"11\"\n        },\n        \"WindowsPythonLatestVersionForAppServices\" : { \n        \"value\" : \"3.6\"\n        },\n        \"LinuxPythonLatestVersionForAppServices\" : { \n        \"value\" : \"3.9\"\n        },\n        \"ensureDotNetFrameworkLatestForFunctionAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityEmailsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"vulnerabilityAssessmentMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensureDotNetFrameworkLatestForWebAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlServerAdvancedDataSecurityEmailsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"microsoftIaaSAntimalwareExtensionShouldBeDeployedOnWindowsServersEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"securityCenterStandardPricingTierShouldBeSelectedEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"theLogAnalyticsAgentShouldBeInstalledOnVirtualMachinesEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensurePHPVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityEmailAdminsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"securityContactPhoneNumberShouldBeProvidedForSubscriptionEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"threatDetectionTypesOnManagedInstanceMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensureDotNetFrameworkLatestForAPIAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlServerAdvancedDataSecurityEmailAdminsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"threatDetectionTypesOnServerMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"theLogAnalyticsAgentShouldBeInstalledOnVirtualMachineScaleSetsEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        }\n}', '<LAWORKSPACE>', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))))), 'CMMC', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/b5629c75-5c77-4422-87b9-2509e680f8de', 'parameters', json(replace('{\n    \"logAnalyticsWorkspaceId-f47b5582-33ec-4c5c-87c0-b010a6b2e917\" : { \n        \"value\" : \"<LAWORKSPACE>\"\n    },\n    \"effect-09024ccc-0c5f-475e-9457-b7c0d9ed487b\" : { \n        \"value\" : \"AuditIfNotExists\"\n    },\n    \"MembersToExclude-69bf4abd-ca1e-4cf6-8b5a-762d42e61d4f\" :{\n        \"value\": \"\"\n    },\n    \"MembersToInclude-30f71ea1-ac77-4f26-9fc5-2d926bbd4ba7\": {\n        \"value\": \"\"\n    },\n    \"effect-0961003e-5a0a-4549-abde-af6a37f2724d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0b15565f-aa9e-48ba-8619-45960f2c314d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0e60b895-3786-45da-8377-9c6b4b6ac5f9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-17k78e20-9358-41c9-923c-fb736d382a12\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-1bc1795e-d44a-4d48-9b3b-6fff0fd5f9ba\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"PHPLatestVersion\" : { \n    \"value\" : \"7.3\"\n    },\n    \"effect-22bee202-a82f-4305-9a2a-6d7f44d4dedb\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-26a828e1-e88f-464e-bbb3-c134a282b9de\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-34c877ad-507e-4c82-993e-3452a6e0ad3c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-404c3081-a854-4457-ae30-26a93ef643f9\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-47a6b606-51aa-4496-8bb7-64b11cf66adc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-496223c3-ad65-4ecd-878a-bae78737e9ed\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"JavaLatestVersion\" : { \n    \"value\" : \"11\"\n    },\n    \"effect-4f11b553-d42e-4e3a-89be-32ca364cad4c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5c607a2e-c700-4744-8254-d77e7c9eb5e4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5f76cf89-fbf2-47fd-a3f4-b891fa780b60\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6b1cbf55-e8b6-442f-ba4c-7246b6381474\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-7008174a-fd10-4ef0-817e-fc820a951d73\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"LinuxPythonLatestVersion\" : { \n    \"value\" : \"3.8\"\n    },\n    \"effect-7238174a-fd10-4ef0-817e-fc820a951d73\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7261b898-8a84-4db8-9e04-18527132abb3\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-74c3584d-afae-46f7-a20a-6f8adba71a16\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-86b3d65f-7626-441e-b690-81a8b71cff60\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-88999f4c-376a-45c8-bcb3-4058f713cf39\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-8c122334-9d20-4eb8-89ea-ac9a705b74ae\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9297c21d-2ed6-4474-b48f-163f75654ce3\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-991310cd-e9f3-47bc-b7b6-f57b557d07db\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9b597639-28e4-48eb-b506-56b05d366257\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9d0b6ea4-93e2-4578-bf2f-6bb17d22b4bc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9daedab3-fb2d-461e-b861-71790eead4f6\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-a4af4a39-4135-47fb-b175-47fbdf85311d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"setting-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n    \"value\" : \"enabled\"\n    },\n    \"effect-a70ca396-0a34-413a-88e1-b956c1e683be\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-aa633080-8b72-40c4-a2d7-d00c03e80bed\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-af6cd1bd-1635-48cb-bde7-5b15693900b9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"resourceGroupName-b6e2945c-0b7b-40f5-9233-7a5323b5cdc6\" : { \n    \"value\" : \"NetworkWatcherRG\"\n    },\n    \"effect-b7ddfbdc-1260-477d-91fd-98bd9be789a6\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c3f317a7-a95c-4547-b7e7-11017ebdf2fe\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-cb510bfd-1cba-4d9f-a230-cb0976f4bb71\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e2c1c086-2d84-4019-bff3-c44ccd95113c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e3576e28-8b17-4677-84c3-db2990658d64\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e8cbc669-f12d-49eb-93e7-9273119e9933\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e9c8d085-d9cc-4b17-9cdc-059f1f01f19e\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ebb62a0c-3560-49e1-89ed-27e074e9f8ad\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-efbde977-ba53-4479-b8e9-10b957924fbf\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f6de0be7-9a8a-4b8a-b349-43cf02d22f7c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f8456c1c-aa66-4dfb-861a-25d127b775c9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f9d614c5-c173-4d56-95a7-b4437057d193\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-fb893a29-21bb-418c-a157-e99480ec364c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-feedbf84-6b99-488c-acc2-71c829aa5ffc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-3b980d31-7904-4bb7-8575-5665739a8052\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6e2593d9-add6-4083-9c9b-4b7d2188c899\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-12430be1-6cc8-4527-a9a8-e3d38f250096\" : { \n    \"value\" : \"Audit\"\n    },\n    \"modeRequirement-12430be1-6cc8-4527-a9a8-e3d38f250096\" : { \n    \"value\" : \"Detection\"\n    },\n    \"effect-425bea59-a659-4cbb-8d31-34499bd030b8\" : { \n    \"value\" : \"Audit\"\n    },\n    \"modeRequirement-425bea59-a659-4cbb-8d31-34499bd030b8\" : { \n    \"value\" : \"Detection\"\n    },\n    \"effect-564feb30-bf6a-4854-b4bb-0d2d2d1e6c66\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-055aa869-bc98-4af8-bafc-23f1ab6ffe2c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-013e242c-8828-4970-87b3-ab247555486d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-d38fc420-0735-4ef3-ac11-c806f651a570\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-a1181c5f-672a-477a-979a-7d58aa086233\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-308fbb08-4ab8-4e67-9b29-592e93fb94fa\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-4da35fc9-c9e7-4960-aec9-797fe7d9051d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-523b5cd1-3e23-492f-a539-13118b6d1e3a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7fe3b40f-802b-4cdd-8bd4-fd799c948cc2\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-c25d9a16-bc35-4e15-a7e5-9db606bf9ed4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b0f33259-77d7-4c9e-aac6-3aabcfae693c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-037eea7a-bd0a-46c5-9a66-03aea78705d3\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-0725b4dd-7e76-479c-a735-68e7ee23d5ca\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-0820b7b9-23aa-4725-a1ce-ae4558f718e5\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2c89a2e5-7285-40fe-afe0-ae8654b92fab\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-358c20a6-3f9e-4f0e-97ff-c6ce485e2aac\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5744710e-cc2f-4ee8-8809-3b11e89f4bc9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ac4a19c2-fa67-49b4-8ae5-0b2e78c49457\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c9d007d0-c057-4772-b18c-01e546713bcd\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-d0793b48-0edc-4296-a390-4c75d1bdfd71\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-e372f825-a257-4fb8-9175-797a8a8627d6\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-d158790f-bfb0-486c-8631-2dc6b4e8e6af\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-e802a67a-daf5-4436-9ea6-f6d821dd0c5d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-a451c1ef-c6ca-483d-87ed-f49761e3ffb5\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftSql-servers-firewallRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftClassicNetwork-networkSecurityGroups-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-securityRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftClassicNetwork-networkSecurityGroups-securityRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ae89ebca-1c92-4898-ac2c-9f63decb045c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-d26f7642-7545-4e18-9b75-8c9bbdee3a9a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-1a4e592a-6a6e-44a5-9814-e36264ca96e7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7796937f-307b-4598-941c-67d3a05ebfe7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-c5447c04-a4d7-4ba8-a263-c9ee321a6858\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-41388f1c-2db0-4c25-95b2-35d7f5ccbfa9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b02aacc0-b073-424e-8298-42b22829ee0a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-057d6cfe-9c4f-4a6d-bc60-14420ea1f1a9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0ec47710-77ff-4a3d-9181-6aa50af424d0\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-48af4db5-9b8b-401c-8e74-076be876a430\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-82339799-d096-41ae-8538-b108becf0970\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1b7aa243-30e4-4c9e-bca8-d0d3022b634a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-bb91dfba-c30d-4263-9add-9c2384e659a6\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e71308d3-144b-4262-b144-efdc3cc90517\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2bdd0062-9d75-436e-89df-487dd8e4b3c7\" : { \n    \"value\" : \"Disabled\"\n    },\n    \"effect-4733ea7b-a883-42fe-8cac-97454c2a9e4a\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-67121cc7-ff39-4ab8-b7e3-95b84dab487d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-6fac406b-40ca-413b-bf8e-0bf964659c25\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-81e74cea-30fd-40d5-802f-d72103c2aaaa\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c349d81b-9985-44ae-a8da-ff98d108ede8\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-f4b53539-8df9-40e4-86c6-6b607703bd4e\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-ec068d99-e9c7-401f-8cef-5bdde4e6ccf1\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-048248b0-55cd-46da-b1ff-39efd52db260\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0d134df8-db83-46fb-ad72-fe0c9428c8dd\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2c89a2e5-7285-40fe-afe0-ae8654b92fb2\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-3657f5a0-770e-44a3-b44e-9431ba1e9735\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-617c02be-7f02-4efd-8836-3180d47b6c68\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-7d7be79c-23ba-4033-84dd-45e2a5ccdd67\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-87ba29ef-1ab3-4d82-b763-87fcd4f531f7\" : { \n    \"value\" : \"audit\"\n    },\n    \"effect-f7d52b2d-e161-4dfa-a82b-55e564167385\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c43e4a30-77cb-48ab-a4dd-93f175c63b57\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1f314764-cb73-4fc9-b863-8eca98ac36e9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-123a3936-f020-408a-ba0c-47873faf1534\" : { \n    \"value\" : \"AuditIfNotExists\"\n    }\n}\n', '<LAWORKSPACE>', reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName')), '2021-06-01').customerId))))[variables('modifiedAssignment')].id]",
                "parameters": "[createObject('NIST', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f', 'parameters', json(replace('    {\n        \"listOfMembersToExcludeFromWindowsVMAdministratorsGroup\": \n        {\n        \"value\": \"admin\"\n        },\n        \"listOfMembersToIncludeInWindowsVMAdministratorsGroup\": \n        {\n        \"value\": \"azureuser\"\n        },\n        \"logAnalyticsWorkspaceIdforVMReporting\": \n        {\n        \"value\": \"<LAWORKSPACE>\"\n        },\n        \"IncludeArcMachines\": \n        {\n            \"value\": \"true\"\n        },\n        \"MinimumTLSVersion-5752e6d6-1206-46d8-8ab1-ecc2f71a8112\": \n        {\n            \"value\": \"1.2\"\n        },\n        \"NotAvailableMachineState-bed48b13-6647-468e-aa2f-1af1d3f4dd40\": \n        {\n            \"value\": \"Compliant\"\n        },\n        \"requiredRetentionDays\": \n        {\n            \"value\": \"365\"\n        },\n        \"resourceGroupName-b6e2945c-0b7b-40f5-9233-7a5323b5cdc6\": \n        {\n            \"value\": \"NetworkWatcherRG\"\n        }\n    }', '<LAWORKSPACE>', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))))), 'IL5', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/f9a961fa-3241-4b20-adc4-bbf8ad9d7197', 'parameters', json(replace('{\n    \"IncludeArcMachines\" : { \n        \"value\" : \"false\"\n        },\n        \"NotAvailableMachineState-bed48b13-6647-468e-aa2f-1af1d3f4dd40\" : { \n        \"value\" : \"Compliant\"\n        },\n        \"MinimumTLSVersionForWindowsServers\" : { \n        \"value\" : \"1.2\"\n        },\n        \"requiredRetentionDays\" : { \n        \"value\" : \"365\"\n        },\n        \"effect-febd0533-8e55-448f-b837-bd0e06f16469\" : { \n        \"value\" : \"audit\"\n        },\n        \"allowedContainerImagesRegex-febd0533-8e55-448f-b837-bd0e06f16469\" : { \n        \"value\" : \"^(.+){0}$\"\n        },\n        \"effect-95edb821-ddaf-4404-9732-666045e056b4\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-440b515e-a580-421e-abeb-b159a61ddcbc\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-233a2a17-77ca-4fb1-9b6b-69223d272a44\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"audit\"\n        },\n        \"cpuLimit-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"0\"\n        },\n        \"memoryLimit-e345eecc-fa47-480f-9e88-67dcc122b164\" : { \n        \"value\" : \"0\"\n        },\n        \"effect-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"audit\"\n        },\n        \"runAsUserRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"MustRunAsNonRoot\"\n        },\n        \"runAsGroupRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"supplementalGroupsRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"fsGroupRule-f06ddb64-5fa3-4b77-b166-acb36f7f6042\" : { \n        \"value\" : \"RunAsAny\"\n        },\n        \"effect-1c6e92c9-99f0-4e55-9cf2-0c234dc48f99\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-df49d893-a74c-421d-bc95-c663042e5b80\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-c26596ff-4d70-4e6a-9a30-c2506bd2f80c\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-511f5417-5d12-434d-ab2e-816901e72a5e\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-82985f06-dc18-4a48-bc1c-b9f4f0098cfe\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-098fc59e-46c7-4d99-9b16-64990e543d75\" : { \n        \"value\" : \"audit\"\n        },\n        \"NetworkWatcherResourceGroupName\" : { \n        \"value\" : \"NetworkWatcherRG\"\n        },\n        \"setting-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n        \"value\" : \"enabled\"\n        },\n        \"aadAuthenticationInServiceFabricMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-71ef260a-8f18-47b7-abcb-62d0673d94dc\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-055aa869-bc98-4af8-bafc-23f1ab6ffe2c\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-564feb30-bf6a-4854-b4bb-0d2d2d1e6c66\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-d9da03a1-f3c3-412a-9709-947156872263\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-617c02be-7f02-4efd-8836-3180d47b6c68\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ec068d99-e9c7-401f-8cef-5bdde4e6ccf1\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-c349d81b-9985-44ae-a8da-ff98d108ede8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-3657f5a0-770e-44a3-b44e-9431ba1e9735\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-b4ac1030-89c5-4697-8e00-28b5ba6a8811\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-ea0dfaed-95fb-448c-934e-d6e713ce393d\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-4733ea7b-a883-42fe-8cac-97454c2a9e4a\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-f4b53539-8df9-40e4-86c6-6b607703bd4e\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-41425d9f-d1a5-499a-9932-f8ed8453932c\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-fc4d8e41-e223-45ea-9bf5-eada37891d87\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-86efb160-8de7-451d-bc08-5d475b0aadae\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-4ec52d6d-beb7-40c4-9a9e-fe753254690e\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-64d314f6-6062-4780-a861-c23e8951bee5\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1fd32ebd-e4c3-4e13-a54a-d7422d4d95f6\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-fa298e57-9444-42ba-bf04-86e8470e32c7\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-67121cc7-ff39-4ab8-b7e3-95b84dab487d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1f905d99-2ab7-462c-a6b0-f709acca6c8f\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ba769a63-b8cc-4b2d-abf6-ac33c7204be8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-81e74cea-30fd-40d5-802f-d72103c2aaaa\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0aa61e00-0a01-4a3c-9945-e93cffedf0e6\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-47031206-ce96-41f8-861b-6a915f3de284\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-87ba29ef-1ab3-4d82-b763-87fcd4f531f7\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-51522a96-0869-4791-82f3-981000c2c67f\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-b5ec538c-daa0-4006-8596-35468b9148e8\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-56a5ee18-2ae6-4810-86f7-18e39ce5629b\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-2e94d99a-8a36-4563-bc77-810d8893b671\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1fafeaf6-7927-4059-a50a-8eb2a7a6f2b5\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-99e9ccd8-3db9-4592-b0d1-14b1715a4d8a\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1f68a601-6e6d-4e42-babf-3f643a047ea2\" : { \n        \"value\" : \"audit\"\n        },\n        \"effect-f7d52b2d-e161-4dfa-a82b-55e564167385\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-7d7be79c-23ba-4033-84dd-45e2a5ccdd67\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ca91455f-eace-4f96-be59-e6e2c35b4816\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-702dd420-7fcc-42c5-afe8-4026edd20fe0\" : { \n        \"value\" : \"Audit\"\n        },\n        \"diagnosticsLogsInRedisCacheMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"secureTransferToStorageAccountMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-d0793b48-0edc-4296-a390-4c75d1bdfd71\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-7d092e0a-7acd-40d2-a975-dca21cae48c4\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-2a1a9cdf-e04d-429a-8416-3bfb72a1b26f\" : { \n        \"value\" : \"Audit\"\n        },\n        \"disableUnrestrictedNetworkToStorageAccountMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-55615ac9-af46-4a59-874e-391cc3dfb490\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1b8ca024-1d5c-4dec-8995-b1a932b41780\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-037eea7a-bd0a-46c5-9a66-03aea78705d3\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-53503636-bcc9-4748-9663-5348217f160f\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-40cec1dd-a100-4920-b15b-3024fe8901ab\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-0725b4dd-7e76-479c-a735-68e7ee23d5ca\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-a049bf77-880b-470f-ba6d-9f21c530cf83\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-ee980b6d-0eca-4501-8d54-f6290fd512c3\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-1d84d5fb-01f6-4d12-ba4f-4a26081d403d\" : { \n        \"value\" : \"Audit\"\n        },\n        \"effect-37e0d2fe-28a5-43d6-a273-67d37d1f5606\" : { \n        \"value\" : \"Audit\"\n        },\n        \"identityDesignateMoreThanOneOwnerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"diskEncryptionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"emailNotificationToSubscriptionOwnerHighSeverityAlertsEnabledEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlDbEncryptionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vulnerabilityAssessmentOnManagedInstanceMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePHPVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"aadAuthenticationInSqlServerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vmssEndpointProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vmssOsVulnerabilitiesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"adaptiveApplicationControlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"geoRedundantBackupShouldBeEnabledForAzureDatabaseForPostgreSQLEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"ensureJavaVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityDesignateLessThanOwnersMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"securityContactEmailAddressForSubscriptionEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppRestrictCORSAccessMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveDeprecatedAccountMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"ensurePythonVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePythonVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePHPVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensurePythonVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"geoRedundantBackupShouldBeEnabledForAzureDatabaseForMySQLEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"systemUpdatesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureJavaVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForWebAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForWritePermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForAPIAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureJavaVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"nextGenerationFirewallMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"useRbacRulesMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"webAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"sqlServerAuditingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vnetEnableDDoSProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlServerAdvancedDataSecurityMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"endpointProtectionMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"jitNetworkAccessMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppEnforceHttpsMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"geoRedundantStorageShouldBeEnabledForStorageAccountsEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"vmssSystemUpdatesMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"longtermGeoRedundantBackupEnabledAzureSQLDatabasesEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"systemConfigurationsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"ensureHTTPVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityEnableMFAForReadPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"containerBenchmarkMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"apiAppDisableRemoteDebuggingMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"vulnerabilityAssessmentOnServerMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"webAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"functionAppRequireLatestTlsMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"kubernetesServiceVersionUpToDateMonitoringEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"sqlDbVulnerabilityAssesmentMonitoringEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        },\n        \"membersToIncludeInLocalAdministratorsGroup\" : { \n        \"value\" : \"\"\n        },\n        \"membersToExcludeInLocalAdministratorsGroup\" : { \n        \"value\" : \"\"\n        },\n        \"logAnalyticsWorkspaceIDForVMAgents\" : { \n        \"value\" : \"<LAWORKSPACE>\"\n        },\n        \"PHPLatestVersionForAppServices\" : { \n        \"value\" : \"7.4\"\n        },\n        \"JavaLatestVersionForAppServices\" : { \n        \"value\" : \"11\"\n        },\n        \"WindowsPythonLatestVersionForAppServices\" : { \n        \"value\" : \"3.6\"\n        },\n        \"LinuxPythonLatestVersionForAppServices\" : { \n        \"value\" : \"3.9\"\n        },\n        \"ensureDotNetFrameworkLatestForFunctionAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityEmailsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"vulnerabilityAssessmentMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensureDotNetFrameworkLatestForWebAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlServerAdvancedDataSecurityEmailsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"microsoftIaaSAntimalwareExtensionShouldBeDeployedOnWindowsServersEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"securityCenterStandardPricingTierShouldBeSelectedEffect\" : { \n        \"value\" : \"Audit\"\n        },\n        \"theLogAnalyticsAgentShouldBeInstalledOnVirtualMachinesEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensurePHPVersionLatestForFunctionAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlManagedInstanceAdvancedDataSecurityEmailAdminsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"securityContactPhoneNumberShouldBeProvidedForSubscriptionEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"threatDetectionTypesOnManagedInstanceMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"ensureDotNetFrameworkLatestForAPIAppEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"sqlServerAdvancedDataSecurityEmailAdminsMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"threatDetectionTypesOnServerMonitoringEffect\" : { \n        \"value\" : \"Disabled\"\n        },\n        \"theLogAnalyticsAgentShouldBeInstalledOnVirtualMachineScaleSetsEffect\" : { \n        \"value\" : \"AuditIfNotExists\"\n        }\n}', '<LAWORKSPACE>', extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))))), 'CMMC', createObject('id', '/providers/Microsoft.Authorization/policySetDefinitions/b5629c75-5c77-4422-87b9-2509e680f8de', 'parameters', json(replace('{\n    \"logAnalyticsWorkspaceId-f47b5582-33ec-4c5c-87c0-b010a6b2e917\" : { \n        \"value\" : \"<LAWORKSPACE>\"\n    },\n    \"effect-09024ccc-0c5f-475e-9457-b7c0d9ed487b\" : { \n        \"value\" : \"AuditIfNotExists\"\n    },\n    \"MembersToExclude-69bf4abd-ca1e-4cf6-8b5a-762d42e61d4f\" :{\n        \"value\": \"\"\n    },\n    \"MembersToInclude-30f71ea1-ac77-4f26-9fc5-2d926bbd4ba7\": {\n        \"value\": \"\"\n    },\n    \"effect-0961003e-5a0a-4549-abde-af6a37f2724d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0b15565f-aa9e-48ba-8619-45960f2c314d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0e60b895-3786-45da-8377-9c6b4b6ac5f9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-17k78e20-9358-41c9-923c-fb736d382a12\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-1bc1795e-d44a-4d48-9b3b-6fff0fd5f9ba\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"PHPLatestVersion\" : { \n    \"value\" : \"7.3\"\n    },\n    \"effect-22bee202-a82f-4305-9a2a-6d7f44d4dedb\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-26a828e1-e88f-464e-bbb3-c134a282b9de\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-34c877ad-507e-4c82-993e-3452a6e0ad3c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-404c3081-a854-4457-ae30-26a93ef643f9\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-47a6b606-51aa-4496-8bb7-64b11cf66adc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-496223c3-ad65-4ecd-878a-bae78737e9ed\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"JavaLatestVersion\" : { \n    \"value\" : \"11\"\n    },\n    \"effect-4f11b553-d42e-4e3a-89be-32ca364cad4c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5c607a2e-c700-4744-8254-d77e7c9eb5e4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5f76cf89-fbf2-47fd-a3f4-b891fa780b60\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6b1cbf55-e8b6-442f-ba4c-7246b6381474\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-7008174a-fd10-4ef0-817e-fc820a951d73\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"LinuxPythonLatestVersion\" : { \n    \"value\" : \"3.8\"\n    },\n    \"effect-7238174a-fd10-4ef0-817e-fc820a951d73\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7261b898-8a84-4db8-9e04-18527132abb3\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-74c3584d-afae-46f7-a20a-6f8adba71a16\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-86b3d65f-7626-441e-b690-81a8b71cff60\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-88999f4c-376a-45c8-bcb3-4058f713cf39\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-8c122334-9d20-4eb8-89ea-ac9a705b74ae\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9297c21d-2ed6-4474-b48f-163f75654ce3\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-991310cd-e9f3-47bc-b7b6-f57b557d07db\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9b597639-28e4-48eb-b506-56b05d366257\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9d0b6ea4-93e2-4578-bf2f-6bb17d22b4bc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-9daedab3-fb2d-461e-b861-71790eead4f6\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-a4af4a39-4135-47fb-b175-47fbdf85311d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"setting-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\" : { \n    \"value\" : \"enabled\"\n    },\n    \"effect-a70ca396-0a34-413a-88e1-b956c1e683be\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-aa633080-8b72-40c4-a2d7-d00c03e80bed\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-af6cd1bd-1635-48cb-bde7-5b15693900b9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"resourceGroupName-b6e2945c-0b7b-40f5-9233-7a5323b5cdc6\" : { \n    \"value\" : \"NetworkWatcherRG\"\n    },\n    \"effect-b7ddfbdc-1260-477d-91fd-98bd9be789a6\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c3f317a7-a95c-4547-b7e7-11017ebdf2fe\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-cb510bfd-1cba-4d9f-a230-cb0976f4bb71\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e2c1c086-2d84-4019-bff3-c44ccd95113c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e3576e28-8b17-4677-84c3-db2990658d64\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e8cbc669-f12d-49eb-93e7-9273119e9933\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e9c8d085-d9cc-4b17-9cdc-059f1f01f19e\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ebb62a0c-3560-49e1-89ed-27e074e9f8ad\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-efbde977-ba53-4479-b8e9-10b957924fbf\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f6de0be7-9a8a-4b8a-b349-43cf02d22f7c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f8456c1c-aa66-4dfb-861a-25d127b775c9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-f9d614c5-c173-4d56-95a7-b4437057d193\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-fb893a29-21bb-418c-a157-e99480ec364c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-feedbf84-6b99-488c-acc2-71c829aa5ffc\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-3b980d31-7904-4bb7-8575-5665739a8052\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-6e2593d9-add6-4083-9c9b-4b7d2188c899\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-12430be1-6cc8-4527-a9a8-e3d38f250096\" : { \n    \"value\" : \"Audit\"\n    },\n    \"modeRequirement-12430be1-6cc8-4527-a9a8-e3d38f250096\" : { \n    \"value\" : \"Detection\"\n    },\n    \"effect-425bea59-a659-4cbb-8d31-34499bd030b8\" : { \n    \"value\" : \"Audit\"\n    },\n    \"modeRequirement-425bea59-a659-4cbb-8d31-34499bd030b8\" : { \n    \"value\" : \"Detection\"\n    },\n    \"effect-564feb30-bf6a-4854-b4bb-0d2d2d1e6c66\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-055aa869-bc98-4af8-bafc-23f1ab6ffe2c\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-013e242c-8828-4970-87b3-ab247555486d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-d38fc420-0735-4ef3-ac11-c806f651a570\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-a1181c5f-672a-477a-979a-7d58aa086233\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-308fbb08-4ab8-4e67-9b29-592e93fb94fa\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-4da35fc9-c9e7-4960-aec9-797fe7d9051d\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-523b5cd1-3e23-492f-a539-13118b6d1e3a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7fe3b40f-802b-4cdd-8bd4-fd799c948cc2\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-c25d9a16-bc35-4e15-a7e5-9db606bf9ed4\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b0f33259-77d7-4c9e-aac6-3aabcfae693c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-037eea7a-bd0a-46c5-9a66-03aea78705d3\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-0725b4dd-7e76-479c-a735-68e7ee23d5ca\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-0820b7b9-23aa-4725-a1ce-ae4558f718e5\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2c89a2e5-7285-40fe-afe0-ae8654b92fab\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-358c20a6-3f9e-4f0e-97ff-c6ce485e2aac\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-5744710e-cc2f-4ee8-8809-3b11e89f4bc9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ac4a19c2-fa67-49b4-8ae5-0b2e78c49457\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c9d007d0-c057-4772-b18c-01e546713bcd\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-d0793b48-0edc-4296-a390-4c75d1bdfd71\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-e372f825-a257-4fb8-9175-797a8a8627d6\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-d158790f-bfb0-486c-8631-2dc6b4e8e6af\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-e802a67a-daf5-4436-9ea6-f6d821dd0c5d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-a451c1ef-c6ca-483d-87ed-f49761e3ffb5\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftSql-servers-firewallRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftClassicNetwork-networkSecurityGroups-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-securityRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftClassicNetwork-networkSecurityGroups-securityRules-delete\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ae89ebca-1c92-4898-ac2c-9f63decb045c\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-d26f7642-7545-4e18-9b75-8c9bbdee3a9a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-1a4e592a-6a6e-44a5-9814-e36264ca96e7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-7796937f-307b-4598-941c-67d3a05ebfe7\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-c5447c04-a4d7-4ba8-a263-c9ee321a6858\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-41388f1c-2db0-4c25-95b2-35d7f5ccbfa9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-b02aacc0-b073-424e-8298-42b22829ee0a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-057d6cfe-9c4f-4a6d-bc60-14420ea1f1a9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0ec47710-77ff-4a3d-9181-6aa50af424d0\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-48af4db5-9b8b-401c-8e74-076be876a430\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-82339799-d096-41ae-8538-b108becf0970\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1b7aa243-30e4-4c9e-bca8-d0d3022b634a\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-bb91dfba-c30d-4263-9add-9c2384e659a6\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-e71308d3-144b-4262-b144-efdc3cc90517\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2bdd0062-9d75-436e-89df-487dd8e4b3c7\" : { \n    \"value\" : \"Disabled\"\n    },\n    \"effect-4733ea7b-a883-42fe-8cac-97454c2a9e4a\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-67121cc7-ff39-4ab8-b7e3-95b84dab487d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-6fac406b-40ca-413b-bf8e-0bf964659c25\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-81e74cea-30fd-40d5-802f-d72103c2aaaa\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c349d81b-9985-44ae-a8da-ff98d108ede8\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-f4b53539-8df9-40e4-86c6-6b607703bd4e\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-ec068d99-e9c7-401f-8cef-5bdde4e6ccf1\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-048248b0-55cd-46da-b1ff-39efd52db260\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0d134df8-db83-46fb-ad72-fe0c9428c8dd\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-2c89a2e5-7285-40fe-afe0-ae8654b92fb2\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-3657f5a0-770e-44a3-b44e-9431ba1e9735\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-617c02be-7f02-4efd-8836-3180d47b6c68\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-7d7be79c-23ba-4033-84dd-45e2a5ccdd67\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-87ba29ef-1ab3-4d82-b763-87fcd4f531f7\" : { \n    \"value\" : \"audit\"\n    },\n    \"effect-f7d52b2d-e161-4dfa-a82b-55e564167385\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-c43e4a30-77cb-48ab-a4dd-93f175c63b57\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\" : { \n    \"value\" : \"Audit\"\n    },\n    \"effect-1f314764-cb73-4fc9-b863-8eca98ac36e9\" : { \n    \"value\" : \"AuditIfNotExists\"\n    },\n    \"effect-123a3936-f020-408a-ba0c-47873faf1534\" : { \n    \"value\" : \"AuditIfNotExists\"\n    }\n}\n', '<LAWORKSPACE>', reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('logAnalyticsWorkspaceResourceGroupName')), 'Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName')), '2021-06-01').customerId))))[variables('modifiedAssignment')].parameters]"
              },
              "identity": {
                "type": "SystemAssigned"
              }
            }
          ]
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc')))]",
        "[subscriptionResourceId(parameters('operationsSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-operations-rg-{0}', parameters('nowUtc')))]"
      ]
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "deploy-hub-sub-activity-logging",
      "subscriptionId": "[parameters('hubSubscriptionId')]",
      "location": "[deployment().location]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "diagnosticSettingName": {
            "value": "[format('log-hub-sub-activity-to-{0}', reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value)]"
          },
          "logAnalyticsWorkspaceId": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc'))), '2019-10-01').outputs.id.value]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "10501865331857601559"
            }
          },
          "parameters": {
            "diagnosticSettingName": {
              "type": "string"
            },
            "logAnalyticsWorkspaceId": {
              "type": "string"
            }
          },
          "functions": [],
          "resources": [
            {
              "type": "Microsoft.Insights/diagnosticSettings",
              "apiVersion": "2021-05-01-preview",
              "name": "[parameters('diagnosticSettingName')]",
              "properties": {
                "workspaceId": "[parameters('logAnalyticsWorkspaceId')]",
                "logs": [
                  {
                    "category": "Administrative",
                    "enabled": true
                  },
                  {
                    "category": "Security",
                    "enabled": true
                  },
                  {
                    "category": "ServiceHealth",
                    "enabled": true
                  },
                  {
                    "category": "Alert",
                    "enabled": true
                  },
                  {
                    "category": "Recommendation",
                    "enabled": true
                  },
                  {
                    "category": "Policy",
                    "enabled": true
                  },
                  {
                    "category": "Autoscale",
                    "enabled": true
                  },
                  {
                    "category": "ResourceHealth",
                    "enabled": true
                  }
                ]
              }
            }
          ]
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc')))]"
      ]
    },
    {
      "condition": "[not(equals(parameters('hubSubscriptionId'), parameters('operationsSubscriptionId')))]",
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "deploy-operations-sub-activity-logging",
      "subscriptionId": "[parameters('operationsSubscriptionId')]",
      "location": "[deployment().location]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "diagnosticSettingName": {
            "value": "[format('log-operations-sub-activity-to-{0}', reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value)]"
          },
          "logAnalyticsWorkspaceId": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc'))), '2019-10-01').outputs.id.value]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "10501865331857601559"
            }
          },
          "parameters": {
            "diagnosticSettingName": {
              "type": "string"
            },
            "logAnalyticsWorkspaceId": {
              "type": "string"
            }
          },
          "functions": [],
          "resources": [
            {
              "type": "Microsoft.Insights/diagnosticSettings",
              "apiVersion": "2021-05-01-preview",
              "name": "[parameters('diagnosticSettingName')]",
              "properties": {
                "workspaceId": "[parameters('logAnalyticsWorkspaceId')]",
                "logs": [
                  {
                    "category": "Administrative",
                    "enabled": true
                  },
                  {
                    "category": "Security",
                    "enabled": true
                  },
                  {
                    "category": "ServiceHealth",
                    "enabled": true
                  },
                  {
                    "category": "Alert",
                    "enabled": true
                  },
                  {
                    "category": "Recommendation",
                    "enabled": true
                  },
                  {
                    "category": "Policy",
                    "enabled": true
                  },
                  {
                    "category": "Autoscale",
                    "enabled": true
                  },
                  {
                    "category": "ResourceHealth",
                    "enabled": true
                  }
                ]
              }
            }
          ]
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc')))]"
      ]
    },
    {
      "condition": "[not(equals(parameters('hubSubscriptionId'), parameters('identitySubscriptionId')))]",
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "deploy-identity-sub-activity-logging",
      "subscriptionId": "[parameters('identitySubscriptionId')]",
      "location": "[deployment().location]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "diagnosticSettingName": {
            "value": "[format('log-identity-sub-activity-to-{0}', reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value)]"
          },
          "logAnalyticsWorkspaceId": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc'))), '2019-10-01').outputs.id.value]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "10501865331857601559"
            }
          },
          "parameters": {
            "diagnosticSettingName": {
              "type": "string"
            },
            "logAnalyticsWorkspaceId": {
              "type": "string"
            }
          },
          "functions": [],
          "resources": [
            {
              "type": "Microsoft.Insights/diagnosticSettings",
              "apiVersion": "2021-05-01-preview",
              "name": "[parameters('diagnosticSettingName')]",
              "properties": {
                "workspaceId": "[parameters('logAnalyticsWorkspaceId')]",
                "logs": [
                  {
                    "category": "Administrative",
                    "enabled": true
                  },
                  {
                    "category": "Security",
                    "enabled": true
                  },
                  {
                    "category": "ServiceHealth",
                    "enabled": true
                  },
                  {
                    "category": "Alert",
                    "enabled": true
                  },
                  {
                    "category": "Recommendation",
                    "enabled": true
                  },
                  {
                    "category": "Policy",
                    "enabled": true
                  },
                  {
                    "category": "Autoscale",
                    "enabled": true
                  },
                  {
                    "category": "ResourceHealth",
                    "enabled": true
                  }
                ]
              }
            }
          ]
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc')))]"
      ]
    },
    {
      "condition": "[not(equals(parameters('hubSubscriptionId'), parameters('sharedServicesSubscriptionId')))]",
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "deploy-sharedServices-sub-activity-logging",
      "subscriptionId": "[parameters('sharedServicesSubscriptionId')]",
      "location": "[deployment().location]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "diagnosticSettingName": {
            "value": "[format('log-sharedServices-sub-activity-to-{0}', reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value)]"
          },
          "logAnalyticsWorkspaceId": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc'))), '2019-10-01').outputs.id.value]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "10501865331857601559"
            }
          },
          "parameters": {
            "diagnosticSettingName": {
              "type": "string"
            },
            "logAnalyticsWorkspaceId": {
              "type": "string"
            }
          },
          "functions": [],
          "resources": [
            {
              "type": "Microsoft.Insights/diagnosticSettings",
              "apiVersion": "2021-05-01-preview",
              "name": "[parameters('diagnosticSettingName')]",
              "properties": {
                "workspaceId": "[parameters('logAnalyticsWorkspaceId')]",
                "logs": [
                  {
                    "category": "Administrative",
                    "enabled": true
                  },
                  {
                    "category": "Security",
                    "enabled": true
                  },
                  {
                    "category": "ServiceHealth",
                    "enabled": true
                  },
                  {
                    "category": "Alert",
                    "enabled": true
                  },
                  {
                    "category": "Recommendation",
                    "enabled": true
                  },
                  {
                    "category": "Policy",
                    "enabled": true
                  },
                  {
                    "category": "Autoscale",
                    "enabled": true
                  },
                  {
                    "category": "ResourceHealth",
                    "enabled": true
                  }
                ]
              }
            }
          ]
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc')))]"
      ]
    },
    {
      "condition": "[parameters('deployRemoteAccess')]",
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2019-10-01",
      "name": "[format('deploy-remote-access-{0}', parameters('nowUtc'))]",
      "subscriptionId": "[parameters('hubSubscriptionId')]",
      "resourceGroup": "[parameters('hubResourceGroupName')]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "location": {
            "value": "[parameters('hubLocation')]"
          },
          "hubVirtualNetworkName": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkName.value]"
          },
          "hubSubnetResourceId": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.subnetResourceId.value]"
          },
          "hubNetworkSecurityGroupResourceId": {
            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.networkSecurityGroupResourceId.value]"
          },
          "bastionHostName": {
            "value": "[parameters('bastionHostName')]"
          },
          "bastionHostSubnetAddressPrefix": {
            "value": "[parameters('bastionHostSubnetAddressPrefix')]"
          },
          "bastionHostPublicIPAddressName": {
            "value": "[parameters('bastionHostPublicIPAddressName')]"
          },
          "bastionHostPublicIPAddressSkuName": {
            "value": "[parameters('bastionHostPublicIPAddressSkuName')]"
          },
          "bastionHostPublicIPAddressAllocationMethod": {
            "value": "[parameters('bastionHostPublicIPAddressAllocationMethod')]"
          },
          "bastionHostPublicIPAddressAvailabilityZones": {
            "value": "[parameters('bastionHostPublicIPAddressAvailabilityZones')]"
          },
          "bastionHostIPConfigurationName": {
            "value": "[parameters('bastionHostIPConfigurationName')]"
          },
          "linuxNetworkInterfaceIpConfigurationName": {
            "value": "[parameters('linuxNetworkInterfaceIpConfigurationName')]"
          },
          "linuxNetworkInterfacePrivateIPAddressAllocationMethod": {
            "value": "[parameters('linuxNetworkInterfacePrivateIPAddressAllocationMethod')]"
          },
          "linuxVmName": {
            "value": "[parameters('linuxVmName')]"
          },
          "linuxVmSize": {
            "value": "[parameters('linuxVmSize')]"
          },
          "linuxVmOsDiskCreateOption": {
            "value": "[parameters('linuxVmOsDiskCreateOption')]"
          },
          "linuxVmOsDiskType": {
            "value": "[parameters('linuxVmOsDiskType')]"
          },
          "linuxVmImagePublisher": {
            "value": "[parameters('linuxVmImagePublisher')]"
          },
          "linuxVmImageOffer": {
            "value": "[parameters('linuxVmImageOffer')]"
          },
          "linuxVmImageSku": {
            "value": "[parameters('linuxVmImageSku')]"
          },
          "linuxVmImageVersion": {
            "value": "[parameters('linuxVmImageVersion')]"
          },
          "linuxVmAdminUsername": {
            "value": "[parameters('linuxVmAdminUsername')]"
          },
          "linuxVmAuthenticationType": {
            "value": "[parameters('linuxVmAuthenticationType')]"
          },
          "linuxVmAdminPasswordOrKey": {
            "value": "[parameters('linuxVmAdminPasswordOrKey')]"
          },
          "linuxVmNetworkInterfaceName": {
            "value": "[parameters('linuxVmNetworkInterfaceName')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.4.613.9944",
              "templateHash": "15146003623826486692"
            }
          },
          "parameters": {
            "location": {
              "type": "string"
            },
            "tags": {
              "type": "object",
              "defaultValue": {}
            },
            "hubVirtualNetworkName": {
              "type": "string"
            },
            "hubSubnetResourceId": {
              "type": "string"
            },
            "hubNetworkSecurityGroupResourceId": {
              "type": "string"
            },
            "bastionHostName": {
              "type": "string"
            },
            "bastionHostSubnetAddressPrefix": {
              "type": "string"
            },
            "bastionHostPublicIPAddressName": {
              "type": "string"
            },
            "bastionHostPublicIPAddressSkuName": {
              "type": "string"
            },
            "bastionHostPublicIPAddressAllocationMethod": {
              "type": "string"
            },
            "bastionHostPublicIPAddressAvailabilityZones": {
              "type": "array"
            },
            "bastionHostIPConfigurationName": {
              "type": "string"
            },
            "linuxVmName": {
              "type": "string"
            },
            "linuxVmSize": {
              "type": "string"
            },
            "linuxVmOsDiskCreateOption": {
              "type": "string"
            },
            "linuxVmOsDiskType": {
              "type": "string"
            },
            "linuxVmImagePublisher": {
              "type": "string"
            },
            "linuxVmImageOffer": {
              "type": "string"
            },
            "linuxVmImageSku": {
              "type": "string"
            },
            "linuxVmImageVersion": {
              "type": "string"
            },
            "linuxVmAdminUsername": {
              "type": "string"
            },
            "linuxVmAuthenticationType": {
              "type": "string",
              "allowedValues": [
                "sshPublicKey",
                "password"
              ]
            },
            "linuxVmAdminPasswordOrKey": {
              "type": "secureString"
            },
            "linuxVmNetworkInterfaceName": {
              "type": "string"
            },
            "linuxNetworkInterfaceIpConfigurationName": {
              "type": "string"
            },
            "linuxNetworkInterfacePrivateIPAddressAllocationMethod": {
              "type": "string"
            }
          },
          "functions": [],
          "resources": [
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "remoteAccess-bastionHost",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[parameters('bastionHostName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  },
                  "virtualNetworkName": {
                    "value": "[parameters('hubVirtualNetworkName')]"
                  },
                  "subnetAddressPrefix": {
                    "value": "[parameters('bastionHostSubnetAddressPrefix')]"
                  },
                  "publicIPAddressName": {
                    "value": "[parameters('bastionHostPublicIPAddressName')]"
                  },
                  "publicIPAddressSkuName": {
                    "value": "[parameters('bastionHostPublicIPAddressSkuName')]"
                  },
                  "publicIPAddressAllocationMethod": {
                    "value": "[parameters('bastionHostPublicIPAddressAllocationMethod')]"
                  },
                  "publicIPAddressAvailabilityZones": {
                    "value": "[parameters('bastionHostPublicIPAddressAvailabilityZones')]"
                  },
                  "ipConfigurationName": {
                    "value": "[parameters('bastionHostIPConfigurationName')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "10497818437168204965"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    },
                    "virtualNetworkName": {
                      "type": "string"
                    },
                    "subnetAddressPrefix": {
                      "type": "string"
                    },
                    "publicIPAddressName": {
                      "type": "string"
                    },
                    "publicIPAddressSkuName": {
                      "type": "string"
                    },
                    "publicIPAddressAllocationMethod": {
                      "type": "string"
                    },
                    "publicIPAddressAvailabilityZones": {
                      "type": "array"
                    },
                    "ipConfigurationName": {
                      "type": "string"
                    }
                  },
                  "functions": [],
                  "variables": {
                    "subnetName": "AzureBastionSubnet"
                  },
                  "resources": [
                    {
                      "type": "Microsoft.Network/publicIPAddresses",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('publicIPAddressName')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "sku": {
                        "name": "[parameters('publicIPAddressSkuName')]"
                      },
                      "properties": {
                        "publicIPAllocationMethod": "[parameters('publicIPAddressAllocationMethod')]"
                      },
                      "zones": "[parameters('publicIPAddressAvailabilityZones')]"
                    },
                    {
                      "type": "Microsoft.Network/virtualNetworks/subnets",
                      "apiVersion": "2021-02-01",
                      "name": "[format('{0}/{1}', parameters('virtualNetworkName'), variables('subnetName'))]",
                      "properties": {
                        "addressPrefix": "[parameters('subnetAddressPrefix')]"
                      }
                    },
                    {
                      "type": "Microsoft.Network/bastionHosts",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "properties": {
                        "ipConfigurations": [
                          {
                            "name": "[parameters('ipConfigurationName')]",
                            "properties": {
                              "subnet": {
                                "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', split(format('{0}/{1}', parameters('virtualNetworkName'), variables('subnetName')), '/')[0], split(format('{0}/{1}', parameters('virtualNetworkName'), variables('subnetName')), '/')[1])]"
                              },
                              "publicIPAddress": {
                                "id": "[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddressName'))]"
                              }
                            }
                          }
                        ]
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddressName'))]",
                        "[resourceId('Microsoft.Network/virtualNetworks/subnets', split(format('{0}/{1}', parameters('virtualNetworkName'), variables('subnetName')), '/')[0], split(format('{0}/{1}', parameters('virtualNetworkName'), variables('subnetName')), '/')[1])]"
                      ]
                    }
                  ]
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "remoteAccess-linuxNetworkInterface",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[parameters('linuxVmNetworkInterfaceName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  },
                  "ipConfigurationName": {
                    "value": "[parameters('linuxNetworkInterfaceIpConfigurationName')]"
                  },
                  "networkSecurityGroupId": {
                    "value": "[parameters('hubNetworkSecurityGroupResourceId')]"
                  },
                  "privateIPAddressAllocationMethod": {
                    "value": "[parameters('linuxNetworkInterfacePrivateIPAddressAllocationMethod')]"
                  },
                  "subnetId": {
                    "value": "[parameters('hubSubnetResourceId')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "14459425343428091407"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    },
                    "ipConfigurationName": {
                      "type": "string"
                    },
                    "subnetId": {
                      "type": "string"
                    },
                    "networkSecurityGroupId": {
                      "type": "string"
                    },
                    "privateIPAddressAllocationMethod": {
                      "type": "string"
                    }
                  },
                  "functions": [],
                  "resources": [
                    {
                      "type": "Microsoft.Network/networkInterfaces",
                      "apiVersion": "2021-02-01",
                      "name": "[parameters('name')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "properties": {
                        "ipConfigurations": [
                          {
                            "name": "[parameters('ipConfigurationName')]",
                            "properties": {
                              "subnet": {
                                "id": "[parameters('subnetId')]"
                              },
                              "privateIPAllocationMethod": "[parameters('privateIPAddressAllocationMethod')]"
                            }
                          }
                        ],
                        "networkSecurityGroup": {
                          "id": "[parameters('networkSecurityGroupId')]"
                        }
                      }
                    }
                  ],
                  "outputs": {
                    "id": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Network/networkInterfaces', parameters('name'))]"
                    },
                    "name": {
                      "type": "string",
                      "value": "[parameters('name')]"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2019-10-01",
              "name": "remoteAccess-linuxVirtualMachine",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "name": {
                    "value": "[parameters('linuxVmName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "tags": {
                    "value": "[parameters('tags')]"
                  },
                  "vmSize": {
                    "value": "[parameters('linuxVmSize')]"
                  },
                  "osDiskCreateOption": {
                    "value": "[parameters('linuxVmOsDiskCreateOption')]"
                  },
                  "osDiskType": {
                    "value": "[parameters('linuxVmOsDiskType')]"
                  },
                  "vmImagePublisher": {
                    "value": "[parameters('linuxVmImagePublisher')]"
                  },
                  "vmImageOffer": {
                    "value": "[parameters('linuxVmImageOffer')]"
                  },
                  "vmImageSku": {
                    "value": "[parameters('linuxVmImageSku')]"
                  },
                  "vmImageVersion": {
                    "value": "[parameters('linuxVmImageVersion')]"
                  },
                  "adminUsername": {
                    "value": "[parameters('linuxVmAdminUsername')]"
                  },
                  "authenticationType": {
                    "value": "[parameters('linuxVmAuthenticationType')]"
                  },
                  "adminPasswordOrKey": {
                    "value": "[parameters('linuxVmAdminPasswordOrKey')]"
                  },
                  "networkInterfaceName": {
                    "value": "[reference(resourceId('Microsoft.Resources/deployments', 'remoteAccess-linuxNetworkInterface'), '2019-10-01').outputs.name.value]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.4.613.9944",
                      "templateHash": "16223346466626986050"
                    }
                  },
                  "parameters": {
                    "name": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object",
                      "defaultValue": {}
                    },
                    "networkInterfaceName": {
                      "type": "string"
                    },
                    "vmSize": {
                      "type": "string"
                    },
                    "osDiskCreateOption": {
                      "type": "string"
                    },
                    "osDiskType": {
                      "type": "string"
                    },
                    "vmImagePublisher": {
                      "type": "string"
                    },
                    "vmImageOffer": {
                      "type": "string"
                    },
                    "vmImageSku": {
                      "type": "string"
                    },
                    "vmImageVersion": {
                      "type": "string"
                    },
                    "adminUsername": {
                      "type": "string"
                    },
                    "authenticationType": {
                      "type": "string",
                      "allowedValues": [
                        "sshPublicKey",
                        "password"
                      ]
                    },
                    "adminPasswordOrKey": {
                      "type": "secureString"
                    }
                  },
                  "functions": [],
                  "variables": {
                    "linuxConfiguration": {
                      "disablePasswordAuthentication": true,
                      "ssh": {
                        "publicKeys": [
                          {
                            "path": "[format('/home/{0}/.ssh/authorized_keys', parameters('adminUsername'))]",
                            "keyData": "[parameters('adminPasswordOrKey')]"
                          }
                        ]
                      }
                    }
                  },
                  "resources": [
                    {
                      "type": "Microsoft.Compute/virtualMachines",
                      "apiVersion": "2020-06-01",
                      "name": "[parameters('name')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "properties": {
                        "hardwareProfile": {
                          "vmSize": "[parameters('vmSize')]"
                        },
                        "storageProfile": {
                          "osDisk": {
                            "createOption": "[parameters('osDiskCreateOption')]",
                            "managedDisk": {
                              "storageAccountType": "[parameters('osDiskType')]"
                            }
                          },
                          "imageReference": {
                            "publisher": "[parameters('vmImagePublisher')]",
                            "offer": "[parameters('vmImageOffer')]",
                            "sku": "[parameters('vmImageSku')]",
                            "version": "[parameters('vmImageVersion')]"
                          }
                        },
                        "networkProfile": {
                          "networkInterfaces": [
                            {
                              "id": "[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaceName'))]"
                            }
                          ]
                        },
                        "osProfile": {
                          "computerName": "[parameters('name')]",
                          "adminUsername": "[parameters('adminUsername')]",
                          "adminPassword": "[parameters('adminPasswordOrKey')]",
                          "linuxConfiguration": "[if(equals(parameters('authenticationType'), 'password'), null(), variables('linuxConfiguration'))]"
                        }
                      }
                    }
                  ],
                  "outputs": {
                    "adminUsername": {
                      "type": "string",
                      "value": "[parameters('adminUsername')]"
                    },
                    "authenticationType": {
                      "type": "string",
                      "value": "[parameters('authenticationType')]"
                    }
                  }
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Resources/deployments', 'remoteAccess-linuxNetworkInterface')]"
              ]
            }
          ]
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc')))]"
      ]
    }
  ],
  "outputs": {
    "hubSubscriptionId": {
      "type": "string",
      "value": "[parameters('hubSubscriptionId')]"
    },
    "hubResourceGroupName": {
      "type": "string",
      "value": "[reference(subscriptionResourceId(parameters('hubSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-hub-rg-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value]"
    },
    "hubResourceGroupResourceId": {
      "type": "string",
      "value": "[reference(subscriptionResourceId(parameters('hubSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-hub-rg-{0}', parameters('nowUtc'))), '2019-10-01').outputs.id.value]"
    },
    "hubVirtualNetworkName": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkName.value]"
    },
    "hubVirtualNetworkResourceId": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkResourceId.value]"
    },
    "hubSubnetName": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.subnetName.value]"
    },
    "hubSubnetResourceId": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.subnetResourceId.value]"
    },
    "hubSubnetAddressPrefix": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.subnetAddressPrefix.value]"
    },
    "hubNetworkSecurityGroupName": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.networkSecurityGroupName.value]"
    },
    "hubNetworkSecurityGroupResourceId": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.networkSecurityGroupResourceId.value]"
    },
    "hubFirewallPrivateIPAddress": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.firewallPrivateIPAddress.value]"
    },
    "logAnalyticsWorkspaceName": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value]"
    },
    "logAnalyticsWorkspaceResourceId": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-laws-{0}', parameters('nowUtc'))), '2019-10-01').outputs.id.value]"
    },
    "firewallPrivateIPAddress": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('hubSubscriptionId'), parameters('hubResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-hub-{0}', parameters('nowUtc'))), '2019-10-01').outputs.firewallPrivateIPAddress.value]"
    },
    "identitySubscriptionId": {
      "type": "string",
      "value": "[parameters('identitySubscriptionId')]"
    },
    "identityResourceGroupName": {
      "type": "string",
      "value": "[reference(subscriptionResourceId(parameters('identitySubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-identity-rg-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value]"
    },
    "identityResourceGroupResourceId": {
      "type": "string",
      "value": "[reference(subscriptionResourceId(parameters('identitySubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-identity-rg-{0}', parameters('nowUtc'))), '2019-10-01').outputs.id.value]"
    },
    "identityVirtualNetworkName": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('identitySubscriptionId'), parameters('identityResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-identity-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkName.value]"
    },
    "identityVirtualNetworkResourceId": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('identitySubscriptionId'), parameters('identityResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-identity-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkResourceId.value]"
    },
    "identitySubnetName": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('identitySubscriptionId'), parameters('identityResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-identity-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.subnetName.value]"
    },
    "identitySubnetResourceId": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('identitySubscriptionId'), parameters('identityResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-identity-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.subnetResourceId.value]"
    },
    "identitySubnetAddressPrefix": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('identitySubscriptionId'), parameters('identityResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-identity-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.subnetAddressPrefix.value]"
    },
    "identityNetworkSecurityGroupName": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('identitySubscriptionId'), parameters('identityResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-identity-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.networkSecurityGroupName.value]"
    },
    "identityNetworkSecurityGroupResourceId": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('identitySubscriptionId'), parameters('identityResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-identity-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.networkSecurityGroupResourceId.value]"
    },
    "operationsSubscriptionId": {
      "type": "string",
      "value": "[parameters('operationsSubscriptionId')]"
    },
    "operationsResourceGroupName": {
      "type": "string",
      "value": "[reference(subscriptionResourceId(parameters('operationsSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-operations-rg-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value]"
    },
    "operationsResourceGroupResourceId": {
      "type": "string",
      "value": "[reference(subscriptionResourceId(parameters('operationsSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-operations-rg-{0}', parameters('nowUtc'))), '2019-10-01').outputs.id.value]"
    },
    "operationsVirtualNetworkName": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-operations-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkName.value]"
    },
    "operationsVirtualNetworkResourceId": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-operations-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkResourceId.value]"
    },
    "operationsSubnetName": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-operations-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.subnetName.value]"
    },
    "operationsSubnetResourceId": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-operations-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.subnetResourceId.value]"
    },
    "operationsSubnetAddressPrefix": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-operations-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.subnetAddressPrefix.value]"
    },
    "operationsNetworkSecurityGroupName": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-operations-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.networkSecurityGroupName.value]"
    },
    "operationsNetworkSecurityGroupResourceId": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('operationsSubscriptionId'), parameters('operationsResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-operations-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.networkSecurityGroupResourceId.value]"
    },
    "sharedServicesSubscriptionId": {
      "type": "string",
      "value": "[parameters('sharedServicesSubscriptionId')]"
    },
    "sharedServicesResourceGroupName": {
      "type": "string",
      "value": "[reference(subscriptionResourceId(parameters('sharedServicesSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-sharedServices-rg-{0}', parameters('nowUtc'))), '2019-10-01').outputs.name.value]"
    },
    "sharedServicesResourceGroupResourceId": {
      "type": "string",
      "value": "[reference(subscriptionResourceId(parameters('sharedServicesSubscriptionId'), 'Microsoft.Resources/deployments', format('deploy-sharedServices-rg-{0}', parameters('nowUtc'))), '2019-10-01').outputs.id.value]"
    },
    "sharedServicesVirtualNetworkName": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('sharedServicesSubscriptionId'), parameters('sharedServicesResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-sharedServices-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkName.value]"
    },
    "sharedServicesVirtualNetworkResourceId": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('sharedServicesSubscriptionId'), parameters('sharedServicesResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-sharedServices-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.virtualNetworkResourceId.value]"
    },
    "sharedServicesSubnetName": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('sharedServicesSubscriptionId'), parameters('sharedServicesResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-sharedServices-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.subnetName.value]"
    },
    "sharedServicesSubnetResourceId": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('sharedServicesSubscriptionId'), parameters('sharedServicesResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-sharedServices-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.subnetResourceId.value]"
    },
    "sharedServicesSubnetAddressPrefix": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('sharedServicesSubscriptionId'), parameters('sharedServicesResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-sharedServices-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.subnetAddressPrefix.value]"
    },
    "sharedServicesNetworkSecurityGroupName": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('sharedServicesSubscriptionId'), parameters('sharedServicesResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-sharedServices-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.networkSecurityGroupName.value]"
    },
    "sharedServicesNetworkSecurityGroupResourceId": {
      "type": "string",
      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('sharedServicesSubscriptionId'), parameters('sharedServicesResourceGroupName')), 'Microsoft.Resources/deployments', format('deploy-sharedServices-spoke-{0}', parameters('nowUtc'))), '2019-10-01').outputs.networkSecurityGroupResourceId.value]"
    }
  }
}